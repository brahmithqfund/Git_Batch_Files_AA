package Tests.TLP;
import java.awt.Robot;
import java.awt.event.KeyEvent;
import org.testng.Assert;
import org.testng.ITestResult;
import org.testng.annotations.AfterClass;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.Test;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeMethod;
import java.io.File;
import java.io.IOException;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import java.util.Random;
import java.util.Set;
import java.util.concurrent.TimeUnit;
import org.apache.commons.io.FileUtils;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.NoAlertPresentException;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.ie.InternetExplorerDriver;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.AfterClass;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;
import com.relevantcodes.extentreports.ExtentReports;
import com.relevantcodes.extentreports.ExtentTest;
import com.relevantcodes.extentreports.LogStatus;
import Pages.BorrowerRegistrationpage;
import Pages.CSRLoginpage;

import Tests.ExecuteScripts;
import Utilities.ExtentReports.Excel;

public class TLP_GenericScenarios
{
	private static final TLP_GenericScenarios ExecuteSmokeTest_TLP = null;
	public WebDriverWait wait;	
		WebDriver driver;		
		String appUrl;
		String timestamp = new SimpleDateFormat("MM.dd.yyyy.HH.mm.ss").format(new Date());
		static ExtentReports reports;
		ExtentTest test;
		
@BeforeClass
		   public synchronized void initialize()
           {
			String timestamp = new SimpleDateFormat("MM.dd.yyyy.HH.mm.ss").format(new Date());
			String filename="AA_TLP_Critical_Scenarios_"+timestamp+".html";
			reports = new ExtentReports(System.getProperty("user.dir") + "/ExecutionReports/TLP-2/AA_TLP_Generic_Scenarios_/"+filename, true);
			}
		
@BeforeMethod
		 public void killProcess() throws Exception
		 {
	           Runtime.getRuntime().exec("taskkill /F /IM IEDriverServer.exe");
		          Thread.sleep(5000); //Allow OS to kill the process
		          System.setProperty("webdriver.ie.driver",System.getProperty("user.dir")+"/IEDriverServer.exe");
			  		driver = new InternetExplorerDriver();
			  		driver.manage().window().maximize();
					driver.manage().deleteAllCookies();
					driver.manage().timeouts().pageLoadTimeout(40, TimeUnit.SECONDS);
					driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
		        }
		
		public void Login (String username,String password,String storenumber) 
		{
			driver.get(appUrl);
			test.log(LogStatus.INFO, "CSR Application is launched");
			driver.manage().window().maximize();
			String usenameId = "loginRequestBean.userId";
			String passwordId = "loginRequestBean.password";
			String StoreId = "loginRequestBean.locNbr";
			String Login = "login";
			driver.findElement(By.name(usenameId)).clear();
			driver.findElement(By.name(usenameId)).sendKeys(username);
			Assert.assertTrue(true);
			test.log(LogStatus.PASS, "Username is entered: "+username);
			driver.findElement(By.name(passwordId)).clear();
			driver.findElement(By.name(passwordId)).sendKeys(password);
			Assert.assertTrue(true);
			test.log(LogStatus.PASS, "Password is entered: "+password);
			driver.findElement(By.name(StoreId)).sendKeys(storenumber);;
			Assert.assertTrue(true);
			test.log(LogStatus.PASS, "Storenumber is entered: "+storenumber);
			driver.findElement(By.name(Login)).click();
			Assert.assertTrue(true);
			test.log(LogStatus.PASS, "Clicked on Submit button");
		
		}


		public void NewLoan(String SSN,String FileName) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);  	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					System.out.println(FileName);
					System.out.println(NewVIN);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ABA_Number = TestData.getCellData(sheetName,"ABARoutingNbr",row);		
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					String Parent_Window = driver.getWindowHandle();
					System.out.println(last4cheknum);
					System.out.println(stateProductType);

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
					{
						if(ProductID.equals("TLP"))							
						{	
							Thread.sleep(2000);
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();							
						}												
						
						if(ProductName.equals("Tennessee"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}
						
						driver.findElement(By.name("ShareScreenBtn")).click();
						test.log(LogStatus.PASS, "ShareScreen Button clicked");
						for( String winHandle1 : driver.getWindowHandles())
						{
							if(!(winHandle1.equals(Parent_Window)))
							{
								driver.switchTo().window(winHandle1);
								Thread.sleep(1000);
								driver.findElement(By.name("confirmSummary")).click();
								test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
							}
						}
						Thread.sleep(3000);
						driver.switchTo().window(Parent_Window);
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}                     

						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");
						driver.findElement(By.id("LoanButtonId")).click();
						test.log(LogStatus.PASS, "Clicked on New Loan button");
						if(ProductID.equals("TLP"))
						{	
							String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
							String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
							String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
							String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
							String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
							String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
							String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
							String PhoneNbr1 = PhoneNbr.substring(0, 3);
							String PhoneNbr2 = PhoneNbr.substring(3, 6);
							String PhoneNbr3 = PhoneNbr.substring(6, 10);
							String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
							String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
							String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
							String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
							String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
							String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
							String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
							driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
							driver.findElement(By.xpath("//*[@id='appraisal']")).sendKeys(AppraisalValue);
							driver.findElement(By.name("button1")).click();
							test.log(LogStatus.PASS, "click on Update 1 button ");
							WebDriverWait wait = new WebDriverWait(driver, 10);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
							driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
							driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
							driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
							driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
							driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
							driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);
							driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
							driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
							driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
							driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
							driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
							driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
							driver.findElement(By.name("button2")).click();			
							Thread.sleep(2000);
							driver.findElement(By.name("button2")).click();	
							test.log(LogStatus.PASS, "click on Update 2 button ");
							Thread.sleep(2000);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
							driver.findElement(By.name("process")).click();
							test.log(LogStatus.PASS, "click on process Loan button ");
							try { 
								Alert alert = driver.switchTo().alert();
								alert.accept();													

							}
							catch (NoAlertPresentException e) 
							{
							}
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
							driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
							test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);									

							String Instamt=driver.findElement(By.name("cashToCust")).getAttribute("value");
							System.out.println(Instamt);

							driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
							test.log(LogStatus.PASS, "Collateral Type is enterted as ::"+ESign_DisbType);	
							
							driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys(Instamt);
							test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);

							if(ESign_DisbType.equals("ACH"))	
							{

								driver.findElement(By.name("newAbaNbr")).sendKeys(ABA_Number);
								test.log(LogStatus.PASS, "ABA Number entered");
								driver.findElement(By.name("newCkngAccntNbr")).sendKeys(ESign_CheckNbr);
								test.log(LogStatus.PASS, "Newchecking number Enetered");

							}

							driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
							test.log(LogStatus.PASS, "Electronic Documents Only? is selected as "+ESign_CourtesyCallConsent);
							if(ESign_CourtesyCallConsent.equals("Yes"))
							{
								if(ESign_Preference.equals("Call"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
								}
								if(ESign_Preference.equals("Mail"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
								}
								if(ESign_Preference.equals("SMS"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

									try { 
										Alert alert = driver.switchTo().alert();
										alert.dismiss();
										//if alert present, accept and move on.														

									}
									catch (NoAlertPresentException e) {
									}
								}

							}
							if(AllowPromotion.equals("Yes"))
							{
								driver.findElement(By.name("allowPromotion")).click();
								test.log(LogStatus.PASS, "AllowPromotion is selected ");
								
								driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
								test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							}

							if(ESign_CollateralType.equals("CHECK"))
							{
								driver.findElement(By.name("requestBean.checkNbrs")).sendKeys(ESign_CheckNbr);
								test.log(LogStatus.PASS, "Check number Entered");
							}
							driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
							driver.findElement(By.name("finishLoan")).click();
							test.log(LogStatus.PASS, "Click on Finish Loan Button");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							driver.findElement(By.xpath("//*[@id='OKBut']")).click();					
							test.log(LogStatus.PASS, "click on Yes button ");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							if(driver.findElement(By.name("ok")).isDisplayed())
							{
								test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
								driver.findElement(By.name("ok")).click();
							}
							else
							{
								test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
							}
						}


					}
				}
			}


		}  

		public void NewLoan_MultipulDisbtypes(String SSN,String FileName) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);  	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					System.out.println(FileName);
					System.out.println(NewVIN);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					String ABA_Number = TestData.getCellData(sheetName,"ABARoutingNbr",row);
					String Parent_Window = driver.getWindowHandle();
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
					{	
						if(ProductID.equals("TLP"))							
						{	
							Thread.sleep(2000);
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();

							Thread.sleep(3000);
						}												
						if(ProductName.equals("TNPAYDAY"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}
						if(ProductName.equals("TNPDL all coll"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[3]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}
						if(ProductName.equals("Tennessee"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}
						if(ProductName.equals("Line of Credit"))
						{

							if(StoreID.equals("4330"))
							{
								driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							}
							if(StoreID.equals("4353"))
							{

								driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
								test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);

							}
							if(StoreID.equals("1343"))
							{
								driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
								test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
							}

						}

						driver.findElement(By.name("ShareScreenBtn")).click();
						test.log(LogStatus.PASS, "ShareScreen Button clicked");
						for( String winHandle1 : driver.getWindowHandles())

						{
							if(!(winHandle1.equals(Parent_Window)))
							{
								driver.switchTo().window(winHandle1);
								Thread.sleep(1000);
								driver.findElement(By.name("confirmSummary")).click();
								test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
							}

						}
						Thread.sleep(3000);
						driver.switchTo().window(Parent_Window);

						for( String winHandle1 : driver.getWindowHandles())

						{

							driver.switchTo().window(winHandle1);

						}                     

						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");
						driver.findElement(By.id("LoanButtonId")).click();

						test.log(LogStatus.PASS, "Clicked on New Loan button");


						if(ProductID.equals("TLP"))
						{	
							String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
							String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
							String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
							String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
							String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
							String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
							String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
							String PhoneNbr1 = PhoneNbr.substring(0, 3);
							String PhoneNbr2 = PhoneNbr.substring(3, 6);
							String PhoneNbr3 = PhoneNbr.substring(6, 10);
							String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
							String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
							String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
							String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
							String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
							String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
							String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
							driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
							driver.findElement(By.xpath("//*[@id='appraisal']")).sendKeys(AppraisalValue);
							driver.findElement(By.name("button1")).click();
							test.log(LogStatus.PASS, "click on Update 1 button ");
							WebDriverWait wait = new WebDriverWait(driver, 10);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
							driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
							driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
							driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
							driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
							driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
							driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);
							driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
							driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
							driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
							driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
							driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
							driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
							driver.findElement(By.name("button2")).click();			
							driver.findElement(By.name("button2")).click();	
							test.log(LogStatus.PASS, "click on Update 2 button ");
							Thread.sleep(4000);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
							driver.findElement(By.name("process")).click();
							test.log(LogStatus.PASS, "click on process Loan button ");
							try { 
								Alert alert = driver.switchTo().alert();
								alert.accept();
							}
							catch (NoAlertPresentException e) 
							{
							}
							Thread.sleep(3000);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
							driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
							test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);									
							String Instamt=driver.findElement(By.name("cashToCust")).getAttribute("value");
							System.out.println(Instamt);

							//****** Added	
							driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys("Check");
							test.log(LogStatus.PASS, "disbtype Type is enterted as ::"+ESign_DisbType);	
							//*****
							driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys("300");
							test.log(LogStatus.PASS, "Disb Amt is enterted as 300");
							Thread.sleep(2000);
							driver.findElement(By.name("requestBean.siilBean.disbTypeSecond")).sendKeys("Cash");
							test.log(LogStatus.PASS, "Second disbtype Type is enterted as ::"+ESign_DisbType);
							Thread.sleep(2000);
							driver.findElement(By.name("requestBean.siilBean.disbAmtSecond")).sendKeys("260");
							test.log(LogStatus.PASS, "Disb Amt is enterted as 260");
							if(ESign_DisbType.equals("ACH"))	
							{

								driver.findElement(By.name("newAbaNbr")).sendKeys(ABA_Number);
								test.log(LogStatus.PASS, "ABA Number entered");
								driver.findElement(By.name("newCkngAccntNbr")).sendKeys(ESign_CheckNbr);
								test.log(LogStatus.PASS, "Newchecking number Enetered");

							}
							driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
							test.log(LogStatus.PASS, "Electronic Documents Only? is selected as "+ESign_CourtesyCallConsent);
							if(ESign_CourtesyCallConsent.equals("Yes"))
							{
								if(ESign_Preference.equals("Call"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
								}
								if(ESign_Preference.equals("Mail"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
								}
								if(ESign_Preference.equals("SMS"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

									try { 
										Alert alert = driver.switchTo().alert();
										alert.dismiss();
									}
									catch (NoAlertPresentException e)
									{
									}
								}

							}
							if(AllowPromotion.equals("Yes"))
							{
								driver.findElement(By.name("allowPromotion")).click();
								test.log(LogStatus.PASS, "AllowPromotion is selected ");
								driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
								test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							}

							if(ESign_CollateralType.equals("CHECK"))
							{
								driver.findElement(By.name("requestBean.checkNbrs")).sendKeys(ESign_CheckNbr);
								test.log(LogStatus.PASS, "Check number Entered");
							}
							driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
							driver.findElement(By.name("finishLoan")).click();
							test.log(LogStatus.PASS, "Click on Finish Loan Button");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
							test.log(LogStatus.PASS, "click on Yes button ");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							if(driver.findElement(By.name("ok")).isDisplayed())
							{
								test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
								driver.findElement(By.name("ok")).click();
							}
							else
							{
								test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
							}
						}
					}
				}
			}
		}  


		public void LoanDate_AgeStore(String SSN,String FileName,int days) throws Exception
		{
//-------------done-------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					String age_store = TestData.getCellData(sheetName, "AgeStore",row);
					System.out.println("age_store:::"+age_store);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
				
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.id("go_Button")).click();  
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;

					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[11]/td/span[2]")).getText();
					test.log(LogStatus.PASS, "Capture DueDate"+DueDate);
					System.out.print(DueDate);	
					driver.close();  

					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					driver.manage().window().maximize();
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");		
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");			        
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: "+Password);	
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);  					
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");
					
					Date DDueDate = df.parse(DueDate);
					Calendar cal = Calendar.getInstance();
					cal.setTime(DDueDate);
					cal.add(Calendar.DATE, days);
					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);
					String DueDate0[] =DueDateminus1.split("/");
					String DueDate1 = DueDate0[0];
					String DueDate2 = DueDate0[1];
					String DueDate3 = DueDate0[2];  

					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("storeCode")).click();
					driver.findElement(By.name("storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					Thread.sleep(1000);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.name("btnPreview")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())
					{									        								
						test.log(LogStatus.PASS, "Process Date updated successfully");
						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();
					}
					else
					{
						test.log(LogStatus.FAIL, "Process Date not updated successfully.");
					}
				}
			}
		}

		public void EncryptionKey_Void(String SSN,String FileName) throws Exception
		{
			//--------------done---------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName,Password,StoreId);	
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					String Eankey=null;
					Thread.sleep(3000);
					driver.switchTo().defaultContent();	
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("button")).click(); 
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String TranID = driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr[3]/td")).getText();
					test.log(LogStatus.PASS, "TranId captured:"+TranID);	
					String TranID0[] =TranID.split(":");
					String TranID1 = TranID0[0];
					String TranID2 =  TranID0[1]; 
					driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr[6]/td/input[2]")).click();
					test.log(LogStatus.PASS, "No button is clicked ");	
					driver.close();
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");		
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");			        
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: "+Password);
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Employee')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);  
					driver.findElement(By.linkText("Encryption Key")).click();
					test.log(LogStatus.PASS, "Clicked on Encryption Key");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("Encryption")).click();
					test.log(LogStatus.PASS, "Clicked on Encryption");
					Thread.sleep(2000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.locationNbr")).sendKeys(StoreId);
					test.log(LogStatus.PASS, "Store number Entered");
					driver.findElement(By.name("requestBean.tranNbr")).sendKeys(TranID2);
					test.log(LogStatus.PASS, "Tran number Entered");
					driver.findElement(By.name("trancd")).sendKeys("Advance-ADV");
					test.log(LogStatus.PASS, "Trancd selected");
					driver.findElement(By.name("GetKey")).click();
					test.log(LogStatus.PASS, "GetKey clicked");
					Eankey = driver.findElement(By.name("EanKey")).getAttribute("value");
					test.log(LogStatus.PASS, "GetKey clicked:" +Eankey);
					driver.close();
					
					driver = new InternetExplorerDriver();
					this.Login(UserName,Password,StoreId);	
					Thread.sleep(3000);
					driver.switchTo().defaultContent();				
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();		
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button"); 
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");	
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("button")).click(); 
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr[6]/td/input[1]")).click();
					test.log(LogStatus.PASS, "Yes Button clicked");

					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();	
						}
						catch (NoAlertPresentException e) {
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}


					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						test.log(LogStatus.PASS, "DisbType Type is entered as "+TenderType);
						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();						
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);

						driver.findElement(By.name("transactionDataBean.encryptionKey")).sendKeys(Eankey);
						test.log(LogStatus.PASS, "Encryption key is entered as "+Eankey);

					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("tenderType")).sendKeys(TenderType);
					}
					if(ProductID.equals("PDL"))
					{                               
						driver.findElement(By.name("transactionDataBean.encryptionKey")).sendKeys(Eankey);
						test.log(LogStatus.PASS, "Encryption key is entered as "+Eankey);
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.siilBean.encryptionKey")).sendKeys(Eankey);
						test.log(LogStatus.PASS, "Encryption key is entered as "+Eankey);
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
					}		


					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();

					}
					catch (NoAlertPresentException e) {
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{

						if(driver.findElement(By.name("Ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
					if(ProductID.equals("PDL"))
					{

						if(driver.findElement(By.name("checkyes")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("checkyes")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
				}
			}
		}

		
		public void Rescind(String SSN,String FileName) throws Exception
		{
//---------------done-------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName,Password,StoreId);	
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					driver.switchTo().defaultContent();	
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();	
					driver.switchTo().defaultContent();				
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();		
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Rescind");
					test.log(LogStatus.PASS, "Transaction Type is selected as: Rescind");	
					driver.findElement(By.id("go_Button")).click();
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();						
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("tenderType")).sendKeys(TenderType);
					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
					}						 						 
					test.log(LogStatus.PASS, "Password is selected as "+Password);																					
					test.log(LogStatus.PASS, "Clicked on Finish Rescind Loan button ");
					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
					}
					catch (NoAlertPresentException e)
					{
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{

						if(driver.findElement(By.name("Ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Rescind Loan is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Rescind Loan is not Completed Successfully ");
						}
					}
					if(ProductID.equals("PDL"))
					{

						if(driver.findElement(By.name("checkyes")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Rescind Loan is Completed Successfully ");
							driver.findElement(By.name("checkyes")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Rescind Loan is not Completed Successfully ");
						}
					}
				}
			}
		}

		public void Void(String SSN,String FileName) throws Exception
		{
			//-------done--------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName,Password,StoreId);	
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					String Eankey=null;
					Thread.sleep(2000);
					driver.switchTo().defaultContent();	
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();		
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");	

					driver.findElement(By.id("go_Button")).click();

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");			 	

					driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Disb Type selected  as::Cash ");
					driver.findElement(By.name("requestBean.password")).sendKeys("1234");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Password is selected as ");																					
					test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();

					}
					catch (NoAlertPresentException e) {
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[2]")).click();
					if(driver.findElement(By.name("Ok")).isDisplayed())
					{
						test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
						driver.findElement(By.name("Ok")).click();
					}
					else
					{
						test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
					}
				}
			}
		}


		public void Void_MultipuldisbTypes(String SSN,String FileName) throws Exception
		{
			//-------done----------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName,Password,StoreId);	
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					String Eankey=null;
					Thread.sleep(3000);
					driver.switchTo().defaultContent();	
						WebDriverWait wait = new WebDriverWait(driver, 30); 
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();		
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");	

					driver.findElement(By.id("go_Button")).click();

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");			 	

					driver.findElement(By.name("tenderType")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Tender Type selected  as::Cash ");
					driver.findElement(By.name("requestBean.password")).sendKeys("1234");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Password is selected as ");																					
					test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();

					}
					catch (NoAlertPresentException e) {
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.name("Ok")).isDisplayed())
					{
						test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
						driver.findElement(By.name("Ok")).click();
					}
					else
					{
						test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
					}
				}

			}
		}
		
		
		public void AgeStore(String SSN, String FileName, int Days) throws Exception {

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow = TestData.getLastRow("NewLoan");
			System.out.println("NewLoan " + lastrow);
			String sheetName = "NewLoan";
			for (int row = 2; row <= lastrow; row++) {
				String RegSSN = TestData.getCellData(sheetName, "SSN", row);
				if (SSN.equals(RegSSN)) {

					String ProductID = TestData.getCellData(sheetName, "ProductID", row);
					String UserName = TestData.getCellData(sheetName, "UserName", row);
					String Password = TestData.getCellData(sheetName, "Password", row);
					String StoreID = TestData.getCellData(sheetName, "StoreID", row);
					String AdminURL = TestData.getCellData(sheetName, "AdminURL", row);

					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);
					String AppURL = TestData.getCellData(sheetName, "AppURL", row);
					appUrl = AppURL;
					this.Login(UserName, Password, StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3, 5);
					String SSN3 = SSN.substring(5, 9);
					Thread.sleep(5000);
					Thread.sleep(1000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: " + SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: " + SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: " + SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for (String winHandle : driver.getWindowHandles()) {
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					Thread.sleep(2000);
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for (String winHandle : driver.getWindowHandles()) {
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if (ProductID.equals("ILP")) {

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					 if(ProductID.equals("TLP"))
					 {
						 driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					 }
					test.log(LogStatus.PASS, "Click on GO Button");
					for (String winHandle1 : driver.getWindowHandles()) 
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if (ProductID.equals("ILP")) {

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}

					for (String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					 if(ProductID.equals("TLP"))
					 {
						 driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					 }
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate = null;

					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]")).getText();
					test.log(LogStatus.PASS, "Capture DueDate" + DueDate);
					System.out.print(DueDate);
					driver.close();

					driver = new InternetExplorerDriver();
					driver.get(AdminURL);

					DateFormat df = new SimpleDateFormat("MM/dd/yyyy");
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: " + Password);
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Thread.sleep(8000);

					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					Thread.sleep(5000);
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					String DDueDate[] = DueDate.split("/");

					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1 = cal.getTime();

					DueDate = df.format(DDueDate1);

					String DueDate0[] = DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];

				

					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();
					driver.findElement(By.name("storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: " + StoreID);
					Thread.sleep(5000);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "beginMonth is entered: " + DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: " + DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: " + DueDate3);
					Thread.sleep(2000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					Thread.sleep(1000);
					Thread.sleep(5000);
					driver.findElement(By.name("btnPreview")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if (driver
							.findElement(By
									.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input"))
							.isDisplayed()) {
						test.log(LogStatus.PASS, "Process Date updated successfully");
						driver.findElement(By
								.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input"))
								.click();
					} else {
						test.log(LogStatus.FAIL, "Process Date not updated successfully.");
					}

				}
			}
		}
		
		
	public void AgeStore_1stInst_DueDate10DaysBefore(String SSN,String FileName,int Days) throws Exception
		{
//----------------done-----------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan"; 
			for(int row=2;row<=lastrow;row++)
			{ 
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row); 
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					System.out.println(ProductID); 
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					//Thread.sleep(5000);
					Thread.sleep(1000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}


					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;



					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]")).getText();


					test.log(LogStatus.PASS, "Capture DueDate"+DueDate);


					System.out.print(DueDate); 

					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);
					driver.manage().window().maximize();


					DateFormat df=new SimpleDateFormat("MM/dd/yyyy"); 

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin"); 

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password); 


					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
Thread.sleep(2000);
					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");


					String DDueDate[] =DueDate.split("/");


					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];




					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					driver.findElement(By.name("storeCode")).click();


					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.findElement(By.name("btnPreview")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())
					{ 
						test.log(LogStatus.PASS, "Process Date updated successfully");

						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();
					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date not updated successfully.");

					}
				}

			}

		}
		public void Renewal_Status(String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);    
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";             
			for(int row=2;row<=lastrow;row++)
			{       
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);   
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					test.log(LogStatus.INFO, "RPP(Starts)");

					System.out.println(ProductID);  
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreID, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();                      
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					test.log(LogStatus.INFO,"Navigated To Loan Transaction Screen");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();                  
					test.log(LogStatus.PASS, "Clicked on Transactions");            
					driver.switchTo().frame("main");        
					test.log(LogStatus.INFO,"Navigate to Transactions Screen");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");     

					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Customer Record Screen");
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}                                   
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Line Of Credit History Screen");
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}                       
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Transaction List Screen");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					test.log(LogStatus.INFO,"Navigate to History Credit Table Screen");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.INFO,"Transaqction Selection Go Button Click");
					String CheckStatus=null;
					CheckStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[18]/td/span[2]")).getText();
					if(CheckStatus.equals("Y")){
						test.log(LogStatus.PASS,"Is Loan Renewal status : "+CheckStatus);
						test.log(LogStatus.INFO,"Renewal Transaction Done Successfully");
						System.out.print(CheckStatus);  
					}
					else
					{
						test.log(LogStatus.PASS,"Is Loan in Renewal : "+CheckStatus);
						test.log(LogStatus.INFO,"Renewal Transaction is faild");
						System.out.print(CheckStatus);
					}
				}       
			}
		}

		
		public WebElement Field(WebDriver driver) {

			try {
				Thread.sleep(500);
				WebElement element = (new WebDriverWait(driver, 9)).until(ExpectedConditions
						.visibilityOfElementLocated(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr/td/table")));
				return element;
			} catch (Exception e) {
				return null;
			}
		}


		public void Drawerassign(String SSN, String FileName) throws Exception {

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow = TestData.getLastRow("NewLoan");
			System.out.println("NewLoan " + lastrow);
			String sheetName = "NewLoan";
			for (int row = 2; row <= lastrow; row++) {
				String RegSSN = TestData.getCellData(sheetName, "SSN", row);
				if (SSN.equals(RegSSN)) {
					String TxnType = TestData.getCellData(sheetName, "TxnType", row);
					String TenderType = TestData.getCellData(sheetName, "TenderType", row);
					String ProductID = TestData.getCellData(sheetName, "ProductID", row);
					String AppURL = TestData.getCellData(sheetName, "AppURL", row);
					String UserName = TestData.getCellData(sheetName, "UserName", row);
					String Password = TestData.getCellData(sheetName, "Password", row);
					String StoreId = TestData.getCellData(sheetName, "StoreID", row);

					Thread.sleep(2000);

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					Thread.sleep(5000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Cash Management')]")).click();
					test.log(LogStatus.PASS, "Clicked on Cash Management");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.linkText("Drawer")).click();
					test.log(LogStatus.PASS, "Clicked on Drawer");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("Assign")).click();
					test.log(LogStatus.PASS, "Clicked on Assign");

					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					driver.findElement(By.name("drawerAssignRequestBean.noOf100Dollars")).sendKeys("500");
					test.log(LogStatus.PASS, "Count of Dollar Coins is entered as 500");

					driver.findElement(By.name("drawerAssignRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Passwored is Entered");
					driver.findElement(By.name("drawerassign")).click();
					test.log(LogStatus.PASS, "Clicked on Drawer Assigen Button");
					try {
						Alert alert = driver.switchTo().alert();
						alert.accept();

					} catch (NoAlertPresentException e) {

					}

					Thread.sleep(2000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if (this.Field(driver) != null) {
						Thread.sleep(1000);
						driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						driver.findElement(By.linkText("Safe")).click();
						test.log(LogStatus.PASS, "Clicked on Safe");
						driver.findElement(By.linkText("Deassign")).click();
						test.log(LogStatus.PASS, "Clicked on Deassign");
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.name("safeDeassignRequestBean.noOfDollars")).sendKeys("0");
						test.log(LogStatus.PASS, "Enter the Value 0");

						driver.findElement(By.name("safeDeassignRequestBean.password")).sendKeys(Password);
						test.log(LogStatus.PASS, "Enter the Password");

						driver.findElement(By.name("safedeassign")).click();
						test.log(LogStatus.PASS, "Click on the Safe Deassign Button");

						try {
							Alert alert = driver.switchTo().alert();
							alert.accept();

						} catch (NoAlertPresentException e) {

						}
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if (driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).isDisplayed()) {
							test.log(LogStatus.PASS, "Safe De-assigned successfully with over/short.");
							driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).click();
						} else {
							driver.findElement(By.name("safeDeassignRequestBean.password")).sendKeys(Password);
							test.log(LogStatus.PASS, "Enter the Password");
							driver.findElement(By.name("safedeassign")).click();
							test.log(LogStatus.PASS, "Click on the Deassign");
							for (String winHandle : driver.getWindowHandles()) {
								driver.switchTo().window(winHandle);
							}
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							String DrawerOverShortAmount = driver.findElement(By.name("safeRequestBean.safeOverShort"))
									.getAttribute("value");
							driver.findElement(By.name("safeRequestBean.amount")).sendKeys(DrawerOverShortAmount);
							test.log(LogStatus.PASS, "Amount entered as " + DrawerOverShortAmount);
							driver.findElement(By.name("safeRequestBean.primary")).sendKeys("Counterfeit Bill");
							test.log(LogStatus.PASS, "Primary Reason is selected as Counterfeit Bill");
							driver.findElement(By.name("safeRequestBean.notes")).sendKeys("Notes");
							test.log(LogStatus.PASS, "Notes Entered ");
							driver.findElement(By.name("bt_AddDrawer")).click();
							test.log(LogStatus.PASS, "Click on Add O/S Instance Button");
							Thread.sleep(3000);
							driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[4]/tbody/tr[3]/td[1]/input")).click();

							test.log(LogStatus.PASS, "Click on Finish Safe O/S");
							try {
								Alert alert = driver.switchTo().alert();
								alert.accept();

							} catch (NoAlertPresentException e) {
							}
							Thread.sleep(2000);
							for (String winHandle : driver.getWindowHandles()) {
								driver.switchTo().window(winHandle);
							}
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");

							if (driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).isDisplayed()) {

								test.log(LogStatus.PASS, "Safe De-assigned successfully with over/short.");
								driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).click();
							} else {
								test.log(LogStatus.PASS, "Safe not De-assigned successfully with over/short.");
							}
						}
						Thread.sleep(1000);
						driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						driver.findElement(By.linkText("Safe")).click();
						test.log(LogStatus.PASS, "Clicked on Assign");
						driver.findElement(By.linkText("Assign")).click();
						test.log(LogStatus.PASS, "Clicked on Assign");
						Thread.sleep(3000);

						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						driver.findElement(By.name("safeAssignRequestBean.empPwd")).sendKeys("1234");
						test.log(LogStatus.PASS, "Passwored is Entered");

						driver.findElement(By.name("safeAssignRequestBean.noOf100Dollars")).sendKeys("500");
						test.log(LogStatus.PASS, "Count of Dollar Coins is entered as 500");

						driver.findElement(By.name("safeassign")).click();
						test.log(LogStatus.PASS, "Click on Safe Assigen");

						try {
							Alert alert = driver.switchTo().alert();
							alert.accept();

						} catch (NoAlertPresentException e) {

						}
						Thread.sleep(3000);
						driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						if (driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).isDisplayed()) {

							test.log(LogStatus.PASS, "Safe assigned successfully.");
							driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).click();
						} else {
							test.log(LogStatus.PASS, "Safe not assigned successfully.");
						}

						Thread.sleep(1000);
						driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						driver.findElement(By.linkText("Drawer")).click();
						test.log(LogStatus.PASS, "Clicked on Drawer");
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.findElement(By.linkText("Assign")).click();
						test.log(LogStatus.PASS, "Clicked on Assign");

						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						driver.findElement(By.name("drawerAssignRequestBean.noOf100Dollars")).sendKeys("500");
						test.log(LogStatus.PASS, "Count of Dollar Coins is entered as 500");

						driver.findElement(By.name("drawerAssignRequestBean.password")).sendKeys(Password);
						test.log(LogStatus.PASS, "Passwored is Entered");
						driver.findElement(By.name("drawerassign")).click();
						test.log(LogStatus.PASS, "Click on drawer Assigen Button");
						try {
							Alert alert = driver.switchTo().alert();
							alert.accept();

						} catch (NoAlertPresentException e) {

						}
						Thread.sleep(2000);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						if (driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed()) {

							test.log(LogStatus.PASS, "Drawer De-assigned successfully with over/short.");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						} else {
							test.log(LogStatus.PASS, "Drawer not De-assigned successfully with over/short.");
						}

					} else {
						if (driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed()) {

							test.log(LogStatus.PASS, "Drawer Assigned successfully with over/short.");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						} else {
							test.log(LogStatus.PASS, "Drawer not Assigned successfully with over/short.");
						}
					}

				}
			}
		}

		
		
		
		public void DrawerDeassign(String SSN,String FileName) throws Exception{
			//-------------done updating
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
				int lastrow=TestData.getLastRow("NewLoan");
				String sheetName="NewLoan";	
				test.log(LogStatus.INFO, "Drawer Deassign");
				for(int row=2;row<=lastrow;row++)
				{	
					String RegSSN = TestData.getCellData(sheetName,"SSN",row);
					if(SSN.equals(RegSSN))
					{
						String TxnType=TestData.getCellData(sheetName,"TxnType",row);
						String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
						String ProductID=TestData.getCellData(sheetName,"ProductID",row);
						String AppURL = TestData.getCellData(sheetName,"AppURL",row);
						String UserName = TestData.getCellData(sheetName,"UserName",row);
						String Password = TestData.getCellData(sheetName,"Password",row);
						String StoreId = TestData.getCellData(sheetName,"StoreID",row);
						String SSN1 = SSN.substring(0, 3);
						String SSN2 = SSN.substring(3,5);
						String SSN3 = SSN.substring(5,9);
						CSRLoginpage login = new CSRLoginpage();
						login.Login(UserName, Password, StoreId, driver, AppURL, test);
						driver.switchTo().defaultContent();				
						driver.switchTo().frame("topFrame");
						driver.findElement(By.xpath("//*[contains(text(),'Cash Management')]")).click();			
						test.log(LogStatus.PASS, "Clicked on Cash Management");
						driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.findElement(By.linkText("Drawer")).click();
						test.log(LogStatus.PASS, "Clicked on Drawer");	
						driver.findElement(By.linkText("Deassign")).click();
						test.log(LogStatus.PASS, "Clicked on Deassign");	
						driver.switchTo().frame("main");		
						driver.findElement(By.name("drawerDeassignRequestBean.noOfDollars")).sendKeys("0");
						test.log(LogStatus.PASS, "Current Cash Balance is provided as 0");	
						driver.findElement(By.name("drawerDeassignRequestBean.password")).sendKeys(Password);
						test.log(LogStatus.PASS, "Banker PIN# is enetered as"+Password);	
						driver.findElement(By.name("drawerdeassign")).click();
						test.log(LogStatus.PASS, "Click on Finish De-assign Button");
						
						try{
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//driver.close();
						}
						catch (Exception e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(2000);
						
						driver.findElement(By.name("drawerDeassignRequestBean.password")).clear();
						driver.findElement(By.name("drawerDeassignRequestBean.password")).click();
						driver.findElement(By.name("drawerDeassignRequestBean.password")).sendKeys(Password);				
						driver.findElement(By.name("drawerdeassign")).click();
						try{
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//driver.close();
						}
						catch (Exception e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(2000);
						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[9]/td[2]/table")).isDisplayed())
						{
							 WebElement htmltable=driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[9]/td[2]/table"));	
							    
								List<WebElement> rows=htmltable.findElements(By.tagName("tr"));
								//System.out.println("current row num "+rows.size());
								int count=0;							
								 count=driver.findElements(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[9]/td[2]/table/tbody/tr")).size();				 				
								for(int rnum=1;rnum<rows.size();rnum++)
								{                      
									//System.out.println("current row num "+rnum);						
									driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[9]/td[2]/table/tbody/tr[2]/td[5]/select")).sendKeys("Delete");
									driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[9]/td[2]/table/tbody/tr[2]/td[6]/input")).click();						
									try { 
										Alert alert = driver.switchTo().alert();
										alert.accept();
										//if alert present, accept and move on.														

									}
									catch (NoAlertPresentException e) {
										//do what you normally would if you didn't have the alert.
									}
															}
						}
						Thread.sleep(2000);
						String DrawerOverShortAmount =driver.findElement(By.name("drawerRequestBean.drawerOverShort")).getAttribute("value");
						driver.findElement(By.name("drawerRequestBean.amount")).sendKeys(DrawerOverShortAmount);
						test.log(LogStatus.PASS, "Amount entered as "+DrawerOverShortAmount);
						driver.findElement(By.name("drawerRequestBean.primary")).sendKeys("Cash Handling");
						test.log(LogStatus.PASS, "Primary Reason is selected as Cash Handling");
						driver.findElement(By.name("drawerRequestBean.notes")).sendKeys("Notes");
						test.log(LogStatus.PASS, "Notes Entered ");	
						driver.findElement(By.name("bt_AddDrawer")).click();
						test.log(LogStatus.PASS, "Click on Add O/S Instance Button");	
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[4]/tbody/tr[3]/td[1]/input")).click();

						test.log(LogStatus.PASS, "Click on Finish Drawer O/S");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}				    
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())
						{

							test.log(LogStatus.PASS,"Drawer De-assigned successfully with over/short.");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL,"Drawer is not De-assigned");
						}
					}
				}
			}

		
	
		public void StatementGeneration_EODProcessing(String SSN,String FileName) throws Exception{

			//-------------done updating
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
				int lastrow=TestData.getLastRow("NewLoan");
				String sheetName="NewLoan";		
				test.log(LogStatus.INFO, "EOD Processing");
				for(int row=2;row<=lastrow;row++)
				{	
					String RegSSN = TestData.getCellData(sheetName,"SSN",row);
					if(SSN.equals(RegSSN))
					{
						String TxnType=TestData.getCellData(sheetName,"TxnType",row);
						String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
						String ProductID=TestData.getCellData(sheetName,"ProductID",row);
						String AppURL = TestData.getCellData(sheetName,"AppURL",row);
						String UserName = TestData.getCellData(sheetName,"UserName",row);
						String Password = TestData.getCellData(sheetName,"Password",row);
						String StoreId = TestData.getCellData(sheetName,"StoreID",row);
						String SSN1 = SSN.substring(0, 3);
						String SSN2 = SSN.substring(3,5);
						String SSN3 = SSN.substring(5,9);
						
						WebDriverWait wait = new WebDriverWait(driver, 30);
						
						CSRLoginpage login = new CSRLoginpage();
						login.Login(UserName, Password, StoreId, driver, AppURL, test);
						driver.switchTo().defaultContent();				
						driver.switchTo().frame("topFrame");
						driver.findElement(By.xpath("//*[contains(text(),'Daily Processing')]")).click();			
						test.log(LogStatus.PASS, "Clicked on Daily Processing");
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");

						driver.findElement(By.name("eod")).click();
						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}

						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						
						driver.findElement(By.name("requestBean.noOf100Dollars")).sendKeys("500");
						test.log(LogStatus.PASS,"Count of Dollar Coins is entered as 500");

						driver.findElement(By.name("requestBean.comments")).sendKeys("comment");
						test.log(LogStatus.PASS,"Comments entered as 'comment'");
						driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
						driver.findElement(By.name("Submit2")).click();
						test.log(LogStatus.PASS,"Clicked on Balance Safe");
						
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {

						}
						Thread.sleep(2000);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						wait.until(ExpectedConditions.elementToBeClickable(By.name("Submit2")));
						driver.findElement(By.name("Submit2")).click();
						test.log(LogStatus.PASS,"Clicked on Balance Safe");
						
						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}				    
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						String SafeOverShortAmount = driver.findElement(By.name("requestBean.safeOverShort")).getAttribute("value");
						driver.findElement(By.name("requestBean.amount")).sendKeys(SafeOverShortAmount);
						test.log(LogStatus.PASS,"Entered the Balance as"+SafeOverShortAmount);
						driver.findElement(By.name("requestBean.primary")).sendKeys("Deposit Issue");
						test.log(LogStatus.PASS, "Primary Reason is selected as Deposit Issue");
						driver.findElement(By.name("requestBean.notes")).sendKeys("Notes");
						test.log(LogStatus.PASS, "Notes Entered ");	
						driver.findElement(By.name("bt_AddDrawer")).click();
						test.log(LogStatus.PASS, "Click on Add O/S Instance Button");	
						
						wait.until(ExpectedConditions.elementToBeClickable(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[11]/td[3]/input")));
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[3]/tbody/tr[11]/td[3]/input")).click();
						test.log(LogStatus.PASS, "Clicked on Next");

						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {

						}

						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}				    
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.findElement(By.name("Next"));
						// Next
						test.log(LogStatus.PASS, "Clicked on Next");
						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}	
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");

						driver.findElement(By.xpath("/html/body/form/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[3]/td[2]/input[3]")).click();
						test.log(LogStatus.PASS, "Clicked on Next");
						for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}	
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");

						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[3]/td[2]/input[3]")).click();
						test.log(LogStatus.PASS, "Clicked on Next");
						driver.findElement(By.name("requestBean.bagNbr")).sendKeys("34");
						test.log(LogStatus.PASS, "Bag number is provided as 34");
						driver.findElement(By.name("finishdeposit")).click();
						test.log(LogStatus.PASS, "Clicked on Finish Deposit");
						test.log(LogStatus.PASS, "StatmentGeneration EOD Processing Completed");
					
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.

						}

					}
				}
			}
	
		
		public void StoreInfo(String SSN,String FileName) throws Exception
		{
		//-------------done updating
	Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
		int lastrow=TestData.getLastRow("NewLoan");
		String sheetName="NewLoan";		
		test.log(LogStatus.INFO, "Edit Store Info");
		for(int row=2;row<=lastrow;row++)
		{	
			String RegSSN = TestData.getCellData(sheetName,"SSN",row);
			if(SSN.equals(RegSSN))
			{
				String TxnType=TestData.getCellData(sheetName,"TxnType",row);
				String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
				String ProductID=TestData.getCellData(sheetName,"ProductID",row);
				String UserName = TestData.getCellData(sheetName,"UserName",row);
				String Password = TestData.getCellData(sheetName,"Password",row);
				String StoreID = TestData.getCellData(sheetName,"StoreID",row);
				String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
						
				driver.get(AdminURL);
				test.log(LogStatus.PASS, "Admin portal is launched");	
				driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
				test.log(LogStatus.PASS, "Username is entered: "+UserName);			        
				driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
				test.log(LogStatus.PASS, "Password is entered: "+Password);					  	        			   			
				driver.findElement(By.name("login")).click();
				test.log(LogStatus.PASS, "Clicked on Submit button");			
				Thread.sleep(3000);
				driver.switchTo().defaultContent();
				driver.switchTo().frame("topFrame");
		driver.findElement(By.xpath("//*[contains(text(),'Store Setup')]")).click();	
		test.log(LogStatus.PASS, "Clicked on Store Setup");
		Thread.sleep(1000);
		driver.switchTo().defaultContent();
		driver.switchTo().frame("mainFrame");
		driver.findElement(By.linkText("Store Config")).click();
		test.log(LogStatus.PASS, "Clicked on Store Config");
		driver.findElement(By.linkText("Edit Store")).click();
		test.log(LogStatus.PASS, "Clicked on Edit Store");			
		driver.switchTo().frame("main");		
		  driver.findElement(By.name("locationBean.locNbr")).sendKeys(StoreID);
		  test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
		  driver.findElement(By.name("Submit2")).click();
		  test.log(LogStatus.PASS, "Clicked on submit button");
		  
		  for(String winHandle : driver.getWindowHandles())
		  {
			    driver.switchTo().window(winHandle);
		} 
		     driver.switchTo().defaultContent();
			 driver.switchTo().frame("mainFrame");
			 driver.switchTo().frame("main");													  	 	  
		     driver.findElement(By.name("locationBean.locStatusCd")).sendKeys("Crash Package");
		     driver.switchTo().defaultContent();
			 driver.switchTo().frame("mainFrame");
			 driver.switchTo().frame("main");													    	
			 if(driver.findElement(By.name("submitButton")).isDisplayed())
				{
				 test.log(LogStatus.PASS, "Store Edit is Successfully completed ");
					driver.findElement(By.name("submitButton")).click();
				}
			 else
				{
					test.log(LogStatus.FAIL, "Store Edit is not Successfull ");
				}
			}
			}
		}
		
		public void Safeassign(String SSN,String FileName) throws Exception{
			//-------------done updating
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
				int lastrow=TestData.getLastRow("NewLoan");
				String sheetName="NewLoan";		
				test.log(LogStatus.INFO, "Safe Assign");
				for(int row=2;row<=lastrow;row++)
				{	
					String RegSSN = TestData.getCellData(sheetName,"SSN",row);
					if(SSN.equals(RegSSN))
					{
						String TxnType=TestData.getCellData(sheetName,"TxnType",row);
						String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
						String ProductID=TestData.getCellData(sheetName,"ProductID",row);
						String AppURL = TestData.getCellData(sheetName,"AppURL",row);
						String UserName = TestData.getCellData(sheetName,"UserName",row);
						String Password = TestData.getCellData(sheetName,"Password",row);
						 String StoreId = TestData.getCellData(sheetName,"StoreID",row);
						 CSRLoginpage login = new CSRLoginpage();
						 login.Login(UserName, Password, StoreId, driver, AppURL, test);
					
						driver.switchTo().defaultContent();				
						driver.switchTo().frame("topFrame");
						driver.findElement(By.xpath("//*[contains(text(),'Cash Management')]")).click();			
						test.log(LogStatus.PASS, "Clicked on Cash Management");
						driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.findElement(By.linkText("Safe")).click();
						test.log(LogStatus.PASS, "Clicked on Assign");	
						driver.findElement(By.linkText("Assign")).click();
						test.log(LogStatus.PASS, "Clicked on Assign");
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.name("safeAssignRequestBean.empPwd")).sendKeys(Password);
						driver.findElement(By.name("safeAssignRequestBean.noOf100Dollars")).sendKeys("500");
						driver.findElement(By.name("safeassign")).click();
						
						try { 
						    Alert alert = driver.switchTo().alert();
						    alert.accept();
						    //if alert present, accept and move on.														
							
						}
						catch (NoAlertPresentException e) {
						    //do what you normally would if you didn't have the alert.
							
						}
						Thread.sleep(2000);
						 driver.switchTo().defaultContent();
						 driver.switchTo().frame("mainFrame");
						 driver.switchTo().frame("main");
						    
						    if(driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).isDisplayed())
						    {
						
						    	 test.log(LogStatus.PASS,"Safe assigned successfully with over/short.");
						    	 driver.findElement(By.xpath("//input[(@type='submit') and (@value='Ok')]")).click();
						    	 				    }
						    else
						    {
						    	test.log(LogStatus.FAIL,"Safe is not assigned .");
						    }
						}
						}
						}


		public void Payment (String SSN,String FileName) throws Exception
		{
//------------done------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";
			for(int row=2;row<=lastrow;row++)
			{
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(2000);
					driver.switchTo().defaultContent();
					WebDriverWait wait = new WebDriverWait(driver, 30); 
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);
					}

					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);
					}
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Payment");
					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");
					
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}
					
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}

					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish Loan button ");

						try 
						{
							Alert alert = driver.switchTo().alert();
							alert.accept();
						}
						catch (NoAlertPresentException e) 
						{

						}

						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}
						
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Payment is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Payment Loan is not Completed Successfully ");
						}
					}

					if(ProductID.equals("PDL"))
					{
						if(ESign_DisbType.equals("Check"))
						{
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						}
						
						if(ESign_DisbType.equals("Cash"))
						{
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
						}

						if((ESign_DisbType.equals("Cash")||(ESign_DisbType.equals("Check")))&&((ESign_DisbType2.equals("Check"))||(ESign_DisbType.equals("Cash")) ))
						{
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("TenderType");
						}

						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='PD4']")).click();
						test.log(LogStatus.PASS, " Click payment amt Type ");
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");
						test.log(LogStatus.PASS, "tenderType as Cash ");					
						String pmtamt = driver.findElement(By.name("instAmt")).getAttribute("value");
						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(pmtamt);
					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish Payament Loan button ");
					}

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]")).click();
					{
						if(driver.findElement(By.name("Ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Partial Payment is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Partial Payment is not Completed Successfully ");
						}
					}
				}
			}
		}	

		public void NewLoanWithVIN(String SSN,String FileName,String NewVIN) throws Exception{

//----------------done
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					//String Term = TestData.getCellData(sheetName,"Term",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					//String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					//System.out.println(Term);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					//String stateProduct=State+" "+ProductID;
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);	
					String ABA_Number = TestData.getCellData(sheetName,"ABARoutingNbr",row);
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					//String UserName = TestData.getCellData(sheetName,"UserName",row);
					//String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					//String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					//String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					//String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					//*[@id="911100"]/a
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					//*[@id="911100"]/a
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input      Loan2
					// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input      Loan1
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					//	Selection of Product based on the Name provided in Test Data

					//if(driver.findElement(By.id("LoanButtonId")).isEnabled())
					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
						if(ProductID.equals("TLP"))							
						{					
							System.out.println("IN TLP");
							// name="vehicleChk"   //*[@id="veh1"]
							////*[@id="vehicleType_dd"]
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							// //*[@id="vinDD"]
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							// //*[@id="vinPop"]/div/table[1]/tbody/tr[1]/td[2]/input
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();	


							Thread.sleep(3000);
						}												
					
					if(ProductName.equals("Tennessee"))
					{
						//driver.findElement(By.xpath("//*[@id="termSel1"]")).click();
						
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					
					
					driver.findElement(By.name("ShareScreenBtn")).click();
					test.log(LogStatus.PASS, "ShareScreen Button clicked");
					for( String winHandle1 : driver.getWindowHandles())

					{
						if(!(winHandle1.equals(Parent_Window)))
						{
							driver.switchTo().window(winHandle1);
							Thread.sleep(1000);
							driver.findElement(By.name("confirmSummary")).click();
							test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
						}

					}
					Thread.sleep(3000);
					driver.switchTo().window(Parent_Window);

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}                 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");
					driver.findElement(By.id("LoanButtonId")).click();
					test.log(LogStatus.PASS, "Clicked on New Loan button");
					//New Loan Screens
					if(ProductID.equals("PDL"))
					{	

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						if(!(ESign_LoanAmt.isEmpty()))
						{
							driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[13]/td[3]/input")).sendKeys(ESign_LoanAmt);
							test.log(LogStatus.PASS, "Loan amount is enterted as "+ESign_LoanAmt);
						}
						driver.findElement(By.xpath("//*[@id='chkgAcctNbr']")).sendKeys(last4cheknum);
						test.log(LogStatus.PASS, "	Chkg Acct Nbr(Last 4 Digits Only) is enterted as "+last4cheknum);					
						//Thread.sleep(5000);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.xpath("//*[@id='advanceRequestBean.disbursementType']")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type1 is enterted as "+ESign_DisbType);
						//Thread.sleep(2000);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys("215");					
						test.log(LogStatus.PASS, "Disb Amt1 is enterted as ::" +"215");
						//Thread.sleep(5000);
						driver.findElement(By.name("advanceRequestBean.disbursementTypeSecond")).sendKeys(ESign_DisbType2);
						test.log(LogStatus.PASS, "Disb Type2 is selected as ::Cash");



						driver.findElement(By.name("advanceRequestBean.disbAmtSecond")).sendKeys("210");
						test.log(LogStatus.PASS, "Disb Amt2 is enterted as 210");

						//test.log(LogStatus.PASS, "Disb Amt is enterted as 210");
						///driver.findElement(By.name("advanceRequestBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
						//test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						driver.findElement(By.name("advanceRequestBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Electronic Communication Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.xpath("//*[@id='allowCoupons']/td[3]/input")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.xpath("//*[@id='coupon']/td[3]/div[1]/input")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
						}

						driver.findElement(By.xpath("//*[@id='idNoChecks']/td[3]/select")).sendKeys(ESign_Checks);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Checks);
						WebDriverWait wait = new WebDriverWait(driver, 30); 	
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//*[@id='chkNbr0']")));
						driver.findElement(By.xpath("//*[@id='chkNbr0']")).sendKeys(ESign_CheckNbr);
						test.log(LogStatus.PASS, "Check number is "+ESign_CheckNbr);
						driver.findElement(By.name("advanceRequestBean.loggedUserPassword")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishadvance")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");
						

						try { 
							Alert alert = driver.switchTo().alert();
							String Var1 = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var1);
							alert.accept();
						}
						catch (NoAlertPresentException e)
						{
						}
						Thread.sleep(2000);
						try { 
							Alert alert = driver.switchTo().alert();
							String Var = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var);
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						// driver.findElement(By.name("OKBut")).click();					
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("bdyLoad");
						
					}

				

					if(ProductID.equals("TLP"))
					{	
						String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
						String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
						String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
						String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
						//String VehicleGrade=TestData.getCellData(sheetName,"Vehicle Grade",row);
						String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
						String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
						String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
						String PhoneNbr1 = PhoneNbr.substring(0, 3);
						String PhoneNbr2 = PhoneNbr.substring(3, 6);
						String PhoneNbr3 = PhoneNbr.substring(6, 10);
						String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
						String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
						String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
						String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
						String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
						String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
						String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
						driver.findElement(By.name("requestBean.titleNumber")).clear();
						driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
						driver.findElement(By.name("requestBean.appraisalVal")).clear();
						driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
						driver.findElement(By.name("button1")).click();
						test.log(LogStatus.PASS, "click on Update 1 button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						WebDriverWait wait = new WebDriverWait(driver, 10);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
						driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
						//requestBean.licensePltNbr
						driver.findElement(By.name("requestBean.licensePltNbr")).clear();
						driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
						//requestBean.licensePltExpire
						driver.findElement(By.name("requestBean.licensePltExpire")).clear();
						driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
						//requestBean.paintCondition
						driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
						driver.findElement(By.name("iPhoneNbr1")).clear();
						driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
						driver.findElement(By.name("iPhoneNbr2")).clear();
						driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);
						driver.findElement(By.name("iPhoneNbr3")).clear();
						driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
						driver.findElement(By.name("requestBean.companyName")).clear();
						driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
						driver.findElement(By.name("iexpiry1")).clear();
						driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
						driver.findElement(By.name("iexpiry2")).clear();
						driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
						driver.findElement(By.name("iexpiry3")).clear();
						driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
						driver.findElement(By.name("requestBean.polocyNbr")).clear();
						driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
						driver.findElement(By.name("button2")).click();		
						Thread.sleep(1000);
						driver.findElement(By.name("button2")).click();	
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(1000);
						test.log(LogStatus.PASS, "click on Update 2 button ");
						//Thread.sleep(8000);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
						driver.findElement(By.name("process")).click();
						test.log(LogStatus.PASS, "click on process Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(4000);
						/*wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);*/
						
						driver.findElement(By.name("negLoanAmt")).click();
						Thread.sleep(4000);
						for( String winHandle1 : driver.getWindowHandles())
						{
							if(!(winHandle1.equals(Parent_Window)))
							{
								driver.switchTo().window(winHandle1);
								Thread.sleep(1000);
							
						Thread.sleep(4000);

						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.siilBean.advAmt")));
						driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
						Thread.sleep(2000);

						try 
						{ 
							Alert alert = driver.switchTo().alert();
							alert.accept();													

						}
						catch (NoAlertPresentException e)
						{
							
						}
						Thread.sleep(3000);
						WebElement element = driver.findElement(By.name("requestBean.siilBean.advAmt"));                                       
						Actions builder = new Actions(driver); 
						builder.doubleClick()
						
						.sendKeys(element, Keys.DELETE)
						
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.build()
						.perform();
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();													
						}
						catch (NoAlertPresentException e)
						{
						
						}

						Thread.sleep(2000);
						driver.findElement(By.name("requestBean.siilBean.advAmt")).sendKeys("1250");
						driver.findElement(By.name("negSel")).click();
						driver.findElement(By.name("reCalculate")).click();
						driver.findElement(By.name("negSel")).click();
						Thread.sleep(2000);
						driver.switchTo().window(Parent_Window);

						for( String winHandle2 : driver.getWindowHandles())

						{

							driver.switchTo().window(winHandle2);

						}                    

						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");
						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						//requestBean.siilBean.disbType
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						//requestBean.siilBean.advAmt
						String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys("1250");
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+"1250");

						if(ESign_DisbType.equals("ACH"))	
						{

							driver.findElement(By.name("newAbaNbr")).sendKeys(ABA_Number);
							test.log(LogStatus.PASS, "ABA Number entered");
							driver.findElement(By.name("newCkngAccntNbr")).sendKeys(ESign_CheckNbr);
							test.log(LogStatus.PASS, "Newchecking number Enetered");

						}


						Thread.sleep(2000);

						driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							//String mwh=driver.getWindowHandle();
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							//String winHandle = driver.getWindowHandle(); //Get current window handle.									
						}

						if(ESign_CollateralType.equals("CHECK"))
						{
							driver.findElement(By.name("requestBean.checkNbrs")).sendKeys(ESign_CheckNbr);
							test.log(LogStatus.PASS, "Check number Entered");
						}
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "enter the Passwored");
						driver.findElement(By.name("finishLoan")).click();
						test.log(LogStatus.PASS, "Click on Finish Loan Button");
						for( String winHandle3 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle3);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						//driver.findElement(By.name("OKBut")).click();
						//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle4 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle4);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//OKBut
						if(driver.findElement(By.name("ok")).isDisplayed())
							//if(driver.findElement(By.name("OKBut")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							//driver.findElement(By.name("ok")).click();
							driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

						}
					}
					
					//html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[3]/td/input
				}

			}
		}
		
		public void NewLoanWithVIN2_2(String SSN,String FileName,String NewVIN2) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);	
					String ABA_Number = TestData.getCellData(sheetName,"ABARoutingNbr",row);
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled() || driver.findElement(By.id("LoanButtonId")).isEnabled())
						if(ProductID.equals("TLP"))							
						{
							Thread.sleep(2000);										
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN2);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN2);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();				
						}												
					if(ProductName.equals("TNPAYDAY"))
					{
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[3]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("TNPDL all coll"))
					{	
						driver.findElement(By.name("prodSel")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("Tennessee"))
					{
						//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("Line of Credit"))
					{

						if(StoreID.equals("4322"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
						}
						if(StoreID.equals("4353"))
						{
							//*[@id="riskViewBdy"]/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input

							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);

						}
						if(StoreID.equals("1343"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}

					}

					driver.findElement(By.name("ShareScreenBtn")).click();
					test.log(LogStatus.PASS, "ShareScreen Button clicked");
					Set<String> handles = driver.getWindowHandles();
					Iterator<String> i1=handles.iterator();
							 
					while(i1.hasNext())			
					    {		
					        String ChildWindow=i1.next();		
							            		
					        if(!Parent_Window.equalsIgnoreCase(ChildWindow))			
					        {    
									            	
					          	driver.switchTo().window(ChildWindow);
					          	driver.findElement(By.name("confirmSummary")).click();
								test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
					        }
					    }
								         					
					driver.switchTo().window(Parent_Window);

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}                 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");
					driver.findElement(By.id("LoanButtonId")).click();
					
					test.log(LogStatus.PASS, "Clicked on New Loan button");
					//New Loan Screens
					if(ProductID.equals("PDL"))
					{	

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						if(!(ESign_LoanAmt.isEmpty()))
						{
							driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[13]/td[3]/input")).sendKeys(ESign_LoanAmt);
							test.log(LogStatus.PASS, "Loan amount is enterted as "+ESign_LoanAmt);
						}
						driver.findElement(By.xpath("//*[@id='chkgAcctNbr']")).sendKeys(last4cheknum);
						test.log(LogStatus.PASS, "	Chkg Acct Nbr(Last 4 Digits Only) is enterted as "+last4cheknum);					
						Thread.sleep(3000);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.xpath("//*[@id='advanceRequestBean.disbursementType']")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type1 is enterted as "+ESign_DisbType);
						Thread.sleep(2000);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys("215");					
						test.log(LogStatus.PASS, "Disb Amt1 is enterted as ::" +"215");
						Thread.sleep(3000);
						driver.findElement(By.name("advanceRequestBean.disbursementTypeSecond")).sendKeys(ESign_DisbType2);
						test.log(LogStatus.PASS, "Disb Type2 is selected as ::Cash");



						driver.findElement(By.name("advanceRequestBean.disbAmtSecond")).sendKeys("210");
						test.log(LogStatus.PASS, "Disb Amt2 is enterted as 210");
						driver.findElement(By.name("advanceRequestBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Electronic Communication Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.xpath("//*[@id='allowCoupons']/td[3]/input")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.xpath("//*[@id='coupon']/td[3]/div[1]/input")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
						}

						driver.findElement(By.xpath("//*[@id='idNoChecks']/td[3]/select")).sendKeys(ESign_Checks);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Checks);
						WebDriverWait wait = new WebDriverWait(driver, 30);	
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//*[@id='chkNbr0']")));
						driver.findElement(By.xpath("//*[@id='chkNbr0']")).sendKeys(ESign_CheckNbr);
						test.log(LogStatus.PASS, "Check number is "+ESign_CheckNbr);
						driver.findElement(By.name("advanceRequestBean.loggedUserPassword")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishadvance")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");

						try { 
							Alert alert = driver.switchTo().alert();
							String Var1 = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var1);

							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(2000);
						try { 
							Alert alert = driver.switchTo().alert();
							String Var = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var);
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						// driver.findElement(By.name("OKBut")).click();					
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("bdyLoad");

					}

					if(ProductID.equals("ILP"))
					{	
						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);									
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);
						driver.findElement(By.name("requestBean.siilBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							//String mwh=driver.getWindowHandle();
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							//String winHandle = driver.getWindowHandle(); //Get current window handle.									
						}
						WebElement ele = driver.findElement(By.name("requestBean.siilBean.nbrOfInst"));
						String NumofInst=ele.getAttribute("value");
						//*[@id="errorMessage"]/form[1]/table/tbody/tr[4]/td/table[1]/tbody/tr[5]/td[2]/input
						System.out.println(NumofInst);
						int installments = Integer.parseInt(NumofInst);
						for(int i=0;i<installments;i++)
						{
							Random rand = new Random();
							int rand1 = rand.nextInt(100000);	
							String chknum = Integer.toString(rand1);
							driver.findElement(By.id("checkNbrs"+i)).sendKeys(chknum);

						}			 					 			
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						//for( String winHandle1 : driver.getWindowHandles())
						//{
						// driver.switchTo().window(winHandle1);
						//}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						driver.findElement(By.name("OKBut")).click();
						//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.name("ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							//driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

					if(ProductID.equals("TLP"))
					{	
						String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
						String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
						String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
						String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
						String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
						String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
						String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
						String PhoneNbr1 = PhoneNbr.substring(0, 3);
						String PhoneNbr2 = PhoneNbr.substring(3, 6);
						String PhoneNbr3 = PhoneNbr.substring(6, 10);
						String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
						String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
						String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
						String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
						String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
						String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
						String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
						driver.findElement(By.name("requestBean.titleNumber")).clear();
						driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
						driver.findElement(By.name("requestBean.appraisalVal")).clear();
						driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
						driver.findElement(By.name("button1")).click();
						test.log(LogStatus.PASS, "click on Update 1 button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						WebDriverWait wait = new WebDriverWait(driver, 10);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
						driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
						driver.findElement(By.name("requestBean.licensePltNbr")).clear();
						driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
						driver.findElement(By.name("requestBean.licensePltExpire")).clear();
						driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
						driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
						driver.findElement(By.name("iPhoneNbr1")).clear();
						driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
						driver.findElement(By.name("iPhoneNbr2")).clear();
						driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);
						driver.findElement(By.name("iPhoneNbr3")).clear();
						driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
						driver.findElement(By.name("requestBean.companyName")).clear();
						driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
						driver.findElement(By.name("iexpiry1")).clear();
						driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
						driver.findElement(By.name("iexpiry2")).clear();
						driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
						driver.findElement(By.name("iexpiry3")).clear();
						driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
						driver.findElement(By.name("requestBean.polocyNbr")).clear();
						driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
						driver.findElement(By.name("button2")).click();	
						Thread.sleep(2000);
						driver.findElement(By.name("button2")).click();	
						Thread.sleep(2000);
						test.log(LogStatus.PASS, "click on Update 2 button ");
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
						driver.findElement(By.name("process")).click();
						test.log(LogStatus.PASS, "click on process Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(2000);
						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						
						String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");
						driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);

						if(ESign_DisbType.equals("ACH"))	
						{

							driver.findElement(By.name("newAbaNbr")).sendKeys(ABA_Number);
							test.log(LogStatus.PASS, "ABA Number entered");
							driver.findElement(By.name("newCkngAccntNbr")).sendKeys(ESign_CheckNbr);
							test.log(LogStatus.PASS, "Newchecking number Enetered");

						}
						driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
												
						}

						if(ESign_CollateralType.equals("CHECK"))
						{
							driver.findElement(By.name("requestBean.checkNbrs")).sendKeys(ESign_CheckNbr);
							test.log(LogStatus.PASS, "Check number Entered");
						}
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						test.log(LogStatus.PASS, "Click on Finish Loan Button");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						
						if(driver.findElement(By.name("ok")).isDisplayed())
							
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}
				}

			}
		}
							
		public void NewLoanWithVIN2(String SSN,String FileName,String NewVIN2) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					//String Term = TestData.getCellData(sheetName,"Term",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					// String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					//System.out.println(Term);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					//String stateProduct=State+" "+ProductID;
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);	
					String ABA_Number = TestData.getCellData(sheetName,"ABARoutingNbr",row);
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					//String UserName = TestData.getCellData(sheetName,"UserName",row);
					//String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					//String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					//String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					//String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					//*[@id="911100"]/a
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					//*[@id="911100"]/a
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
						if(driver.findElement(By.name("ShareScreenBtn")).isEnabled() || driver.findElement(By.id("LoanButtonId")).isEnabled())
						if(ProductID.equals("TLP"))							
						{					
							System.out.println("IN TLP");
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN2);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN2);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();				
						}												
					if(ProductName.equals("TNPAYDAY"))
					{
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[3]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("TNPDL all coll"))
					{								////*[@id="riskViewBdy"]/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input
						driver.findElement(By.name("prodSel")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("Tennessee"))
					{
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("Line of Credit"))
					{

						if(StoreID.equals("5434"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
						}
						if(StoreID.equals("5434"))
						{

							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);

						}
						if(StoreID.equals("1343"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}

					}

					driver.findElement(By.name("ShareScreenBtn")).click();
					test.log(LogStatus.PASS, "ShareScreen Button clicked");
					for( String winHandle1 : driver.getWindowHandles())

					{
						if(!(winHandle1.equals(Parent_Window)))
						{
							driver.switchTo().window(winHandle1);
							Thread.sleep(1000);
							driver.findElement(By.name("confirmSummary")).click();
							test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
						}

					}
					Thread.sleep(3000);
					driver.switchTo().window(Parent_Window);

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}                 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");
					driver.findElement(By.id("LoanButtonId")).click();
					//driver.findElement(By.id("LoanButtonId")).click();

					test.log(LogStatus.PASS, "Clicked on New Loan button");
					//New Loan Screens
					if(ProductID.equals("PDL"))
					{	

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						if(!(ESign_LoanAmt.isEmpty()))
						{
							driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[13]/td[3]/input")).sendKeys(ESign_LoanAmt);
							test.log(LogStatus.PASS, "Loan amount is enterted as "+ESign_LoanAmt);
						}
						driver.findElement(By.xpath("//*[@id='chkgAcctNbr']")).sendKeys(last4cheknum);
						test.log(LogStatus.PASS, "	Chkg Acct Nbr(Last 4 Digits Only) is enterted as "+last4cheknum);					
						Thread.sleep(3000);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.xpath("//*[@id='advanceRequestBean.disbursementType']")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type1 is enterted as "+ESign_DisbType);
						Thread.sleep(2000);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys("215");					
						test.log(LogStatus.PASS, "Disb Amt1 is enterted as ::" +"215");
						Thread.sleep(3000);
						driver.findElement(By.name("advanceRequestBean.disbursementTypeSecond")).sendKeys(ESign_DisbType2);
						test.log(LogStatus.PASS, "Disb Type2 is selected as ::Cash");



						driver.findElement(By.name("advanceRequestBean.disbAmtSecond")).sendKeys("210");
						test.log(LogStatus.PASS, "Disb Amt2 is enterted as 210");
						driver.findElement(By.name("advanceRequestBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Electronic Communication Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.xpath("//*[@id='allowCoupons']/td[3]/input")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.xpath("//*[@id='coupon']/td[3]/div[1]/input")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
						}

						driver.findElement(By.xpath("//*[@id='idNoChecks']/td[3]/select")).sendKeys(ESign_Checks);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Checks);
					  WebDriverWait wait = new WebDriverWait(driver, 30);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//*[@id='chkNbr0']")));
						driver.findElement(By.xpath("//*[@id='chkNbr0']")).sendKeys(ESign_CheckNbr);
						test.log(LogStatus.PASS, "Check number is "+ESign_CheckNbr);
						driver.findElement(By.name("advanceRequestBean.loggedUserPassword")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishadvance")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");

						try { 
							Alert alert = driver.switchTo().alert();
							String Var1 = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var1);

							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(2000);
						try { 
							Alert alert = driver.switchTo().alert();
							String Var = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var);
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						// driver.findElement(By.name("OKBut")).click();					
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("bdyLoad");

					}

					if(ProductID.equals("ILP"))
					{	
						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);									
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);
						driver.findElement(By.name("requestBean.siilBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							//String mwh=driver.getWindowHandle();
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							//String winHandle = driver.getWindowHandle(); //Get current window handle.									
						}
						WebElement ele = driver.findElement(By.name("requestBean.siilBean.nbrOfInst"));
						String NumofInst=ele.getAttribute("value");
						//*[@id="errorMessage"]/form[1]/table/tbody/tr[4]/td/table[1]/tbody/tr[5]/td[2]/input
						System.out.println(NumofInst);
						int installments = Integer.parseInt(NumofInst);
						for(int i=0;i<installments;i++)
						{
							Random rand = new Random();
							int rand1 = rand.nextInt(100000);	
							String chknum = Integer.toString(rand1);
							driver.findElement(By.id("checkNbrs"+i)).sendKeys(chknum);

						}			 					 			
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						//for( String winHandle1 : driver.getWindowHandles())
						//{
						// driver.switchTo().window(winHandle1);
						//}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						driver.findElement(By.name("OKBut")).click();
						//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.name("ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							//driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

					if(ProductID.equals("TLP"))
					{	
						String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
						String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
						String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
						String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
						//String VehicleGrade=TestData.getCellData(sheetName,"Vehicle Grade",row);
						String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
						String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
						String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
						String PhoneNbr1 = PhoneNbr.substring(0, 3);
						String PhoneNbr2 = PhoneNbr.substring(3, 6);
						String PhoneNbr3 = PhoneNbr.substring(6, 10);
						String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
						String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
						String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
						String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
						String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
						String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
						String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
						//name="requestBean.titleNumber"
						driver.findElement(By.name("requestBean.titleNumber")).clear();
						driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
						//name="requestBean.appraisalVal"
						driver.findElement(By.name("requestBean.appraisalVal")).clear();
						driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
						//driver.findElement(By.xpath("//*[@id='appraisal']")).sendKeys(AppraisalValue);
						//	driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						driver.findElement(By.name("button1")).click();
						test.log(LogStatus.PASS, "click on Update 1 button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						WebDriverWait wait = new WebDriverWait(driver, 10);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
						driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
						//requestBean.licensePltNbr
						driver.findElement(By.name("requestBean.licensePltNbr")).clear();
						driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
						//requestBean.licensePltExpire
						driver.findElement(By.name("requestBean.licensePltExpire")).clear();
						driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
						//requestBean.paintCondition
						driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
						driver.findElement(By.name("iPhoneNbr1")).clear();
						driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
						driver.findElement(By.name("iPhoneNbr2")).clear();
						driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);
						driver.findElement(By.name("iPhoneNbr3")).clear();
						driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
						driver.findElement(By.name("requestBean.companyName")).clear();
						driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
						driver.findElement(By.name("iexpiry1")).clear();
						driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
						driver.findElement(By.name("iexpiry2")).clear();
						driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
						driver.findElement(By.name("iexpiry3")).clear();
						driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
						driver.findElement(By.name("requestBean.polocyNbr")).clear();
						driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
						driver.findElement(By.name("button2")).click();			
						driver.findElement(By.name("button2")).click();		
						test.log(LogStatus.PASS, "click on Update 2 button ");
						Thread.sleep(8000);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
						driver.findElement(By.name("process")).click();
						test.log(LogStatus.PASS, "click on process Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(3000);
						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						//requestBean.siilBean.disbType
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						//requestBean.siilBean.advAmt
						String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");
						driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);

						if(ESign_DisbType.equals("ACH"))	
						{

							driver.findElement(By.name("newAbaNbr")).sendKeys(ABA_Number);
							test.log(LogStatus.PASS, "ABA Number entered");
							driver.findElement(By.name("newCkngAccntNbr")).sendKeys(ESign_CheckNbr);
							test.log(LogStatus.PASS, "Newchecking number Enetered");

						}
						Thread.sleep(5000);

						driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							//String mwh=driver.getWindowHandle();
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							//String winHandle = driver.getWindowHandle(); //Get current window handle.									
						}

						if(ESign_CollateralType.equals("CHECK"))
						{
							driver.findElement(By.name("requestBean.checkNbrs")).sendKeys(ESign_CheckNbr);
							test.log(LogStatus.PASS, "Check number Entered");
						}
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						test.log(LogStatus.PASS, "Click on Finish Loan Button");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						//driver.findElement(By.name("OKBut")).click();
						//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//OKBut
						if(driver.findElement(By.name("ok")).isDisplayed())
							//if(driver.findElement(By.name("OKBut")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							//driver.findElement(By.name("ok")).click();
							driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}
				}

			}
		}
		
		
		public void EODProcessing(String SSN,String FileName) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					Thread.sleep(5000);	    

					driver.switchTo().defaultContent();				
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Daily Processing')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Daily Processing");
					Thread.sleep(1000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");

					driver.findElement(By.name("eod")).click();
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
                    Thread.sleep(2000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					//driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.noOf100Dollars")).sendKeys("500");
					test.log(LogStatus.PASS,"Count of Dollar Coins is entered as 500");

					Thread.sleep(4000);
					// driver.findElement(By.name("requestBean.comments")).click();
					driver.findElement(By.name("requestBean.comments")).sendKeys("comment");
					test.log(LogStatus.PASS,"Count of Dollar Coins is entered as comment");
					// requestBean.comments
					//Thread.sleep(4000);
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.name("Submit2")).click();
					test.log(LogStatus.PASS,"Clicked on Balance Safe");
					Thread.sleep(1000);
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");

					driver.findElement(By.name("Next"));
					// Next
					test.log(LogStatus.PASS, "Clicked on Next");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}	
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");

					driver.findElement(By.xpath("/html/body/form/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[3]/td[2]/input[3]")).click();
					test.log(LogStatus.PASS, "Clicked on Next");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}	
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");

					driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[3]/td[2]/input[3]")).click();
					test.log(LogStatus.PASS, "Clicked on Next");
					driver.findElement(By.name("requestBean.bagNbr")).sendKeys("34");
					test.log(LogStatus.PASS, "Bag number is provided as 34");
					driver.findElement(By.name("finishdeposit")).click();
					test.log(LogStatus.PASS, "Clicked on Finish Deposit");
					test.log(LogStatus.PASS, "EOD Processing Completed");
					Thread.sleep(4000);

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
					}
				}
			}
		}

		public void AgeStore_1stLoan_1ndInst(String SSN,String FileName,int days) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");						
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;				
					DueDate=driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();
					System.out.print(DueDate);						
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[@id='icons']/li[7]/a")).click();
					driver.close();															
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					storeupdate(UserName,Password,StoreID,DueDate,AdminURL,days);
				}
			}
		}


		public void AgeStore_1stLoan_2ndInst(String SSN,String FileName,int days) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");						
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;		
					DueDate=driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();
					System.out.print(DueDate);						
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[@id='icons']/li[7]/a")).click();
					driver.close();															
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					storeupdate(UserName,Password,StoreID,DueDate,AdminURL,days);
				}
			}
		}


		public void AgeStore_2ndLoan_1stInst(String SSN,String FileName,int days) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");						
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;				

					DueDate=driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();
					System.out.print(DueDate);					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[@id='icons']/li[7]/a")).click();
					driver.close();															
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					storeupdate(UserName,Password,StoreID,DueDate,AdminURL,days);
				}
			}
		}

		public void AgeStore_2ndLoan_2stInst(String SSN,String FileName,int days) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");						
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;					

					DueDate=driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();
					System.out.print(DueDate);	
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[@id='icons']/li[7]/a")).click();
					driver.close();															
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					storeupdate(UserName,Password,StoreID,DueDate,AdminURL, days);
				}
			}
		}

		public void storeupdate(String UserName,String Password,String StoreID,String DueDate,String AdminURL,int days) throws Exception
		{
			DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");		
			driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
			test.log(LogStatus.PASS, "Username is entered: admin");			        
			driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
			test.log(LogStatus.PASS, "Password is entered: "+Password);					  	        			   
			//Click Login Button
			driver.findElement(By.name("login")).click();
			test.log(LogStatus.PASS, "Clicked on Submit button");
			Thread.sleep(8000);
			Thread.sleep(1000);

			for(String winHandle : driver.getWindowHandles()){
				driver.switchTo().window(winHandle);
			}
			driver.switchTo().defaultContent();
			driver.switchTo().frame("mainFrame");
			Date DDueDate = df.parse(DueDate);
			Calendar cal = Calendar.getInstance();
			cal.setTime(DDueDate);
			cal.add(Calendar.DATE, days);
			Date DDueDateminus1= cal.getTime();

			String DueDateminus1 =df.format(DDueDateminus1);
			String DueDate0[] =DueDate.split("/");
			String DueDate1 = DueDate0[0];
			String DueDate2 = DueDate0[1];
			String DueDate3 = DueDate0[2];
			Thread.sleep(3000);
			driver.switchTo().defaultContent();
			driver.switchTo().frame("topFrame");
			driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
			test.log(LogStatus.PASS, "Clicked on Transactions");
			driver.switchTo().defaultContent();
			driver.switchTo().frame("mainFrame");
			driver.findElement(By.linkText("QA Jobs")).click();
			test.log(LogStatus.PASS, "Clicked on QA Jobs");
			driver.findElement(By.linkText("Process Date Change")).click();
			test.log(LogStatus.PASS, "Clicked on Process Date Change");
			driver.switchTo().defaultContent();
			driver.switchTo().frame("mainFrame");
			driver.switchTo().frame("main");
			driver.findElement(By.name("storeCode")).click();
			driver.findElement(By.name("storeCode")).sendKeys(StoreID);
			test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
			Thread.sleep(2000);

			driver.findElement(By.name("beginMonth")).clear();
			driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
			test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
			driver.findElement(By.name("beginDay")).clear();
			driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
			test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
			driver.findElement(By.name("beginYear")).clear();
			driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
			test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
			driver.findElement(By.name("btnPreview")).click();
			Thread.sleep(2000);
			Thread.sleep(2000);
			test.log(LogStatus.PASS, "Clicked on submit button");
			driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

			driver.switchTo().defaultContent();
			driver.switchTo().frame("mainFrame");
			driver.switchTo().frame("main");
			if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())
			{									        								
				test.log(LogStatus.PASS, "Process Date updated successfully");
			}
			else
			{
				test.log(LogStatus.FAIL, "Process Date updated successfully.");
			}


			for(String winHandle : driver.getWindowHandles()){
				driver.switchTo().window(winHandle);
			}

			Thread.sleep(3000);		
		}


public void DefaultPaymentStatus1(String SSN,String FileName) throws Exception
		{
//---------------done-------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(2000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String FirstLoanStatus=null;
					String SecondLoanStatus=null;

					FirstLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[7]")).getText();

					test.log(LogStatus.PASS,"First Loan Status::  "+FirstLoanStatus);

					SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					//driver.close();

				}
			}
		}
		public void DefaultPaymentStatus2(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String CheckStaus=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					CheckStaus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Payment status is Default."+CheckStaus);
					System.out.print(CheckStaus);	
					driver.close();

				}
			}
		}
		public void BatchProcess(String SSN,String FileName,int days) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					Thread.sleep(1000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;


					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();
					System.out.print(DueDate);	
					driver.close();
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");		
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");			        
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: "+Password);					  	        			   
					//Click Login Button
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Thread.sleep(3000);

					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					Date DDueDate = df.parse(DueDate);
					Calendar cal = Calendar.getInstance();
					cal.setTime(DDueDate);
					cal.add(Calendar.DATE,days);
					Date DDueDateminus1= cal.getTime();


					String DueDateminus1 =df.format(DDueDateminus1);
					//String DueDate0[] =DueDateminus1.split("/");
					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];
					String DueDate2 = DueDate0[1];
					String DueDate3 = DueDate0[2];
			
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					Thread.sleep(5000);
					driver.findElement(By.linkText("EOD Batch Process")).click();
					test.log(LogStatus.PASS, "Clicked on EOD Batch Process");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.findElement(By.name("submit")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
				}
			}
		}




		public void AgeStore1_1(String SSN,String FileName,int days) throws Exception

		{
//------------------done
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;
					

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();
					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);
					driver.manage().window().maximize();
					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(2000);

					

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					// String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();


					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					//Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*Thread.sleep(1000);

					Thread.sleep(5000);*/

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}



		public void LoanDate_Agestore(String SSN,String FileName, int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					//Thread.sleep(5000);

					Thread.sleep(1000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String LoanDate=null;

					

					LoanDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[11]/td/span[2]")).getText();


					System.out.print(LoanDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);
					driver.manage().window().maximize();


					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					//Thread.sleep(8000);

					
					Date DDueDate = df.parse(LoanDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/"); 


					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);			
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();
					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);					
					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}



		public void AgeStore1_1BatchProcess(String SSN,String FileName,int days) throws Exception

		{
//------------------done-------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(2000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
Thread.sleep(2000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();


					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);
					driver.manage().window().maximize();

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);


					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					


					String DDueDate[] =DueDate.split("/");


					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					

				Thread.sleep(2000);
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);


					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}



					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					//Thread.sleep(5000);
					driver.findElement(By.linkText("EOD Batch Process")).click();
					test.log(LogStatus.PASS, "Clicked on EOD Batch Process");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.findElement(By.name("submit")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					test.log(LogStatus.INFO, "EOD Batch Process Completed");




				}

			}

		}




		public void AgeStore1_1B(String SSN,String FileName,int days) throws Exception

		{
//------------------done-------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(2000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
Thread.sleep(2000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();


					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);
					driver.manage().window().maximize();

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);


					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					
					String DDueDate[] =DueDate.split("/");


					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					

				Thread.sleep(2000);
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);


					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}





				}

			}

		}




		public void AgeStore1_2(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();


					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);


					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);	
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();


					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(3000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void AgeStore2_1(String SSN,String FileName,int days) throws Exception

		{
//------------------done------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					//Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);
					driver.manage().window().maximize();
					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(1000);


					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					// String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(2000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

				

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void AgeStore2_2(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//	/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();


					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(4000);


					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					// String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					/*driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);*/
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void OutToRepo(String SSN,String FileName,int days) throws Exception

		{
//-----------------done-------------
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(2000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					//Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(2000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(2000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Out To Repo");

					test.log(LogStatus.PASS, "Out To Repo is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");



					//driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					
				                              //	/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input
					test.log(LogStatus.PASS, "Clicked on Go Button: ");	
					

					driver.findElement(By.name("solvageCompany")).sendKeys("Consolidated Asset Recovery Services (CARS)");

					test.log(LogStatus.PASS, "Solvage Company is selected As Consolidated Asset Recovery Services (CARS) ");


					Thread.sleep(2000);

					driver.findElement(By.name("password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[2]/td/input")).isDisplayed())

					{
						///html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[2]/td/input
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[2]/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Out To Repo updated successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Out To Repo Not updated successfully.");

					}



				}

			}

		}


		public void Repossession(String SSN,String FileName,int days) throws Exception

		{
//-----------------done
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(2000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					//Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(2000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

				//	Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Repossession");

					test.log(LogStatus.PASS, "Reposession is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");



					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					test.log(LogStatus.PASS, "Clicked on Go Button: ");	

					driver.findElement(By.name("requestBean.companyName")).sendKeys("Consolidated Asset Recovery Services (CARS)");

					test.log(LogStatus.PASS, "Solvage Company is selected As Consolidated Asset Recovery Services (CARS) ");

					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");


					//Thread.sleep(5000);

					driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Repossession updated successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Repossession Not updated successfully.");

					}



				}

			}

		}




		public void Sale_MoreAmount (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Sale");

					test.log(LogStatus.PASS, "Auction is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");



					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					test.log(LogStatus.PASS, "Clicked on Go Button: ");	



					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");
					driver.findElement(By.name("requestBean.saleValue")).clear();
					driver.findElement(By.name("requestBean.saleValue")).sendKeys("3000");

					test.log(LogStatus.PASS, "SalValue Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Auction updated successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Auction Not updated successfully.");

					}



				}

			}

		}


		public void Sale_LessAmount (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(4000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Sale");

					test.log(LogStatus.PASS, "Sale is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");



					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					test.log(LogStatus.PASS, "Clicked on Go Button: ");	



					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");
					driver.findElement(By.name("requestBean.saleValue")).clear();
					driver.findElement(By.name("requestBean.saleValue")).sendKeys("300");

					test.log(LogStatus.PASS, "SalValue Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Sale Transaction successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Sale Transaction not successfully.");

					}



				}

			}

		}

		public void RepoPayment(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String RepoPayment = null;
					String PaymentAMT2ndLoan = null;
					String PaymentAMT1stLoan = null;

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					//Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					PaymentAMT1stLoan = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[11]")).getText();
					test.log(LogStatus.PASS, "Payment Amout in 1st Loan::"+PaymentAMT1stLoan);		
					PaymentAMT2ndLoan = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]")).getText();
					test.log(LogStatus.PASS, "Payment Amout in 1st Loan::"+PaymentAMT2ndLoan);	
					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Repo Payment");
					Thread.sleep(5000);

					test.log(LogStatus.PASS, "Selected Transaction type as Repo Payment ");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					RepoPayment = driver.findElement(By.name("transactionDataBean.paymentBalAmt")).getAttribute("value");
					//driver.findElement(By.name("transactionDataBean.paymentAmt")).sendKeys(RepoPayment);
					//test.log(LogStatus.PASS, " Payment Amount is Entered "); 
					driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Tender Type is selected");
					//driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(RepoPayment);
					driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(RepoPayment);
					test.log(LogStatus.PASS, " Tender Amount is Entered ");
					driver.findElement(By.name("password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Enter the Password");
					Thread.sleep(2000);
					driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr[8]/td/table/tbody/tr[4]/td[2]/input")).click();
					// driver.findElement(By.name("Submit22")).click();
					test.log(LogStatus.PASS, "Clicked on Finish Button");

					try {

						Alert alert = driver.switchTo().alert();

						alert.accept();

						//if alert present, accept and move on.

					}

					catch (NoAlertPresentException e) {

						//do what you normally would if you didn't have the alert.

					}
					driver.findElement(By.name("Ok")).click();
					test.log(LogStatus.PASS, "Sucessfully Completed Repo Payment");

				}
			}
		}

		public void VerificationPayoffAmounts(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String RepoPayment = null;
					String PaymentAMT2ndLoan = null;
					String PaymentAMT1stLoan = null;

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					PaymentAMT1stLoan = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[11]")).getText();
					test.log(LogStatus.PASS, "Payment Amout in 1st Loan::"+PaymentAMT1stLoan);		
					PaymentAMT2ndLoan = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]")).getText();
					test.log(LogStatus.PASS, "Payment Amout in 1st Loan::"+PaymentAMT2ndLoan);	
					test.log(LogStatus.PASS, "Payment Amout should not effect the other loan");



				}
			}
		}


		public void Loanstatus_1st(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					//test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					//Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String FirstLoanstatus=null;
					String SecondLoanstatus=null;

					

					FirstLoanstatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[21]/td/span[2]")).getText();

					System.out.print(FirstLoanstatus);

					

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					SecondLoanstatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[21]/td/span[2]")).getText();
					test.log(LogStatus.PASS, "1st Loan Out of Repo::"+FirstLoanstatus);
					test.log(LogStatus.PASS, "2nd Loan Out of Repo::"+SecondLoanstatus);

					System.out.print(SecondLoanstatus);


				}

			}

		}

		public void Verification1stLoanAMT_BeforeAcution2ndLoan(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String TotalAMT = null;

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					TotalAMT = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[5]/font")).getText();
					test.log(LogStatus.PASS, "Before Doing the 2nd Loan Auction 1stLoan TotalAmount::"+TotalAMT);

				}
			}
		}

		public void Verification1stLoanAMT_AfterAcution2ndLoan(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String TotalAMT = null;

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					TotalAMT = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[5]/font")).getText();
					test.log(LogStatus.PASS, "After Done the 2nd Loan Auction 1stLoan TotalAmount::"+TotalAMT);

				}
			}
		}

		public void TwoLoansVerification_Waived(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String FirestLoanWaivedAMT = null;
					String SecondLoanWaivedAMT = null;

					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
						String Loannbr1= driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[2]")).getText(); 
						int Loan1 = Integer.parseInt(Loannbr1);
						String Loannbr2=driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[2]")).getText();
						int Loan2 = Integer.parseInt(Loannbr2);
						WebElement Go1 = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input"));
						WebElement Go2 = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input"));
						 if(ProductID.equals("TLP"))
						 {	
							 if(Loan1<Loan2)
								{
								Go1.click();
							}
							else 
							{
								Go2.click();
							}
						 }
						/*driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
						test.log(LogStatus.PASS, "Click on GO Button");*/
					}
					
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					test.log(LogStatus.PASS, "selected as Transaction type  History ");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					//// kiran
					List<WebElement> rows = driver.findElements(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr"));
					int count = rows.size();
					System.out.println("ROW COUNT : "+count);
					for(int rnum=2;rnum<rows.size();rnum++)
					{ 				
						List<WebElement> Cols = driver.findElements(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+rnum+"]/td"));
						int count1 = Cols.size();
						System.out.println("Column COUNT : "+count1);
						for(int rcol=2;rcol<Cols.size();rcol++)
						{ 
							String HisField =driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+rnum+"]/td[4]/font")).getText();
							System.out.println(HisField);
							if(HisField.equals("Write Off Waived"))
							{
								//int col = rcol+1;
								String WaiveAmt =driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+rnum+"]/td[5]/font")).getText();
							test.log(LogStatus.PASS, "First Loan Waved Amount::"+WaiveAmt);
							////*[@id="transactionDetailsTable"]/tbody/tr[8]/td[5]/font
							////*[@id="transactionDetailsTable"]/tbody/tr[8]/td[4]/font
							break;
							}
						}
					}
				}
			}
		}

		
		public void NewLoanWithVIN2_1(String SSN,String FileName,String NewVIN2) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					//*[@id="911100"]/a
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(driver.findElement(By.id("LoanButtonId")).isEnabled())
						if(ProductID.equals("TLP"))							
						{					
							System.out.println("IN TLP");
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN2);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN2);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();				
						}												
					if(ProductName.equals("TNPAYDAY"))
					{
						////							*[@id="riskViewBdy"]/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[3]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("TNPDL all coll"))
					{								
						driver.findElement(By.name("prodSel")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("Tennessee"))
					{
						//driver.findElement(By.xpath("//*[@id="termSel1"]")).click();
						//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}
					if(ProductName.equals("Line of Credit"))
					{

						if(StoreID.equals("4322"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
						}
						if(StoreID.equals("4353"))
						{
							//*[@id="riskViewBdy"]/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input

							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);

						}
						if(StoreID.equals("1343"))
						{
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[4]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}

					}
					
					driver.findElement(By.id("LoanButtonId")).click();
					//driver.findElement(By.id("LoanButtonId")).click();

					test.log(LogStatus.PASS, "Clicked on New Loan button");
					//New Loan Screens
					if(ProductID.equals("PDL"))
					{	

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						if(!(ESign_LoanAmt.isEmpty()))
						{
							driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[13]/td[3]/input")).sendKeys(ESign_LoanAmt);
							test.log(LogStatus.PASS, "Loan amount is enterted as "+ESign_LoanAmt);
						}
						driver.findElement(By.xpath("//*[@id='chkgAcctNbr']")).sendKeys(last4cheknum);
						test.log(LogStatus.PASS, "	Chkg Acct Nbr(Last 4 Digits Only) is enterted as "+last4cheknum);					
						Thread.sleep(5000);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.xpath("//*[@id='advanceRequestBean.disbursementType']")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type1 is enterted as "+ESign_DisbType);
						Thread.sleep(2000);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys("215");					
						test.log(LogStatus.PASS, "Disb Amt1 is enterted as ::" +"215");
						Thread.sleep(5000);
						driver.findElement(By.name("advanceRequestBean.disbursementTypeSecond")).sendKeys(ESign_DisbType2);
						test.log(LogStatus.PASS, "Disb Type2 is selected as ::Cash");



						driver.findElement(By.name("advanceRequestBean.disbAmtSecond")).sendKeys("210");
						test.log(LogStatus.PASS, "Disb Amt2 is enterted as 210");
						
						driver.findElement(By.name("advanceRequestBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Electronic Communication Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.xpath("//*[@id='allowCoupons']/td[3]/input")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.xpath("//*[@id='coupon']/td[3]/div[1]/input")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
						}

						driver.findElement(By.xpath("//*[@id='idNoChecks']/td[3]/select")).sendKeys(ESign_Checks);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Checks);
						WebDriverWait wait = new WebDriverWait(driver, 30);	
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//*[@id='chkNbr0']")));
						driver.findElement(By.xpath("//*[@id='chkNbr0']")).sendKeys(ESign_CheckNbr);
						test.log(LogStatus.PASS, "Check number is "+ESign_CheckNbr);
						driver.findElement(By.name("advanceRequestBean.loggedUserPassword")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishadvance")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");
						

						try { 
							Alert alert = driver.switchTo().alert();
							String Var1 = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var1);

							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						Thread.sleep(2000);
						try { 
							Alert alert = driver.switchTo().alert();
							String Var = alert.getText();
							test.log(LogStatus.PASS, "ALert Displayed is :: "+Var);
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						// driver.findElement(By.name("OKBut")).click();					
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("bdyLoad");
						
					}

					if(ProductID.equals("ILP"))
					{	
						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);									
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						String Instamt=driver.findElement(By.name("advanceRequestBean.advanceAmt")).getAttribute("value");
						System.out.println(Instamt);
						driver.findElement(By.name("advanceRequestBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);
						driver.findElement(By.name("requestBean.siilBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
									//do what you normally would if you didn't have the alert.
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							//String mwh=driver.getWindowHandle();
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							//String winHandle = driver.getWindowHandle(); //Get current window handle.									
						}
						WebElement ele = driver.findElement(By.name("requestBean.siilBean.nbrOfInst"));
						String NumofInst=ele.getAttribute("value");
						//*[@id="errorMessage"]/form[1]/table/tbody/tr[4]/td/table[1]/tbody/tr[5]/td[2]/input
						System.out.println(NumofInst);
						int installments = Integer.parseInt(NumofInst);
						for(int i=0;i<installments;i++)
						{
							Random rand = new Random();
							int rand1 = rand.nextInt(100000);	
							String chknum = Integer.toString(rand1);
							driver.findElement(By.id("checkNbrs"+i)).sendKeys(chknum);

						}			 					 			
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[10]/td/input")).sendKeys(ESign_Password);
						test.log(LogStatus.PASS, "ESign_Checks is selected as "+ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[12]/td/table/tbody/tr[1]/td[5]/input")).click();
						test.log(LogStatus.PASS, "click on Finish Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						//for( String winHandle1 : driver.getWindowHandles())
						//{
						// driver.switchTo().window(winHandle1);
						//}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("OKBut")));
						driver.findElement(By.name("OKBut")).click();
						//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.name("ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							//driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

					if(ProductID.equals("TLP"))
					{	
						String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
						String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
						String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
						String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
						//String VehicleGrade=TestData.getCellData(sheetName,"Vehicle Grade",row);
						String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
						String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
						String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
						String PhoneNbr1 = PhoneNbr.substring(0, 3);
						String PhoneNbr2 = PhoneNbr.substring(3, 6);
						String PhoneNbr3 = PhoneNbr.substring(6, 10);
						String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
						String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
						String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
						String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
						String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
						String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
						String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
						driver.findElement(By.name("requestBean.titleNumber")).clear();
						driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
						driver.findElement(By.name("requestBean.appraisalVal")).clear();
						driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
						driver.findElement(By.name("button1")).click();
						test.log(LogStatus.PASS, "click on Update 1 button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						WebDriverWait wait = new WebDriverWait(driver, 10);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
						
						driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
						driver.findElement(By.name("requestBean.licensePltNbr")).clear();
						driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
						driver.findElement(By.name("requestBean.licensePltExpire")).clear();
						driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
						driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
						driver.findElement(By.name("iPhoneNbr1")).clear();
						driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
						driver.findElement(By.name("iPhoneNbr2")).clear();
						driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);

						driver.findElement(By.name("iPhoneNbr3")).clear();
						driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
						driver.findElement(By.name("requestBean.companyName")).clear();
						driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
						driver.findElement(By.name("iexpiry1")).clear();
						driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
						driver.findElement(By.name("iexpiry2")).clear();
						driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
						driver.findElement(By.name("iexpiry3")).clear();
						driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
						driver.findElement(By.name("requestBean.polocyNbr")).clear();
						driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
						driver.findElement(By.name("button2")).click();			
						driver.findElement(By.name("button2")).click();	
						
						test.log(LogStatus.PASS, "click on Update 2 button ");
						Thread.sleep(8000);
						
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
						driver.findElement(By.name("process")).click();
						test.log(LogStatus.PASS, "click on process Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						Thread.sleep(5000);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						driver.findElement(By.name("negLoanAmt")).click();
						for( String winHandle1 : driver.getWindowHandles())

						{

							driver.switchTo().window(winHandle1);

						}

						Thread.sleep(2000);

						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.siilBean.advAmt")));
						
						driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
						Thread.sleep(3000);

						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						Thread.sleep(3000);
						driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}

						WebElement element = driver.findElement(By.name("requestBean.siilBean.advAmt"));                                       
						Actions builder = new Actions(driver); 
						builder.doubleClick()
						.sendKeys(element, Keys.ARROW_RIGHT)
						.sendKeys(element, Keys.ARROW_RIGHT)
						.doubleClick()
						//.sendKeys(element, Keys.DELETE)
						//.sendKeys(element, Keys.ARROW_RIGHT)
						.sendKeys(element, Keys.DELETE)
						//.sendKeys(element, Keys.CLEAR)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.sendKeys(element,Keys.BACK_SPACE)
						.build()
						.perform();



						//WebElement element = driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[2]/td[3]/div[6]/a/img"));
						/* Actions action = new Actions(driver);	

								  action.moveToElement(element).doubleClick().sendKeys("415");
															  Keys.ENTER;
								  Keys.BACKSPACE;
								   driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
								   Actions builder = new Actions(driver); 
								   builder.moveToElement(element)
								    .clickAndHold()
								    .sendKeys("415");*/

						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}

						Thread.sleep(6000);
						driver.findElement(By.name("requestBean.siilBean.advAmt")).sendKeys("1250");
						driver.findElement(By.name("negSel")).click();
						driver.findElement(By.name("reCalculate")).click();
						driver.findElement(By.name("negSel")).click();
						Thread.sleep(3000);
						driver.switchTo().window(Parent_Window);

						for( String winHandle1 : driver.getWindowHandles())

						{

							driver.switchTo().window(winHandle1);

						}                    

						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");
						//negLoanAmt   negotiateamount button
						//requestBean.siilBean.advAmt       ChangedLoanAmountField
						//reCalculate   Recalculate
						//negSel  Negotiation Complete


						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						//requestBean.siilBean.disbType
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						//requestBean.siilBean.advAmt
						String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");
						//String Instamt=driver.findElement(By.name("cashToCust")).getAttribute("value");
						/*	int Instamt1 = Integer.parseInt(Instamt);
							      int inst2		
										String s=Integer.toString(i);
								System.out.println(Instamt)*/;

								//requestBean.siilBean.disbAmtFirst
								//
								driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys("1250");
								test.log(LogStatus.PASS, "Disb Amt is enterted as "+"1250");


								Thread.sleep(5000);
								//requestBean.siilBean.disbTypeSecond
								/*								driver.findElement(By.name("requestBean.siilBean.disbTypeSecond")).sendKeys(ESign_DisbType);
								test.log(LogStatus.PASS, "Disb Type2 is selected as ::"+ESign_DisbType);
								try { 
								    Alert alert = driver.switchTo().alert();
								    alert.accept();
								    //if alert present, accept and move on.														

								}
								catch (NoAlertPresentException e) {
								    //do what you normally would if you didn't have the alert.
								}
								Thread.sleep(5000);

									//requestBean.siilBean.disbAmtSecond
								driver.findElement(By.name("requestBean.siilBean.disbAmtSecond")).sendKeys("260");
								test.log(LogStatus.PASS, "Disb Amt2 is enterted as 260");
								//requestBean.siilBean.emailConsentFlag
								 */								
								/*driver.findElement(By.name("vehicleKey")).sendKeys("Yes");					
								driver.findElement(By.name("requestBean.siilBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
								test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);*/
								driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
								test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
								if(ESign_CourtesyCallConsent.equals("Yes"))
								{
									if(ESign_Preference.equals("Call"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
									}
									if(ESign_Preference.equals("Mail"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
									}
									if(ESign_Preference.equals("SMS"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

										try { 
											Alert alert = driver.switchTo().alert();
											alert.dismiss();
											//if alert present, accept and move on.														

										}
										catch (NoAlertPresentException e) {
											//do what you normally would if you didn't have the alert.
										}
									}

								}
								if(AllowPromotion.equals("Yes"))
								{
									driver.findElement(By.name("allowPromotion")).click();
									test.log(LogStatus.PASS, "AllowPromotion is selected ");
									//String mwh=driver.getWindowHandle();
									driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
									test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
									//String winHandle = driver.getWindowHandle(); //Get current window handle.									
								}
								driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
								driver.findElement(By.name("finishLoan")).click();
								test.log(LogStatus.PASS, "Click on Finish Loan Button");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
								//driver.findElement(By.name("OKBut")).click();
								//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
								test.log(LogStatus.PASS, "click on Yes button ");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								//OKBut
								if(driver.findElement(By.name("ok")).isDisplayed())
									//if(driver.findElement(By.name("OKBut")).isDisplayed())
								{
									test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
									//driver.findElement(By.name("ok")).click();
									driver.findElement(By.name("ok")).click();
								}
								else
								{
									test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
								}
					}
					if(ProductID.equals("LOC"))
					{

						driver.findElement(By.name("advanceRequestBean.paymentCollateralType")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "CollateralType is selected as "+ESign_CollateralType);
						Thread.sleep(5000);
						driver.findElement(By.name("advanceRequestBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						driver.findElement(By.name("advanceRequestBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						driver.findElement(By.name("finishadvance")).click();
						test.log(LogStatus.PASS, "Click on Finish LOC Button");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						//driver.findElement(By.name("OKBut")).click();
						//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr[2]/td/table[2]/tbody/tr/td[2]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr[2]/td/table[2]/tbody/tr/td[2]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

					//html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[3]/td/input
				}

			}
		}

		public void AgeStore1_1BatchProcess_C(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

			}

			//String winHandleBefore = driver.getWindowHandle();

			for(String winHandle : driver.getWindowHandles()){

			driver.switchTo().window(winHandle);

			}

			Thread.sleep(8000);

			// driver.findElement(By.xpath("//*[@id='home']")).click();*/

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");


					String DDueDate[] =DueDate.split("/");


					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					/*driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);*/
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}



					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					Thread.sleep(5000);
					driver.findElement(By.linkText("EOD Batch Process")).click();
					test.log(LogStatus.PASS, "Clicked on EOD Batch Process");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.findElement(By.name("submit")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					test.log(LogStatus.INFO, "EOD Batch Process Completed");




				}

			}

		}

		public void NewLoanRule(String SSN,String FileName) throws Exception{

			{
				Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
				int lastrow=TestData.getLastRow("NewLoan");
				System.out.println("NewLoan "+lastrow);
				String sheetName="NewLoan";		
				for(int row=2;row<=lastrow;row++)
				{	
					String RegSSN = TestData.getCellData(sheetName,"SSN",row);
					if(SSN.equals(RegSSN))
					{

						String State = TestData.getCellData(sheetName,"StateID",row);
						String ProductID=TestData.getCellData(sheetName,"ProductID",row);
						System.out.println(ProductID);
						String UserName = TestData.getCellData(sheetName,"UserName",row);
						String Password = TestData.getCellData(sheetName,"Password",row);
						String ProductType = TestData.getCellData(sheetName,"ProductType",row);
						String ProductName = TestData.getCellData(sheetName,"ProductName",row);

						String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
						String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);

						String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
						String NewVIN3= TestData.getCellData(sheetName,"NewVIN3",row);
						String StoreID = TestData.getCellData(sheetName,"StoreID",row);

						System.out.println(ProductID);

						String StoreId = TestData.getCellData(sheetName,"StoreID",row);

						//String stateProduct=State+" "+ProductID;
						String stateProductType=State+" "+ProductType;
						String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
						System.out.println(ESign_CollateralType);
						String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
						String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
						String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
						String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
						String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
						String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
						String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
						String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
						String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
						String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
						String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
						String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
						System.out.println(last4cheknum);
						System.out.println(stateProductType);
						String AppURL = TestData.getCellData(sheetName,"AppURL",row);

						String StateID = TestData.getCellData(sheetName,"StateID",row);

						String Parent_Window = driver.getWindowHandle();
						CSRLoginpage login = new CSRLoginpage();
						login.Login(UserName, Password, StoreId, driver, AppURL, test);
						String SSN1 = SSN.substring(0, 3);
						String SSN2 = SSN.substring(3,5);
						String SSN3 = SSN.substring(5,9);
						driver.switchTo().frame("topFrame");
						//*[@id="911100"]/a
						driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
						test.log(LogStatus.PASS, "Clicked on Loan Transactions");
						driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
						//*[@id="911100"]/a
						driver.findElement(By.cssSelector("li[id='911100']")).click();			
						test.log(LogStatus.PASS, "Clicked on New Loan");		
						driver.switchTo().frame("main");		
						driver.findElement(By.name("ssn1")).sendKeys(SSN1);
						test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
						driver.findElement(By.name("ssn2")).sendKeys(SSN2);
						test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
						driver.findElement(By.name("ssn3")).sendKeys(SSN3);
						test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
						driver.findElement(By.name("submit1")).click();
						test.log(LogStatus.PASS, "Click on submit Button");		
						for(String winHandle : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle);	
						}
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.name("button")).click();
						test.log(LogStatus.PASS, "Click on GO Button");
						// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input      Loan2
						// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input      Loan1
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						//	Selection of Product based on the Name provided in Test Data

						if(driver.findElement(By.id("LoanButtonId")).isEnabled())
							//if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
							if(ProductID.equals("TLP"))							
							{					
								System.out.println("IN TLP");
								// name="vehicleChk"   //*[@id="veh1"]
								////*[@id="vehicleType_dd"]
								driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
								// //*[@id="vinDD"]
								test.log(LogStatus.PASS, "Vehicle Type is selected as :: "+VehicleType);
								driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
								test.log(LogStatus.PASS, "Vehicle Status is selected as :: New ");
								// //*[@id="vinPop"]/div/table[1]/tbody/tr[1]/td[2]/input
								driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
								test.log(LogStatus.PASS, "VIN entered is ::  "+NewVIN);
								driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
								test.log(LogStatus.PASS, "Confirm VIN entered is ::  "+NewVIN);
								driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
								test.log(LogStatus.PASS, "Clicked on Submi VIN button ");
								driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();

								driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");

								test.log(LogStatus.PASS, "Appraisal Value is entered as :: 200 ");
								driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();
								test.log(LogStatus.PASS, "Clicked on Hit BlackBook button ");
							}	
						Alert alert1 = driver.switchTo().alert();

						/*		for(String winHandle : driver.getWindowHandles()){
							driver.switchTo().window(winHandle);
						}				    
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");*/
						int count = 4;
						/*	System.out.println("before for loop" );
						for(int i=1;i<=count;i++)
						 */
						//Alert alert1 = driver.switchTo().alert();
						/*	if(alert1.getText().contains("4"))*/
						{


							try { 
								Alert alert = driver.switchTo().alert();
								String Var = alert.getText();
								System.out.println("alert message" + Var);

								alert.accept();
								System.out.println("Alert accepted");
								//if alert present, accept and move on.														

							}
							catch (NoAlertPresentException e) {
								//do what you normally would if you didn't have the alert.
							}
							/*			
							Thread.sleep(3000);
							// String message = driver.findElement(By.xpath("//*[@id='errMsg']/ul/li")).getText();
							test.log(LogStatus.PASS, "Maximum loans given and the message displayed is:"+ alert1.getText());
							 */
							test.log(LogStatus.PASS, "Maximum loans given is :"+ count);





							//else
							/*	{
								if(i==1)
								{
									this.NewLoanWithVIN(SSN, FileName,NewVIN);

								}
								if(i==2)
								{
									this.NewLoanWithVIN2(SSN, FileName,NewVIN);


								}
								if(i==3)
								{

									this.NewLoanWithVIN2_1(SSN, FileName,NewVIN2);

								}
								if(i==4)
								{
									this.NewLoanWithVIN2(SSN, FileName,NewVIN2);
								}
							}
							 */

							/*}while((driver.findElement(By.xpath("//*[@id='errMsg']/ul/li")).isDisplayed())== false);*/
							/*driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								String DueDate=null;

								DueDate = driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[11]/td[2]/span[2]")).getText();
								//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();		 
								System.out.print(DueDate);	*/

							//driver.close();
						}
					}
				}
			}

		}
		public void AgeStore_1stInst(String SSN,String FileName,int Days) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.id("go_Button")).click();  
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DueDate=null;
					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();
					test.log(LogStatus.PASS, "Capture DueDate"+DueDate);
					System.out.print(DueDate);	
					driver.close();

					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");		
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");			        
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: "+Password);
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					String DDueDate[] =DueDate.split("/");
					Date DDueDateminus1 = df.parse(DueDate);
					Calendar cal = Calendar.getInstance();
					cal.setTime(DDueDateminus1);
					cal.add(Calendar.DATE, Days);
					Date DDueDate1= cal.getTime();
					DueDate =df.format(DDueDate1);
					String DueDate0[] =DueDate.split("/");
					String DueDate1 = DueDate0[0];
					String DueDate2 = DueDate0[1];
					String DueDate3 = DueDate0[2];
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("storeCode")).click();
					driver.findElement(By.name("storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					Thread.sleep(2000);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					//Thread.sleep(2000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					//Thread.sleep(1000);
					//Thread.sleep(5000);
					driver.findElement(By.name("btnPreview")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())
					{									        								
						test.log(LogStatus.PASS, "Process Date updated successfully");
						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();
					}
					else
					{
						test.log(LogStatus.FAIL, "Process Date not updated successfully.");
					}
				}
			}
		}
		
		
		public void IETaskKiller() throws IOException, InterruptedException {

			Runtime.getRuntime().exec("taskkill /T /F /IM IEDriverServer.exe");
			Thread.sleep(5000); //Allow OS to kill the process
			System.setProperty("webdriver.ie.driver",System.getProperty("user.dir")+"/IEDriverServer.exe");
			//driver = new InternetExplorerDriver();		
		}

		public void Payment_Void(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					String Bank_ChkgAcctNbr = TestData.getCellData(sheetName,"Bank_ChkgAcctNbr",row);
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					Thread.sleep(2000);
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					try 
					{ 
						Alert alert = driver.switchTo().alert();
						alert.accept();													
					}
					catch (NoAlertPresentException e)
					{
						
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(TenderType);
					test.log(LogStatus.PASS, "Disbursement type is  Select as ::"+TenderType);
					driver.findElement(By.name("requestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Passwor Entered as::"+Password);
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on Finish Void Button");
					driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]")).click();
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.xpath("//*[@id='totPart']/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())
					{
						driver.findElement(By.xpath("//*[@id='totPart']/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "Clicked on Confirmation Yes Button");
					}	
				}
			}
		}

		public void Check_Void(String SSN,String FileName,int Days) throws Exception
		{
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);					
					Thread.sleep(3000);					
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					int n=driver.findElements(By.xpath("//select[@name='transactionList']/option")).size();
					for(int i=1;i<=n;i++)
					{
						String transactino_value=driver.findElement(By.xpath("//select[@name='transactionList']/option["+i+"]")).getAttribute("value");
						if(transactino_value.equals("Void"))
						{
							test.log(LogStatus.PASS, "Void Option is Available");	
						}
						else
						{
							test.log(LogStatus.PASS, "Void Option is not Available");	
						}
					}
				}
			}
		}

		public void AgeStore1_1_C(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

	}

	//String winHandleBefore = driver.getWindowHandle();

	for(String winHandle : driver.getWindowHandles()){

	driver.switchTo().window(winHandle);

	}

	Thread.sleep(8000);

	// driver.findElement(By.xpath("//*[@id='home']")).click();*/

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);


					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					/*driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);
*/
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}



		public void AgeStore1_2_C(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

	}

	//String winHandleBefore = driver.getWindowHandle();

	for(String winHandle : driver.getWindowHandles()){

	driver.switchTo().window(winHandle);

	}

	Thread.sleep(8000);

	// driver.findElement(By.xpath("//*[@id='home']")).click();*/

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					/*driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);*/
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}


		public void DefaultPayment (String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{



					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);

					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);





					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(4000);

					driver.switchTo().defaultContent();

					WebDriverWait wait = new WebDriverWait(driver, 30);

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));

					driver.findElement(By.cssSelector("li[id='910000']")).click();



					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					Thread.sleep(1000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();

						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					Thread.sleep(5000);


					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Default Payment");

					test.log(LogStatus.PASS, "Transaction Type is selected as Default Payment");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{

						Thread.sleep(3000);

						String PmtAmt = driver.findElement(By.name("transactionDataBean.paymentBalAmt")).getAttribute("value");
						test.log(LogStatus.PASS, " Default  payment amt Is :: "+PmtAmt );
						driver.findElement(By.name("transactionDataBean.paymentAmt")).clear();
						driver.findElement(By.name("transactionDataBean.paymentAmt")).sendKeys(PmtAmt);
						test.log(LogStatus.PASS, " Default  payment amt entered Is :: "+PmtAmt );
						driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
						test.log(LogStatus.PASS, " TenderType is Selected  as :: Cash " );

						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(PmtAmt);
						test.log(LogStatus.PASS, " TenderAmount entered is :: "+PmtAmt );

						driver.findElement(By.name("password")).sendKeys(Password);
						test.log(LogStatus.PASS, " password entered " );
						Thread.sleep(3000);
						driver.findElement(By.xpath("//input[@name='Submit22' and @value='Finish' and @type='Button']")).click();
						//driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, " Clicked on Finish Default Payment " );

					}

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();


					}
					catch (NoAlertPresentException e) {

					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, "Default Payment is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, "Default Payment is not Completed Successfully ");

						}

					}

				}

			}

		}		



		public void DefaultPayment_Void (String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{



					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);

					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);





					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(4000);

					driver.switchTo().defaultContent();

					WebDriverWait wait = new WebDriverWait(driver, 30);

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));

					driver.findElement(By.cssSelector("li[id='910000']")).click();



					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					Thread.sleep(1000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();

						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					Thread.sleep(5000);


					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Void");

					test.log(LogStatus.PASS, "Transaction Type is selected as Void");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						Thread.sleep(3000);

						driver.findElement(By.name("transactionDataBean.disbursementType")).sendKeys("Cash");
						test.log(LogStatus.PASS, " TenderType is Selected  as :: Cash " );



						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						test.log(LogStatus.PASS, " password entered " );
						Thread.sleep(3000);
						driver.findElement(By.name("Submit33")).click();
						test.log(LogStatus.PASS, " Clicked on Finish Default Payment Void " );

					}

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();


					}
					catch (NoAlertPresentException e) {
						driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[3]/td/input[1] ")).click();
						test.log(LogStatus.PASS, " Click on Confirm Renewal " );
					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, "Default Payment Void is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, "Default Payment Void is not Completed Successfully ");

						}

					}

				}

			}

		}	

		public void Loan_Status(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String CheckStaus=null;
					CheckStaus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Loan Status After Default->DefaultPayment->DefaultPayment Void is :: "+CheckStaus);
					System.out.print(CheckStaus);	
					/*
				driver.close();
				driver = new InternetExplorerDriver();*/

				}
			}
		}
/*
		public void AgeStore(String SSN,String FileName,int Days) throws Exception

		{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan"; 

			for(int row=2;row<=lastrow;row++)

			{ 

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row); 

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);




					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{

						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1] 



						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;


					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]

					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]")).getText();


					test.log(LogStatus.PASS, "Capture DueDate"+DueDate);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText(); 

					System.out.print(DueDate); 

					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);


					DateFormat df=new SimpleDateFormat("MM/dd/yyyy"); 

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin"); 

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password); 

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);



					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS); 

					driver.findElement(By.linkText("QA Jobs")).click();

					test.log(LogStatus.PASS, "Clicked on QA Jobs");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					//	driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					WebElement elements1 = driver.findElement(By.linkText("Daily Jobs"));

					Actions actions1 = new Actions(driver);

					actions1.moveToElement(elements1).build().perform();

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);




					String DDueDate[] =DueDate.split("/");

					//String date = DDueDate[1];

					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];




					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{ 

						test.log(LogStatus.PASS, "Process Date updated successfully");

						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date not updated successfully.");

					}
				}

			}

		}
*/
		public void HistoryValidations1(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);


					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					String IntAmt1=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					IntAmt1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[2]/td[10]/font")).getText();

					test.log(LogStatus.PASS,"Interest Amount Need to Paid :: "+IntAmt1);
					System.out.print(IntAmt1);	
					String FeeAmt1=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					FeeAmt1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[2]/td[11]/font")).getText();

					test.log(LogStatus.PASS,"Fee Amount Need To Paid :: "+FeeAmt1);
					System.out.print(FeeAmt1);
					String PrincAmt1=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					PrincAmt1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[2]/td[9]/font")).getText();

					test.log(LogStatus.PASS,"Principle Amount Need to Paid:: "+PrincAmt1);
					System.out.print(PrincAmt1);


					String IntAmt=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					IntAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[3]/td[10]/font")).getText();

					test.log(LogStatus.PASS,"Interest Amount Paid :: "+IntAmt);
					System.out.print(IntAmt);	
					String FeeAmt=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					FeeAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[11]/font")).getText();

					test.log(LogStatus.PASS,"Fee Amount Paid :: "+FeeAmt);
					System.out.print(FeeAmt);
					String PrincAmt=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					PrincAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[9]/font")).getText();

					test.log(LogStatus.PASS,"Principle Amount Paid :: "+PrincAmt);
					System.out.print(PrincAmt);


				}
			}
		}


		public void Payment_InterestAmt (String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{




					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String Password = TestData.getCellData(sheetName,"Password",row);



					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);



					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);




					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{

						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1] 



						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String PrincipleAmt=null;


					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]

					PrincipleAmt = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[17]/td/span[2]")).getText();


					test.log(LogStatus.PASS, "Interest Amount is:: "+PrincipleAmt);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText(); 

					System.out.print(PrincipleAmt); 




					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);



					Thread.sleep(4000);

					driver.switchTo().defaultContent();

					WebDriverWait wait = new WebDriverWait(driver, 30);

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));

					driver.findElement(By.cssSelector("li[id='910000']")).click();



					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					Thread.sleep(1000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					Thread.sleep(5000);

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Payment");

					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");


					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}



					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("//*[@id='PD5']")).click();
						test.log(LogStatus.PASS, " Click pay Other amt Type ");

						driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys(PrincipleAmt);
						test.log(LogStatus.PASS, "Payment Amount is:: "+PrincipleAmt);
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");

						test.log(LogStatus.PASS, "tenderType as Cash ");
						//name="instAmt"
						//	String pmtamt = driver.findElement(By.name("instAmt")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(PrincipleAmt);
						test.log(LogStatus.PASS, "Tender Amount is:: "+PrincipleAmt);
					}


					if(ProductID.equals("TLP"))

					{



						driver.findElement(By.name("requestBean.password")).sendKeys(Password);

						driver.findElement(By.name("finish")).click();

						test.log(LogStatus.PASS, "Password is selected as "+Password);

						driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]")).click();
						test.log(LogStatus.PASS, "Click on Yes for Renewal Amount ");

					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, "Interest Amount Payment is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, "Interest Amount Payment is not Completed Successfully ");

						}

					}

				}

			}

		}		


		public void Payment_FeeAmt (String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{




					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String Password = TestData.getCellData(sheetName,"Password",row);



					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);



					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);




					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{

						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1] 



						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String PrincipleAmt=null;


					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]

					PrincipleAmt = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[18]/td/span[2]")).getText();


					test.log(LogStatus.PASS, "Fee Amount is:: "+PrincipleAmt);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText(); 

					System.out.print(PrincipleAmt); 




					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);



					Thread.sleep(4000);

					driver.switchTo().defaultContent();

					WebDriverWait wait = new WebDriverWait(driver, 30);

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));

					driver.findElement(By.cssSelector("li[id='910000']")).click();



					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					Thread.sleep(1000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					Thread.sleep(5000);

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Payment");

					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");


					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}



					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("//*[@id='PD5']")).click();
						test.log(LogStatus.PASS, " Click pay Other amt Type ");

						driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys(PrincipleAmt);
						test.log(LogStatus.PASS, "Payment Amount is:: "+PrincipleAmt);
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");

						test.log(LogStatus.PASS, "tenderType as Cash ");
						//name="instAmt"
						//	String pmtamt = driver.findElement(By.name("instAmt")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(PrincipleAmt);
						test.log(LogStatus.PASS, "TenderAmount is:: "+PrincipleAmt);
					}


					if(ProductID.equals("TLP"))

					{



						driver.findElement(By.name("requestBean.password")).sendKeys(Password);

						driver.findElement(By.name("finish")).click();

						test.log(LogStatus.PASS, "Password is selected as "+Password);

						driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]")).click();
						test.log(LogStatus.PASS, "Click on Yes for Renewal Amount ");
					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, "Fee Amount Payment is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, "Fee Amount Payment is not Completed Successfully ");

						}

					}

				}

			}

		}		



		public void Payment_PrincipleAmt (String SSN,String FileName) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan"; 

			for(int row=2;row<=lastrow;row++)

			{ 

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row); 

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);




					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}



					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Payment");

					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");


					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}



					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("//*[@id='PD3']")).click();
						test.log(LogStatus.PASS, " Click pay Other amt Type ");

						/*	driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys(PrincipleAmt);
					test.log(LogStatus.PASS, "Payment Amount is:: "+PrincipleAmt);*/

						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");

						test.log(LogStatus.PASS, "tenderType as Cash ");
						//name="instAmt"
						String pmtamt = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[7]/td/table/tbody/tr/td/table/tbody/tr[2]/td[1]/input[2]")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(pmtamt);
						test.log(LogStatus.PASS, "TenderAmount is:: "+pmtamt);
					}


					if(ProductID.equals("TLP"))

					{



						driver.findElement(By.name("requestBean.password")).sendKeys(Password);

						driver.findElement(By.name("finish")).click();

						test.log(LogStatus.PASS, "Password is selected as "+Password);

					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]")).click();
					//test.log(LogStatus.PASS, "Click on Yes for Renewal Amount ");
					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, "Principle Amount Payment is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, "Principle Amount Payment is not Completed Successfully ");

						}

					}

				}

			}

		}	

		public void NewLoanWithVIN4(String SSN,String FileName,String NewVIN2) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(driver.findElement(By.id("LoanButtonId")).isEnabled())
						if(ProductID.equals("TLP"))							
						{					
							System.out.println("IN TLP");
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN2);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN2);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();				
						}												

					if(ProductName.equals("Tennessee"))
					{
						//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}



					driver.findElement(By.id("LoanButtonId")).click();

					test.log(LogStatus.PASS, "Clicked on New Loan button");

					if(ProductID.equals("TLP"))
					{	
						String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
						String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
						String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
						String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
						String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
						String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
						String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
						String PhoneNbr1 = PhoneNbr.substring(0, 3);
						String PhoneNbr2 = PhoneNbr.substring(3, 6);
						String PhoneNbr3 = PhoneNbr.substring(6, 10);
						String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
						String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
						String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
						String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
						String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
						String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
						String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
						driver.findElement(By.name("requestBean.titleNumber")).clear();
						driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
						driver.findElement(By.name("requestBean.appraisalVal")).clear();
						driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
						driver.findElement(By.name("button1")).click();
						test.log(LogStatus.PASS, "click on Update 1 button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						WebDriverWait wait = new WebDriverWait(driver, 10);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));

						driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
						driver.findElement(By.name("requestBean.licensePltNbr")).clear();
						driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
						driver.findElement(By.name("requestBean.licensePltExpire")).clear();
						driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
						driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
						driver.findElement(By.name("iPhoneNbr1")).clear();
						driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
						driver.findElement(By.name("iPhoneNbr2")).clear();
						driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);

						driver.findElement(By.name("iPhoneNbr3")).clear();
						driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
						driver.findElement(By.name("requestBean.companyName")).clear();
						driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
						driver.findElement(By.name("iexpiry1")).clear();
						driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
						driver.findElement(By.name("iexpiry2")).clear();
						driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
						driver.findElement(By.name("iexpiry3")).clear();
						driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
						driver.findElement(By.name("requestBean.polocyNbr")).clear();
						driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
						driver.findElement(By.name("button2")).click();			
						driver.findElement(By.name("button2")).click();	
						test.log(LogStatus.PASS, "click on Update 2 button ");
						Thread.sleep(8000);

						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
						driver.findElement(By.name("process")).click();

						test.log(LogStatus.PASS, "click on process Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						Thread.sleep(5000);


						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);


						Thread.sleep(5000);

						driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();

								}
								catch (NoAlertPresentException e) {
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
						}
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						test.log(LogStatus.PASS, "Click on Finish Loan Button");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.name("ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}
					if(ProductID.equals("LOC"))
					{

						driver.findElement(By.name("advanceRequestBean.paymentCollateralType")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "CollateralType is selected as "+ESign_CollateralType);
						Thread.sleep(5000);
						driver.findElement(By.name("advanceRequestBean.courtesyCallFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						driver.findElement(By.name("advanceRequestBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						driver.findElement(By.name("finishadvance")).click();
						test.log(LogStatus.PASS, "Click on Finish LOC Button");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");

						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr[2]/td/table[2]/tbody/tr/td[2]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr[2]/td/table[2]/tbody/tr/td[2]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

				}

			}
		}


		public void NewLoanWithVIN_ThreeLoans(String SSN,String FileName,String NewVIN) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					//String Term = TestData.getCellData(sheetName,"Term",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					//String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					//System.out.println(Term);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					//String stateProduct=State+" "+ProductID;
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					//String UserName = TestData.getCellData(sheetName,"UserName",row);
					//String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					//String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					//String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					//String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					//*[@id="911100"]/a
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					//*[@id="911100"]/a
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input      Loan2
					// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input      Loan1
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					//	Selection of Product based on the Name provided in Test Data

					//if(driver.findElement(By.id("LoanButtonId")).isEnabled())
					String Var = null;
					if(ProductID.equals("TLP"))							
					{					
						System.out.println("IN TLP");
						// name="vehicleChk"   //*[@id="veh1"]
						////*[@id="vehicleType_dd"]
						driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
						// //*[@id="vinDD"]
						driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
						// //*[@id="vinPop"]/div/table[1]/tbody/tr[1]/td[2]/input
						driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
						driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
						driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();




						driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
						driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
						driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();
						try { 
							Alert alert = driver.switchTo().alert();

							Var = alert.getText();

							alert.accept();
							test.log(LogStatus.PASS, "Alert Message ::"+Var);
							driver.close();
							driver = new InternetExplorerDriver();


						}
						catch (NoAlertPresentException e) {





							if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
							{
								if(ProductName.equals("Tennessee"))
								{
									//driver.findElement(By.xpath("//*[@id="termSel1"]")).click();
									//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
									driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
									test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
								}

								driver.findElement(By.name("ShareScreenBtn")).click();
								test.log(LogStatus.PASS, "ShareScreen Button clicked");
								for( String winHandle1 : driver.getWindowHandles())

								{
									if(!(winHandle1.equals(Parent_Window)))
									{
										driver.switchTo().window(winHandle1);
										Thread.sleep(1000);
										driver.findElement(By.name("confirmSummary")).click();
										test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
									}

								}
								Thread.sleep(3000);
								driver.switchTo().window(Parent_Window);

								for( String winHandle1 : driver.getWindowHandles())

								{

									driver.switchTo().window(winHandle1);

								}                    

								driver.switchTo().defaultContent();

								driver.switchTo().frame("mainFrame");

								driver.switchTo().frame("main");
							}
							driver.findElement(By.id("LoanButtonId")).click();
							//driver.findElement(By.id("LoanButtonId")).click();

							test.log(LogStatus.PASS, "Clicked on New Loan button");
							//New Loan Screens






							if(ProductID.equals("TLP"))
							{	
								String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
								String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
								String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
								String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
								//String VehicleGrade=TestData.getCellData(sheetName,"Vehicle Grade",row);
								String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
								String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
								String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
								String PhoneNbr1 = PhoneNbr.substring(0, 3);
								String PhoneNbr2 = PhoneNbr.substring(3, 6);
								String PhoneNbr3 = PhoneNbr.substring(6, 10);
								String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
								String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
								String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
								String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
								String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
								String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
								String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
								//name="requestBean.titleNumber"
								driver.findElement(By.name("requestBean.titleNumber")).clear();
								driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
								//name="requestBean.appraisalVal"
								driver.findElement(By.name("requestBean.appraisalVal")).clear();
								driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
								//driver.findElement(By.xpath("//*[@id='appraisal']")).sendKeys(AppraisalValue);
								//	driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
								driver.findElement(By.name("button1")).click();
								test.log(LogStatus.PASS, "click on Update 1 button ");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								//driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
								WebDriverWait wait = new WebDriverWait(driver, 10);
								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));

								driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
								//requestBean.licensePltNbr
								driver.findElement(By.name("requestBean.licensePltNbr")).clear();
								driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
								//requestBean.licensePltExpire
								driver.findElement(By.name("requestBean.licensePltExpire")).clear();
								driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
								//requestBean.paintCondition
								driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
								driver.findElement(By.name("iPhoneNbr1")).clear();
								driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
								driver.findElement(By.name("iPhoneNbr2")).clear();
								driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);

								driver.findElement(By.name("iPhoneNbr3")).clear();
								driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
								driver.findElement(By.name("requestBean.companyName")).clear();
								driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
								driver.findElement(By.name("iexpiry1")).clear();
								driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
								driver.findElement(By.name("iexpiry2")).clear();
								driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
								driver.findElement(By.name("iexpiry3")).clear();
								driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
								driver.findElement(By.name("requestBean.polocyNbr")).clear();
								driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
								driver.findElement(By.name("button2")).click();			
								driver.findElement(By.name("button2")).click();	

								test.log(LogStatus.PASS, "click on Update 2 button ");
								Thread.sleep(8000);

								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
								driver.findElement(By.name("process")).click();
								test.log(LogStatus.PASS, "click on process Loan button ");
								try { 
									Alert alert = driver.switchTo().alert();
									alert.accept();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException i) {
									//do what you normally would if you didn't have the alert.
								}
								Thread.sleep(5000);
								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
								test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
								//element
								driver.findElement(By.name("negLoanAmt")).click();
								for( String winHandle1 : driver.getWindowHandles())

								{

									driver.switchTo().window(winHandle1);

								}

								Thread.sleep(1000);


								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.siilBean.advAmt")));

								driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
								Thread.sleep(3000);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.accept();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException h) {
									//do what you normally would if you didn't have the alert.
								}
								Thread.sleep(3000);

								WebElement element = driver.findElement(By.name("requestBean.siilBean.advAmt"));                                       
								Actions builder = new Actions(driver); 
								builder.doubleClick()

								.sendKeys(element, Keys.DELETE)
								//.sendKeys(element, Keys.CLEAR)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.build()
								.perform();




								try { 
									Alert alert = driver.switchTo().alert();
									alert.accept();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException g) {
									//do what you normally would if you didn't have the alert.
								}

								Thread.sleep(6000);
								driver.findElement(By.name("requestBean.siilBean.advAmt")).sendKeys("1000");
								driver.findElement(By.name("negSel")).click();
								driver.findElement(By.name("reCalculate")).click();
								driver.findElement(By.name("negSel")).click();
								Thread.sleep(3000);
								driver.switchTo().window(Parent_Window);

								for( String winHandle1 : driver.getWindowHandles())

								{

									driver.switchTo().window(winHandle1);

								}                    

								driver.switchTo().defaultContent();

								driver.switchTo().frame("mainFrame");

								driver.switchTo().frame("main");

								driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
								//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
								test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
								//requestBean.siilBean.disbType
								driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
								test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
								//requestBean.siilBean.advAmt
								String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");

								driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys("1000");
								test.log(LogStatus.PASS, "Disb Amt is enterted as "+"1000");


								Thread.sleep(5000);
								driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
								test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
								if(ESign_CourtesyCallConsent.equals("Yes"))
								{
									if(ESign_Preference.equals("Call"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
									}
									if(ESign_Preference.equals("Mail"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
									}
									if(ESign_Preference.equals("SMS"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

										try { 
											Alert alert = driver.switchTo().alert();
											alert.dismiss();
											//if alert present, accept and move on.														

										}
										catch (NoAlertPresentException f) {
											//do what you normally would if you didn't have the alert.
										}
									}

								}
								if(AllowPromotion.equals("Yes"))
								{
									driver.findElement(By.name("allowPromotion")).click();
									test.log(LogStatus.PASS, "AllowPromotion is selected ");
									//String mwh=driver.getWindowHandle();
									driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
									test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
									//String winHandle = driver.getWindowHandle(); //Get current window handle.									
								}
								driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
								driver.findElement(By.name("finishLoan")).click();
								test.log(LogStatus.PASS, "Click on Finish Loan Button");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
								//driver.findElement(By.name("OKBut")).click();
								//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
								test.log(LogStatus.PASS, "click on Yes button ");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								//OKBut
								if(driver.findElement(By.name("ok")).isDisplayed())
									//if(driver.findElement(By.name("OKBut")).isDisplayed())
								{
									test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
									//driver.findElement(By.name("ok")).click();
									driver.findElement(By.name("ok")).click();
								}
								else
								{
									test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
								}
							}

						}


					}

				}



			}
		}

		public void NewLoanWithVIN_TwoCust(String SSN,String FileName,String NewVIN) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					//String Term = TestData.getCellData(sheetName,"Term",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					//String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					//System.out.println(Term);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					//String stateProduct=State+" "+ProductID;
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					//String UserName = TestData.getCellData(sheetName,"UserName",row);
					//String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					//String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					//String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					//String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					//*[@id="911100"]/a
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					//*[@id="911100"]/a
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input      Loan2
					// /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input      Loan1
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					//	Selection of Product based on the Name provided in Test Data

					//if(driver.findElement(By.id("LoanButtonId")).isEnabled())
					String Var = null;
					if(ProductID.equals("TLP"))							
					{					
						System.out.println("IN TLP");
						// name="vehicleChk"   //*[@id="veh1"]
						////*[@id="vehicleType_dd"]
						driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
						// //*[@id="vinDD"]
						driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
						// //*[@id="vinPop"]/div/table[1]/tbody/tr[1]/td[2]/input
						driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
						driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
						driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();




						driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
						driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
						driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();
						try { 
							Alert alert = driver.switchTo().alert();

							Var = alert.getText();

							alert.accept();
							test.log(LogStatus.PASS, "Alert Message ::"+Var);
							driver.close();
							driver = new InternetExplorerDriver();


						}
						catch (NoAlertPresentException e) {





							if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
							{
								if(ProductName.equals("Tennessee"))
								{
									//driver.findElement(By.xpath("//*[@id="termSel1"]")).click();
									//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
									driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
									test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
								}

								driver.findElement(By.name("ShareScreenBtn")).click();
								test.log(LogStatus.PASS, "ShareScreen Button clicked");
								for( String winHandle1 : driver.getWindowHandles())

								{
									if(!(winHandle1.equals(Parent_Window)))
									{
										driver.switchTo().window(winHandle1);
										Thread.sleep(6000);
										driver.findElement(By.name("confirmSummary")).click();
										test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
									}

								}
								Thread.sleep(6000);
								driver.switchTo().window(Parent_Window);

								for( String winHandle1 : driver.getWindowHandles())

								{

									driver.switchTo().window(winHandle1);

								}                    

								driver.switchTo().defaultContent();

								driver.switchTo().frame("mainFrame");

								driver.switchTo().frame("main");
							}
							driver.findElement(By.id("LoanButtonId")).click();
							//driver.findElement(By.id("LoanButtonId")).click();

							test.log(LogStatus.PASS, "Clicked on New Loan button");
							//New Loan Screens






							if(ProductID.equals("TLP"))
							{	
								String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
								String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
								String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
								String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
								//String VehicleGrade=TestData.getCellData(sheetName,"Vehicle Grade",row);
								String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
								String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
								String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
								String PhoneNbr1 = PhoneNbr.substring(0, 3);
								String PhoneNbr2 = PhoneNbr.substring(3, 6);
								String PhoneNbr3 = PhoneNbr.substring(6, 10);
								String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
								String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
								String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
								String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
								String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
								String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
								String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
								//name="requestBean.titleNumber"
								driver.findElement(By.name("requestBean.titleNumber")).clear();
								driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
								//name="requestBean.appraisalVal"
								driver.findElement(By.name("requestBean.appraisalVal")).clear();
								driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
								//driver.findElement(By.xpath("//*[@id='appraisal']")).sendKeys(AppraisalValue);
								//	driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
								driver.findElement(By.name("button1")).click();
								test.log(LogStatus.PASS, "click on Update 1 button ");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								//driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
								WebDriverWait wait = new WebDriverWait(driver, 10);
								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));

								driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
								//requestBean.licensePltNbr
								driver.findElement(By.name("requestBean.licensePltNbr")).clear();
								driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
								//requestBean.licensePltExpire
								driver.findElement(By.name("requestBean.licensePltExpire")).clear();
								driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
								//requestBean.paintCondition
								driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
								driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
								driver.findElement(By.name("iPhoneNbr1")).clear();
								driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
								driver.findElement(By.name("iPhoneNbr2")).clear();
								driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);

								driver.findElement(By.name("iPhoneNbr3")).clear();
								driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
								driver.findElement(By.name("requestBean.companyName")).clear();
								driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
								driver.findElement(By.name("iexpiry1")).clear();
								driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
								driver.findElement(By.name("iexpiry2")).clear();
								driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
								driver.findElement(By.name("iexpiry3")).clear();
								driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
								driver.findElement(By.name("requestBean.polocyNbr")).clear();
								driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
								driver.findElement(By.name("button2")).click();			
								driver.findElement(By.name("button2")).click();	

								test.log(LogStatus.PASS, "click on Update 2 button ");
								Thread.sleep(8000);

								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
								driver.findElement(By.name("process")).click();
								test.log(LogStatus.PASS, "click on process Loan button ");
								try { 
									Alert alert = driver.switchTo().alert();
									alert.accept();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException i) {
									//do what you normally would if you didn't have the alert.
								}
								Thread.sleep(5000);
								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
								test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
								//element
								driver.findElement(By.name("negLoanAmt")).click();
								for( String winHandle1 : driver.getWindowHandles())

								{

									driver.switchTo().window(winHandle1);

								}

								Thread.sleep(1000);


								wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.siilBean.advAmt")));

								driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
								Thread.sleep(3000);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.accept();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException h) {
									//do what you normally would if you didn't have the alert.
								}
								Thread.sleep(3000);

								WebElement element = driver.findElement(By.name("requestBean.siilBean.advAmt"));                                       
								Actions builder = new Actions(driver); 
								builder.doubleClick()

								.sendKeys(element, Keys.DELETE)
								//.sendKeys(element, Keys.CLEAR)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.sendKeys(element,Keys.BACK_SPACE)
								.build()
								.perform();




								try { 
									Alert alert = driver.switchTo().alert();
									alert.accept();
									//if alert present, accept and move on.														

								}
								catch (NoAlertPresentException g) {
									//do what you normally would if you didn't have the alert.
								}

								Thread.sleep(6000);
								driver.findElement(By.name("requestBean.siilBean.advAmt")).sendKeys("1000");
								driver.findElement(By.name("negSel")).click();
								driver.findElement(By.name("reCalculate")).click();
								driver.findElement(By.name("negSel")).click();
								Thread.sleep(3000);
								driver.switchTo().window(Parent_Window);

								for( String winHandle1 : driver.getWindowHandles())

								{

									driver.switchTo().window(winHandle1);

								}                    

								driver.switchTo().defaultContent();

								driver.switchTo().frame("mainFrame");

								driver.switchTo().frame("main");

								driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
								//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr[1]/td/table[2]/tbody/tr/td/table/tbody/tr[3]/td[3]/select")).sendKeys(ESign_CollateralType);
								test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
								//requestBean.siilBean.disbType
								driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
								test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
								//requestBean.siilBean.advAmt
								String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");

								driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys("1000");
								test.log(LogStatus.PASS, "Disb Amt is enterted as "+"1000");


								Thread.sleep(5000);
								driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
								test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
								if(ESign_CourtesyCallConsent.equals("Yes"))
								{
									if(ESign_Preference.equals("Call"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
									}
									if(ESign_Preference.equals("Mail"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
									}
									if(ESign_Preference.equals("SMS"))	
									{
										driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
										test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

										try { 
											Alert alert = driver.switchTo().alert();
											alert.dismiss();
											//if alert present, accept and move on.														

										}
										catch (NoAlertPresentException f) {
											//do what you normally would if you didn't have the alert.
										}
									}

								}
								if(AllowPromotion.equals("Yes"))
								{
									driver.findElement(By.name("allowPromotion")).click();
									test.log(LogStatus.PASS, "AllowPromotion is selected ");
									//String mwh=driver.getWindowHandle();
									driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
									test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
									//String winHandle = driver.getWindowHandle(); //Get current window handle.									
								}
								driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
								driver.findElement(By.name("finishLoan")).click();
								test.log(LogStatus.PASS, "Click on Finish Loan Button");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
								//driver.findElement(By.name("OKBut")).click();
								//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input[1]")).click();				
								test.log(LogStatus.PASS, "click on Yes button ");
								for( String winHandle1 : driver.getWindowHandles())
								{
									driver.switchTo().window(winHandle1);
								}			
								driver.switchTo().defaultContent();
								driver.switchTo().frame("mainFrame");
								driver.switchTo().frame("main");
								//OKBut
								if(driver.findElement(By.name("ok")).isDisplayed())
									//if(driver.findElement(By.name("OKBut")).isDisplayed())
								{
									test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
									//driver.findElement(By.name("ok")).click();
									driver.findElement(By.name("ok")).click();
								}
								else
								{
									test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
								}
							}

						}


					}

				}

				/*driver.switchTo().defaultContent();

							driver.switchTo().frame("mainFrame");

							driver.switchTo().frame("main");

							System.out.println("alert message" + Var);
							System.out.println("Alert accepted");
							test.log(LogStatus.PASS, "Alert Message :: Max Two Loan With this VIN");
							driver.close();*/


				//if alert present, accept and move on.														





			}
		}

		public void DefaultPayment_Validation(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String CheckStaus=null;
					CheckStaus = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[5]/font")).getText();
					double RegAmt = Double.parseDouble(CheckStaus);

					test.log(LogStatus.PASS,"Default Amount is :: "+CheckStaus);
					System.out.print(CheckStaus);	
					String CheckStaus1=null;
					CheckStaus1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[9]/font")).getText();

					double RegAmt1 = Double.parseDouble(CheckStaus1);
					test.log(LogStatus.PASS,"Balance Principle Amount is :: "+CheckStaus1);
					System.out.print(CheckStaus1);	
					String CheckStaus2=null;
					CheckStaus2 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[10]/font")).getText();

					double RegAmt2 = Double.parseDouble(CheckStaus2);
					test.log(LogStatus.PASS,"Balance Interest Amount is :: "+CheckStaus2);
					System.out.print(CheckStaus2);	
					String CheckStaus3=null;
					CheckStaus3 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[11]/font")).getText();

					double RegAmt3 = Double.parseDouble(CheckStaus3);
					test.log(LogStatus.PASS,"Balance Fee Amount is :: "+CheckStaus3);
					System.out.print(CheckStaus3);	

					double totalbalance = RegAmt1+RegAmt2+RegAmt3;
					test.log(LogStatus.PASS,"Total Balance Amount is :: "+"== Default Amount is ::"+RegAmt+"=="+totalbalance );

					driver.close();
					driver = new InternetExplorerDriver();

				}
			}
		}


		public void Loandate_AgeStore(String SSN,String FileName,int Days) throws Exception

		{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan"; 

			for(int row=2;row<=lastrow;row++)

			{ 

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);


					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}
					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					DueDate  =  driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();

					test.log(LogStatus.PASS, "Capture Loan Date"+DueDate);

					System.out.print(DueDate); 

					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);


					DateFormat df=new SimpleDateFormat("MM/dd/yyyy"); 

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin"); 

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password); 

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);



					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS); 

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);




					String DDueDate[] =DueDate.split("/");

					//String date = DDueDate[1];

					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];




					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					driver.findElement(By.name("storeCode")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{ 

						test.log(LogStatus.PASS, "Process Date updated successfully");

						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date not updated successfully.");

					}
				}

			}

		}

		public void PartialPayment (String SSN,String FileName) throws Exception{		


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";
			for(int row=2;row<=lastrow;row++)
			{
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();
					this.Login(UserName, Password, StoreID);
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					Thread.sleep(5000);

					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Payment");
					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@id='PD5']")).click();
						test.log(LogStatus.PASS, " Click pay any other amt Type ");
						driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys("50");
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");
						test.log(LogStatus.PASS, "tenderType  as Cash ");
						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys("50");

					}

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
					} 
					Thread.sleep(2000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[2]")).click();
					test.log(LogStatus.PASS, "ReNewButton No is Selected ");

					if(driver.findElement(By.name("Ok")).isDisplayed())

					{
						test.log(LogStatus.PASS, "Partial Payment is Completed Successfully ");
						driver.findElement(By.name("Ok")).click();
					}
					else
					{
						test.log(LogStatus.FAIL, "Partial Payment is not Completed Successfully ");
					}
				}
			}

		}

		public void HistoryValidations(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);


					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					String IntAmt1=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					IntAmt1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[2]/td[10]/font")).getText();

					test.log(LogStatus.PASS,"Interest Amount Need to Paid :: "+IntAmt1);
					System.out.print(IntAmt1);	
					String FeeAmt1=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					FeeAmt1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[2]/td[11]/font")).getText();

					test.log(LogStatus.PASS,"Fee Amount Need To Paid :: "+FeeAmt1);
					System.out.print(FeeAmt1);
					String PrincAmt1=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					PrincAmt1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[2]/td[9]/font")).getText();

					test.log(LogStatus.PASS,"Principle Amount Need to Paid:: "+PrincAmt1);
					System.out.print(PrincAmt1);

					/*
				String IntAmt=null;
				//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
				IntAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[3]/td[10]/font")).getText();

				test.log(LogStatus.PASS,"Interest Amount Paid :: "+IntAmt);
				System.out.print(IntAmt);	
				String FeeAmt=null;
				//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
				FeeAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[11]/font")).getText();

				test.log(LogStatus.PASS,"Fee Amount Paid :: "+FeeAmt);
				System.out.print(FeeAmt);
				String PrincAmt=null;
				//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
				PrincAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[9]/font")).getText();

				test.log(LogStatus.PASS,"Principle Amount Paid :: "+PrincAmt);
				System.out.print(PrincAmt);*/
					String IntAmt2=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					IntAmt2 = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[28]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Interest Amount Paid to date:: "+IntAmt2);
					System.out.print(IntAmt2);	
					String FeeAmt2=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					FeeAmt2 = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[29]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Fee Amount Paid to date:: "+FeeAmt2);
					System.out.print(FeeAmt2);
					String PrincAmt2=null;
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]
					PrincAmt2 = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[27]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Principle Amount Paid to date:: "+PrincAmt2);
					System.out.print(PrincAmt2);

				}
			}
		}

		public void NewLoanWithVIN3(String SSN,String FileName,String NewVIN2) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);


					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
						if(ProductID.equals("TLP"))							
						{					
							System.out.println("IN TLP");
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN2);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN2);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).clear();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();				
						}												

					if(ProductName.equals("Tennessee"))
					{
						//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
						driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
						test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
					}

					driver.findElement(By.name("ShareScreenBtn")).click();
					test.log(LogStatus.PASS, "ShareScreen Button clicked");
					for( String winHandle1 : driver.getWindowHandles())

					{
						if(!(winHandle1.equals(Parent_Window)))
						{
							driver.switchTo().window(winHandle1);
							Thread.sleep(1000);
							driver.findElement(By.name("confirmSummary")).click();
							test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
						}

					}
					Thread.sleep(3000);
					driver.switchTo().window(Parent_Window);

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}                    

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");
					driver.findElement(By.id("LoanButtonId")).click();

					test.log(LogStatus.PASS, "Clicked on New Loan button");


					if(ProductID.equals("TLP"))
					{	
						String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
						String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
						String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
						String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
						String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
						String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
						String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
						String PhoneNbr1 = PhoneNbr.substring(0, 3);
						String PhoneNbr2 = PhoneNbr.substring(3, 6);
						String PhoneNbr3 = PhoneNbr.substring(6, 10);
						String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
						String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
						String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
						String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
						String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
						String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
						String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
						driver.findElement(By.name("requestBean.titleNumber")).clear();
						driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
						driver.findElement(By.name("requestBean.appraisalVal")).clear();
						driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
						driver.findElement(By.name("button1")).click();
						test.log(LogStatus.PASS, "click on Update 1 button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						WebDriverWait wait = new WebDriverWait(driver, 10);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));
						driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
						driver.findElement(By.name("requestBean.licensePltNbr")).clear();
						driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
						driver.findElement(By.name("requestBean.licensePltExpire")).clear();
						driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
						Thread.sleep(2000);
						driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
						driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
						driver.findElement(By.name("iPhoneNbr1")).clear();
						driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
						driver.findElement(By.name("iPhoneNbr2")).clear();
						driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);

						driver.findElement(By.name("iPhoneNbr3")).clear();
						driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
						driver.findElement(By.name("requestBean.companyName")).clear();
						driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
						driver.findElement(By.name("iexpiry1")).clear();
						driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
						driver.findElement(By.name("iexpiry2")).clear();
						driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
						driver.findElement(By.name("iexpiry3")).clear();
						driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
						driver.findElement(By.name("requestBean.polocyNbr")).clear();
						driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
						driver.findElement(By.name("button2")).click();			
						Thread.sleep(1000);
						driver.findElement(By.name("button2")).click();	
						test.log(LogStatus.PASS, "click on Update 2 button ");
						Thread.sleep(8000);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
						driver.findElement(By.name("process")).click();
						test.log(LogStatus.PASS, "click on process Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						Thread.sleep(5000);



						driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
						test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
						test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
						String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys(Instamt);
						test.log(LogStatus.PASS, "Disb Amt is enterted as "+Instamt);


						Thread.sleep(5000);

						driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
						test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
						if(ESign_CourtesyCallConsent.equals("Yes"))
						{
							if(ESign_Preference.equals("Call"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("Mail"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
							}
							if(ESign_Preference.equals("SMS"))	
							{
								driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
								test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

								try { 
									Alert alert = driver.switchTo().alert();
									alert.dismiss();

								}
								catch (NoAlertPresentException e) {
								}
							}

						}
						if(AllowPromotion.equals("Yes"))
						{
							driver.findElement(By.name("allowPromotion")).click();
							test.log(LogStatus.PASS, "AllowPromotion is selected ");
							driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
							test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
						}
						driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
						driver.findElement(By.name("finishLoan")).click();
						test.log(LogStatus.PASS, "Click on Finish Loan Button");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
						test.log(LogStatus.PASS, "click on Yes button ");
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.name("ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
							driver.findElement(By.name("ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
						}
					}

				}

			}
		}


		public void LoanDate_Agestore_C(String SSN,String FileName, int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String LoanDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

	}

	//String winHandleBefore = driver.getWindowHandle();

	for(String winHandle : driver.getWindowHandles()){

	driver.switchTo().window(winHandle);

	}

	Thread.sleep(8000);

	// driver.findElement(By.xpath("//*[@id='home']")).click();*/

					LoanDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[11]/td/span[2]")).getText();

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(LoanDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(LoanDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/"); 

					/*	 Date DDueDate = df.parse(LoanDate);
	 Calendar cal = Calendar.getInstance();
	 cal.setTime(DDueDate);
	 cal.add(Calendar.DATE, days);
	  Date DDueDateminus1= cal.getTime();

	  String DueDateminus1 =df.format(DDueDateminus1);
	 String DueDate0[] =LoanDate.split("/"); */





					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					/*Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					
					driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void AgeStore2_1_C(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					Thread.sleep(2000);
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

	}

	//String winHandleBefore = driver.getWindowHandle();

	for(String winHandle : driver.getWindowHandles()){

	driver.switchTo().window(winHandle);

	}

	Thread.sleep(8000);

	// driver.findElement(By.xpath("//*[@id='home']")).click();*/

					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[2]")).getText();

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(4000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					// String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					Thread.sleep(2000);
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					/*driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");
*/
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void DefaultPaymentStatus1_C(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String FirstLoanStatus=null;
					String SecondLoanStatus=null;
					String FirstBalanceStatus=null;
					String SecondBalanceStatus=null;
					String FirstVehicleStatus=null;
					String SecondVehicleStatus=null;

					FirstLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[7]")).getText();

					test.log(LogStatus.PASS,"First Loan Status::  "+FirstLoanStatus);

					SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);

					FirstBalanceStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					test.log(LogStatus.PASS,"First Balance Status::  "+FirstBalanceStatus);

					SecondBalanceStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[6]")).getText();

					test.log(LogStatus.PASS,"Second Balance Status::  "+SecondBalanceStatus);

					FirstVehicleStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[7]")).getText();

					test.log(LogStatus.PASS,"First Vehicle Status::  "+FirstVehicleStatus);

					SecondVehicleStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[7]")).getText();

					test.log(LogStatus.PASS,"Second Vehicle Status::  "+SecondVehicleStatus);


					//driver.close();

				}
			}
		}
		public void AgeStore_After_Repo(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

	}

	//String winHandleBefore = driver.getWindowHandle();

	for(String winHandle : driver.getWindowHandles()){

	driver.switchTo().window(winHandle);

	}

	Thread.sleep(8000);

	// driver.findElement(By.xpath("//*[@id='home']")).click();*/

					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[7]/td/span[2]")).getText();
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[7]/td/span[2]

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(4000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					/*driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");
*/
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					Thread.sleep(1000);

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}
		public void Salvage_Morethan_twoloans (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Salvage");

					test.log(LogStatus.PASS, "Salvage is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");

					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();


					test.log(LogStatus.PASS, "Clicked on Go Button: ");	

					WebElement SalvageCmp = driver.findElement(By.xpath("//*[@id='solvageCompany']"));

					SalvageCmp.sendKeys("Salvage Company220");

					test.log(LogStatus.PASS, "Salvage Company220 is selected from dropdown");	

					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");

					driver.findElement(By.name("requestBean.salvageValue")).clear();
					driver.findElement(By.name("requestBean.salvageValue")).sendKeys("5000");
					test.log(LogStatus.PASS, "Salvage value is Entered");

					driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table[3]/tbody/tr[5]/td[3]/textarea")).sendKeys("Comments");


					test.log(LogStatus.PASS, "Comments are Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Salvage is completed successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Salvage is not completed successfully.");

					}



				}

			}

		}

		public void Verify_Salvage_History_Loan1(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						//driver.findElement(By.name("button")).click();
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						//   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					//          //*[@id="transactionDetailsTable"]/tbody/tr[6]/td[4]/font                                         //*[@id="transactionDetailsTable"]/tbody/tr[5]/td[4]/font
					int n=driver.findElements(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr")).size();

					for(int i=2;i<=n;i++)
					{
						String transactino_value=driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+i+"]/td[4]/font")).getText();


						if(transactino_value.equalsIgnoreCase("Salvage"))
						{
							
						
					

			      String Salvagerecord=driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+i+"]/td[4]/font")).getText();

					String SalvageAmt  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+i+"]/td[5]/font")).getText();

////////////////////////////////////////////////////////////////////// //*[@id="transactionDetailsTable"]/tbody/tr[5]/td[5]/font
					if((Salvagerecord).contains("Salvage"))
					{
						test.log(LogStatus.PASS,"Salvage Amount:" +SalvageAmt );
						break;
					}
					else
					{
						test.log(LogStatus.PASS,"Salvage Record is not Displayed.");
					}
					//   String CheckStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Check Status is ::"+CheckStatus);

					//    String LoanStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Loan Status is ::"+LoanStatus);
				}
					}
				}
			}
			
		}
	
				
				public void Verify_Salvage_History_Loan2(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						//driver.findElement(By.name("button")).click();
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();
						//	driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();

						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						//   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					String Salvagerecord  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[4]/font")).getText();

					String SalvageAmt  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[5]/font")).getText();


					if((Salvagerecord).contains("Salvage"))
					{
						test.log(LogStatus.PASS,"Salvage Amount:" +SalvageAmt );
					}
					else
					{
						test.log(LogStatus.PASS,"Salvage Record is not Displayed.");
					}
					//   String WriteoffWaived = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[4]/font")).getText();
					//*[@id="transactionDetailsTable"]/tbody/tr[6]/td[4]/font

					//  String WriteOffAmt = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[5]/font")).getText();

					/*   if((WriteoffWaived).contains("Write Off Waived"))
	 		{
	 			test.log(LogStatus.PASS,"Write Off Waived Amount:" +WriteOffAmt );
	 		}
	 		else
	 		{
	 			test.log(LogStatus.PASS,"Write Off Waived Record is not Displayed.");
	 		}
					 */
					//    test.log(LogStatus.PASS,"Check Status is ::"+CheckStatus);

					//    String LoanStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Loan Status is ::"+LoanStatus);
				}
			}
		}


		public void Salvage_Morethan_Oneloan (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					String DDueDate[] =DefaultDate.split("/");


					Date DDueDateminus1 = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, days);

					Date DDueDate1= cal.getTime();

					DefaultDate =df.format(DDueDate1);

					String DueDate0[] =DefaultDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Salvage");

					test.log(LogStatus.PASS, "Salvage is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");

					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();


					test.log(LogStatus.PASS, "Clicked on Go Button: ");	

					WebElement SalvageCmp = driver.findElement(By.xpath("//*[@id='solvageCompany']"));

					SalvageCmp.sendKeys("Salvage Company220");

					test.log(LogStatus.PASS, "Salvage Company220 is selected from dropdown");	

					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");

					driver.findElement(By.name("requestBean.salvageValue")).clear();
					driver.findElement(By.name("requestBean.salvageValue")).sendKeys("2000");
					test.log(LogStatus.PASS, "Salvage value is Entered");

					driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table[3]/tbody/tr[5]/td[3]/textarea")).sendKeys("Comments");


					test.log(LogStatus.PASS, "Comments are Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Salvage is completed successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Salvage is not completed successfully.");

					}



				}

			}

		}

		public void Salvage_lessamt (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Salvage");

					test.log(LogStatus.PASS, "Salvage is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");

					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();


					test.log(LogStatus.PASS, "Clicked on Go Button: ");	

					WebElement SalvageCmp = driver.findElement(By.xpath("//*[@id='solvageCompany']"));

					SalvageCmp.sendKeys("Salvage Company220");

					test.log(LogStatus.PASS, "Salvage Company220 is selected from dropdown");	

					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");

					driver.findElement(By.name("requestBean.salvageValue")).clear();
					driver.findElement(By.name("requestBean.salvageValue")).sendKeys("200");
					test.log(LogStatus.PASS, "Salvage value is Entered");

					driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table[3]/tbody/tr[5]/td[3]/textarea")).sendKeys("Comments");


					test.log(LogStatus.PASS, "Comments are Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Salvage is completed successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Salvage is not completed successfully.");

					}



				}

			}

		}
		public void DefaultLoanStatus_1(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");

					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");

					String LoanoneStatus=null;			
					LoanoneStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();
					test.log(LogStatus.PASS,"First Loan Status::  "+LoanoneStatus);


				}
			}

		}

		public void DefaultLoanStatus_2(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");

					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");

					String LoantwoStatus=null;			



					//	FirstLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[7]")).getText();

					LoantwoStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();
					test.log(LogStatus.PASS,"First Loan Status::  "+LoantwoStatus);

					//	FirstBalanceStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//	test.log(LogStatus.PASS,"First Balance Status::  "+FirstBalanceStatus);

					//	FirstVehicleStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[7]")).getText();

					//	test.log(LogStatus.PASS,"First Vehicle Status::  "+FirstVehicleStatus);

					//	driver.findElement(By.xpath("//*[@id='showMore-2']")).click();



					//	SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//	test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);

					//	SecondBalanceStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[6]")).getText();

					//	test.log(LogStatus.PASS,"Second Balance Status::  "+SecondBalanceStatus);

					//	SecondVehicleStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[7]")).getText();

					//	test.log(LogStatus.PASS,"Second Vehicle Status::  "+SecondVehicleStatus);



				}
			}
			//driver.close();
		}
		/*public void CustomerRefund(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}

					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					List<WebElement> statusvalues = driver.findElements(By.id("ddlStatus"));
					driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Enter the Disb Type Cash");
					driver.findElement(By.name("password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Enter the Password");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on Finish Refund Button");
					test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
					driver.quit();
					
				}
			}
		}*/
	
		public void CustomerRefund_secondloan(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
						test.log(LogStatus.PASS, "Click on GO Button");
					}
					
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					int n=driver.findElements(By.xpath("//select[@name='transactionList']/option")).size();

					for(int i=1;i<=n;i++)
					{
						String transactino_value=driver.findElement(By.xpath("//select[@name='transactionList']/option["+i+"]")).getText();


						if(transactino_value.equalsIgnoreCase("CustomerRefund"))
						{
							
						
					driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
					test.log(LogStatus.PASS, "CustomerRefund option is available in the list");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					
					driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Enter the Disb Type Cash");
					driver.findElement(By.name("password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Enter the Password");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on Finish Refund Button");
					test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
						}
									
				
						else
						{
							driver.findElement(By.xpath("//*[@id='CustGrid']/tbody/tr[2]/td[13]/table/tbody/tr/td[2]/input[2]")).click();
						
							driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
							driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();
							driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
							test.log(LogStatus.PASS, "CustomerRefund option is available in the list");
							
							if(ProductID.equals("TLP"))
							{
								driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
							}

							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}

							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");

							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
							test.log(LogStatus.PASS, "Enter the Disb Type Cash");
							driver.findElement(By.name("password")).sendKeys(Password);
							test.log(LogStatus.PASS, "Enter the Password");
							driver.findElement(By.name("finish")).click();
							test.log(LogStatus.PASS, "Click on Finish Refund Button");
							test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
							break;
					  }
					}
				}
				}
		}		
		

/*
		public void CustomerRefund_secondloan(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
						test.log(LogStatus.PASS, "Click on GO Button");
					}
					
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					int n=driver.findElements(By.xpath("//select[@name='transactionList']/option")).size();

					for(int i=1;i<=n;i++)
					{
						String transactino_value=driver.findElement(By.xpath("//select[@name='transactionList']/option["+i+"]")).getText();


						if(transactino_value.equalsIgnoreCase("CustomerRefund"))
						{
							
						
					driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
					test.log(LogStatus.PASS, "CustomerRefund option is available in the list");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					
					driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Enter the Disb Type Cash");
					driver.findElement(By.name("password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Enter the Password");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on Finish Refund Button");
					test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
						}
						else
						{
							driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
							driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
							test.log(LogStatus.PASS, "CustomerRefund option is available in the list");
							
							if(ProductID.equals("TLP"))
							{
								driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
							}

							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}

							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");

							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
							test.log(LogStatus.PASS, "Enter the Disb Type Cash");
							driver.findElement(By.name("password")).sendKeys(Password);
							test.log(LogStatus.PASS, "Enter the Password");
							driver.findElement(By.name("finish")).click();
							test.log(LogStatus.PASS, "Click on Finish Refund Button");
							test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
					  }
				   }
				}
			}
		}
*/
		public void Partial_Payment(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					/*if(ProductID.equals("PDL"))
			{*/

					Thread.sleep(3000);
					//	/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[11]/input[1]")).click();
					/*	                          //   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
			}*/
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Payment");
					/*	if(ProductID.equals("LOC"))
			{*/
					//*[@id="go_Button"]
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					//driver.findElement(By.name("button")).click(); 
					//}
					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
						//do what you normally would if you didn't have the alert.

					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					WebElement Pmtbutton = driver.findElement(By.id("PD4"));
					Pmtbutton.click();
					String PmtAmt = driver.findElement(By.name("requestBean.siilBean.payAmt")).getAttribute("value");

					driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "TenderType Select as ::Cash");

					driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(PmtAmt);
					test.log(LogStatus.PASS, "TenderAmount Entered is::"+PmtAmt);
					driver.findElement(By.name("requestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Passwor Entered as::"+Password);
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Clicked on Finish Partial Payment Button");
					WebElement yesbtn = driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]"));
					yesbtn.click();

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
						//do what you normally would if you didn't have the alert.

					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input
					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input
					if(driver.findElement(By.xpath("//*[@id='totPart']/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())
					{
						driver.findElement(By.xpath("//*[@id='totPart']/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "Clicked on Confirmation Yes Button");
					}		

					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/p[2]/input[1]      Confirm Yes button

					//String CheckStaus=null;
					/*	//	CheckStaus = driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[6]/td[3]/span[2]")).getText();
			CheckStaus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();
			//CheckStaus1 = driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr/td/form/table[3]/tbody/tr[4]/td[5]")).getText();
			if((CheckStaus).contains("Deposit"))
			{
				test.log(LogStatus.PASS,"CheckStatus is  Displayed as::"+CheckStaus);
			}
			else
			{
				test.log(LogStatus.PASS,"CustomerEOD Record is not Displayed.");
			}*/

				}
			}
		}

		public void Void_Partial_Payment(String SSN,String FileName) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();	
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();	
					driver.switchTo().defaultContent();				
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");	
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("button")).click(); 
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}


					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();						
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);
					}
					if(ProductID.equals("TLP"))
					{
						Thread.sleep(1000);
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(TenderType);
					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");

					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
						WebElement yesbtn = driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]"));
						yesbtn.click();
					}		


					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
						//do what you normally would if you didn't have the alert.
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{

						if(driver.findElement(By.name("Ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
					if(ProductID.equals("PDL"))
					{

						if(driver.findElement(By.name("checkyes")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("checkyes")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
				}

			}
		}


		public void Voluntary_Surrender_After_Default(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					/*String FirstLoanStatus=null;
				String SecondLoanStatus=null;

			FirstLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[7]")).getText();

			/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input

			test.log(LogStatus.PASS,"First Loan Status::  "+FirstLoanStatus);

			SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

			test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);*/


					//driver.close();
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					WebElement TransactionList = driver.findElement(By.xpath("//*[@id='CustGrid']/tbody/tr[2]/td[13]/table/tbody/tr/td[1]/select"));
					TransactionList.sendKeys("Voluntary Surrender");
					//driver.findElement(By.xpath("//*[@value='Go' and @type='button']"));
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					driver.findElement(By.xpath("//*[@id='comments']")).sendKeys("Voluntary Surrender Amount");
					driver.findElement(By.name("password")).sendKeys("1234");
					driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr[9]/td/table/tbody/tr[5]/td[3]/input")).click();
					test.log(LogStatus.PASS,"Voluntary Surrender Amount Completed");


				}
			}
		}

		public void Payoff_Amount(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					/*if(ProductID.equals("PDL"))
			{*/

					Thread.sleep(3000);
					//	/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[11]/input[1]")).click();
					/*	                          //   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
			}*/
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Payment");
					/*	if(ProductID.equals("LOC"))
			{*/
					//*[@id="go_Button"]
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					//driver.findElement(By.name("button")).click(); 
					//}
					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
						//do what you normally would if you didn't have the alert.

					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					WebElement Pmtbutton = driver.findElement(By.id("PD3"));
					Pmtbutton.click();
					String PmtAmt = driver.findElement(By.name("requestBean.siilBean.payAmt")).getAttribute("value");

					driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "TenderType Select as ::Cash");

					driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(PmtAmt);
					test.log(LogStatus.PASS, "TenderAmount Entered is::"+PmtAmt);
					driver.findElement(By.name("requestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Passwor Entered as::"+Password);
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Clicked on Finish Payoff Button");
					//	WebElement yesbtn = driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]"));
					//	yesbtn.click();

					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
						//do what you normally would if you didn't have the alert.

					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input
					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input
					if(driver.findElement(By.xpath("//*[@id='totPart']/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())
					{
						driver.findElement(By.xpath("//*[@id='totPart']/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "Clicked on Confirmation Yes Button");
					}		

					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/p[2]/input[1]      Confirm Yes button

					//String CheckStaus=null;
					/*	//	CheckStaus = driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[6]/td[3]/span[2]")).getText();
			CheckStaus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();
			//CheckStaus1 = driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table/tbody/tr/td/form/table[3]/tbody/tr[4]/td[5]")).getText();
			if((CheckStaus).contains("Deposit"))
			{
				test.log(LogStatus.PASS,"CheckStatus is  Displayed as::"+CheckStaus);
			}
			else
			{
				test.log(LogStatus.PASS,"CustomerEOD Record is not Displayed.");
			}*/

				}
			}
		}

		public void Void_Payoff_Payment(String SSN,String FileName) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();	
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();	
					driver.switchTo().defaultContent();				
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}         					//     /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input
					Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");	
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("button")).click(); 
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.														

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}


					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();						
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);
					}
					if(ProductID.equals("TLP"))
					{
						Thread.sleep(1000);
						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(TenderType);
					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");

					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
						WebElement yesbtn = driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[1]"));
						yesbtn.click();
					}		


					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();
						//if alert present, accept and move on.														

					}
					catch (NoAlertPresentException e) {
						//do what you normally would if you didn't have the alert.
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{

						if(driver.findElement(By.name("Ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
					if(ProductID.equals("PDL"))
					{

						if(driver.findElement(By.name("checkyes")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("checkyes")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
				}

			}
		}

		public void DueDate_History(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					//	String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					//	String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						//driver.findElement(By.name("button")).click();
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();

						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						//   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					/*	if(ProductID.equals("LOC"))
			{*/
					//*[@id="go_Button"]
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					//driver.findElement(By.name("button")).click(); 
					//}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					//*[@id="totPart"]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/p[2]/input[1]      Confirm Yes button

					String DueDate=null;

					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]")).getText();
					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]
					test.log(LogStatus.PASS,"DueDate: " +DueDate );

					String LoanFrequency = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[15]/td/span[2]")).getText();

					if((LoanFrequency).contains("30Days"))
					{
						test.log(LogStatus.PASS,"DueDate should be 30days from Loan date" );
					}
					else
					{
						test.log(LogStatus.PASS,"DueDate should not be 30days from Loan date");
					}
					String CheckStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Check Status is ::"+CheckStatus);

					String LoanStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					test.log(LogStatus.PASS,"Loan Status is ::"+LoanStatus);
				}
			}
			//driver.close();
		}

		public void Sale_morethan_oneloan (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Sale");

					test.log(LogStatus.PASS, "Sale is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");



					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					test.log(LogStatus.PASS, "Clicked on Go Button: ");	



					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");
					driver.findElement(By.name("requestBean.saleValue")).clear();
					driver.findElement(By.name("requestBean.saleValue")).sendKeys("2000");

					test.log(LogStatus.PASS, "SalValue Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Sale is completed successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Sale is not completed successfully.");

					}



				}

			}

		}

		public void Verify_Sold_Waived_History_Loan1(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						//driver.findElement(By.name("button")).click();
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						//   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
/*
					String SoldAmountotherloan = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[6]/td[4]/font")).getText();


					String SoldAmount = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[6]/td[5]/font")).getText();

					if((SoldAmountotherloan).contains("sold"))
					{
						test.log(LogStatus.PASS,"Salvage Amount:" +SoldAmount );
					}
					else
					{
						test.log(LogStatus.PASS,"Salvage Record is not Displayed.");
					}
					*/
				/////////////////////////////////////////////	
					//                                                       //*[@id="transactionDetailsTable"]/tbody/tr[2]/td[4]/font
					List<WebElement> options = driver.findElements(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr"));
					int schsize = options.size();
					test.log(LogStatus.INFO, " Rows count is::"+schsize);	

					for(int i=2; i<=schsize-1; i++)
					{
		                 int j= i-1;
						String TransactionName = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+i+"]/td[4]/font")).getText();
						test.log(LogStatus.INFO, "Transaction:: "+i+"__Name is ::"+TransactionName);	

					
						if(TransactionName.contains("WriteOff"))
						{
							test.log(LogStatus.INFO, "Waived Amount is Effected to the First Loan"+TransactionName);
							int R =i+1;
							String TransactionName1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+R+"]/td[4]/font")).getText();

							
							test.log(LogStatus.INFO, "Transaction:: "+R+"__Name is ::"+TransactionName1);	
							if(TransactionName.contains("Waived"))
							{
								test.log(LogStatus.INFO, "Waived Amount is Effected to the First Loan"+TransactionName);
								//test.log(LogStatus.INFO, "RowNumber is ::"+i);	
			
							
							}
							else
							{
								test.log(LogStatus.FAIL, "Waived Amount is not Effected to the First Loan"+TransactionName);

							}

							//test.log(LogStatus.INFO, "RowNumber is ::"+i);	
		
						
						}
		/*					else
							{
								test.log(LogStatus.INFO, "Transactions Done in First loan are :"+i+TransactionName);	

							}
						*/
					}
////////////////////////////////////////////////revathi
					/*String Waivedrecord  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[4]/font")).getText();
					//*[@id="transactionDetailsTable"]/tbody/tr[8]/td[4]/font


					String WaivedAmt  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[5]/font")).getText();
					//*[@id="transactionDetailsTable"]/tbody/tr[8]/td[5]/font												


					if((Waivedrecord).contains("Write Off Waived"))
					{
						test.log(LogStatus.PASS,"Waived Amount:" +WaivedAmt );

					}

					else
					{
						driver.close();

						WebDriver driver = new InternetExplorerDriver();
						//test.log(LogStatus.PASS,"Waived Record is not Displayed.");
						this.Verify_Sold_Waived_History_Loan2(SSN, FileName);

					}*/
					//   String CheckStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Check Status is ::"+CheckStatus);

					//    String LoanStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Loan Status is ::"+LoanStatus);
				}
			}
		}

		public void Verify_Sold_Waived_History_Loan2(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(3000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						//driver.findElement(By.name("button")).click();
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						//driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						driver.findElement(By.xpath("//*[@id='showMore-2']")).click();

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						//   /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]    
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");



					driver.findElement(By.name("transactionList")).sendKeys("History");
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					
					
					List<WebElement> options = driver.findElements(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr"));
					int schsize = options.size();
					test.log(LogStatus.INFO, " Rows count is::"+schsize);	

					for(int i=2; i<=schsize-1; i++)
					{
		                 int j= i-1;
						String TransactionName = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+i+"]/td[4]/font")).getText();
						test.log(LogStatus.INFO, "Transaction:: "+i+"__Name is ::"+TransactionName);	

					
						if(TransactionName.contains("WriteOff"))
						{
							test.log(LogStatus.INFO, "Waived Amount is Effected to the First Loan"+TransactionName);
							int R =i+1;
							String TransactionName1 = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr["+R+"]/td[4]/font")).getText();

							
							test.log(LogStatus.INFO, "Transaction:: "+R+"__Name is ::"+TransactionName1);	
							if(TransactionName.contains("Waived"))
							{
								test.log(LogStatus.INFO, "Waived Amount is Effected to the Second Loan"+TransactionName);
								//test.log(LogStatus.INFO, "RowNumber is ::"+i);	
			
							
							}
							else
							{
								test.log(LogStatus.FAIL, "Waived Amount is not Effected to the Second Loan"+TransactionName);

							}

							//test.log(LogStatus.INFO, "RowNumber is ::"+i);	
		
						
						}
					}
/*

					String SoldAmountotherloan = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[4]/font")).getText();

					String SoldAmount = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[5]/font")).getText();

					if((SoldAmountotherloan).contains("sold"))
					{
						test.log(LogStatus.PASS,"Sold Amount:" +SoldAmount );
					}
					else
					{
						test.log(LogStatus.PASS,"Sold Record is not Displayed.");
					}
*/
					/*String Waivedrecord  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[7]/td[4]/font")).getText();


				String WaivedAmt  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[7]/td[5]/font")).getText();



			if((Waivedrecord).contains("Write Off Waived"))
			{
				test.log(LogStatus.PASS,"Salvage Amount:" +WaivedAmt );
			}
			else
			{
				test.log(LogStatus.PASS,"Waived Record is not Displayed.");
			}*/
					//   String CheckStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[3]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Check Status is ::"+CheckStatus);

					//    String LoanStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					//    test.log(LogStatus.PASS,"Loan Status is ::"+LoanStatus);
				}
			}
		}

		

		public void Verify_Waived_History(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();

					}

					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");

					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					String WriteoffWaived  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[4]/font")).getText();
					String WaivedAmount  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[5]/font")).getText();
					
					if((WriteoffWaived).contains("Write Off Waived"))
					{
						test.log(LogStatus.PASS,"Write Off Waived :" +WriteoffWaived );
						
						test.log(LogStatus.PASS,"Write Off Waived Amount:" +WaivedAmount );
					}
					else
					{
						test.log(LogStatus.PASS,"Write Off Waived Record is not Displayed.");
					}
				}
			}

		}

		public void NewLoan_BlackBookValue (String SSN,String FileName) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);            
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";             
			for(int row=2;row<=lastrow;row++)
			{       
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{               
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);

					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);

					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);                   
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String Parent_Window = driver.getWindowHandle();

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}                       
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
					{

						if(ProductID.equals("TLP"))                                                     
						{                                       
							System.out.println("IN TLP");

							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							test.log(LogStatus.PASS, "Enter Vehicle Type: " +VehicleType);


							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");

							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN); 
							test.log(LogStatus.PASS, "Enter VIN Number: " +NewVIN);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
							test.log(LogStatus.PASS, "Enter VIN Number: " +NewVIN);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							test.log(LogStatus.PASS, "Click Continue button");
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("2000");
							test.log(LogStatus.PASS, "Enter Miles value:2000");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();
							test.log(LogStatus.PASS, "Click BlackBook");

							String blackbook = driver.findElement(By.xpath("//*[@id='tableWid11']/tbody/tr[2]/td ")).getText(); 
							test.log(LogStatus.PASS, "LoanAmount As per BlackBook: " +blackbook); 
						}
					}
				}
			}
		}

		public void Payment_PartialAmount (String SSN,String FileName) throws Exception{		


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";
			for(int row=2;row<=lastrow;row++)
			{
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName, Password, StoreId);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Payment");
					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();
						test.log(LogStatus.PASS, "Click on GO Button");
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}


					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish  Loan button ");
						try {
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Payment is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Payment Loan is not Completed Successfully ");
						}


					}
					if(ProductID.equals("PDL"))
					{
						if(ESign_DisbType.equals("Check")){
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						}
						if(ESign_DisbType.equals("Cash")){
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
						}
						if((ESign_DisbType.equals("Cash")||(ESign_DisbType.equals("Check")))&&((ESign_DisbType2.equals("Check"))||(ESign_DisbType.equals("Cash")) ))
						{
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("TenderType");
						}
						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@id='PD5']")).click();
						test.log(LogStatus.PASS, " Click pay any other amt Type ");

						driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys("50");
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");
						test.log(LogStatus.PASS, "tenderType  as Cash ");
						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys("50");

					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish Payament Loan button ");
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
					} 
					Thread.sleep(2000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[2]")).click();

					test.log(LogStatus.PASS, "Clicked On NO Button in Renew PopUp ");



					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{
							test.log(LogStatus.PASS, "Partial Payment is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Partial Payment is not Completed Successfully ");
						}

					}
				}
			}
		}

		public void Payment_1stInterestAmt_on2ndinstduration (String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{




					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String Password = TestData.getCellData(sheetName,"Password",row);



					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);



					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);




					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{




						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}


					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String PrincipleAmt=null;



					PrincipleAmt = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[2]/td[4]")).getText();


					test.log(LogStatus.PASS, "Interest Amount is:: "+PrincipleAmt);


					System.out.print(PrincipleAmt); 




					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);



					Thread.sleep(4000);

					driver.switchTo().defaultContent();

					WebDriverWait wait = new WebDriverWait(driver, 30);

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));

					driver.findElement(By.cssSelector("li[id='910000']")).click();



					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					Thread.sleep(1000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					Thread.sleep(5000);


					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Payment");

					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");


					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}



					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("//*[@id='PD5']")).click();
						test.log(LogStatus.PASS, " Click pay Other amt Type ");

						driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys(PrincipleAmt);
						test.log(LogStatus.PASS, "Payment Amount is:: "+PrincipleAmt);
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");

						test.log(LogStatus.PASS, "tenderType as Cash ");

						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(PrincipleAmt);
						test.log(LogStatus.PASS, "Tender Amount is:: "+PrincipleAmt);
					}


					if(ProductID.equals("TLP"))

					{



						driver.findElement(By.name("requestBean.password")).sendKeys(Password);

						driver.findElement(By.name("finish")).click();

						test.log(LogStatus.PASS, "Password is selected as "+Password);

						driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[2]")).click();
						test.log(LogStatus.PASS, "Click on NO for Renewal Amount ");

					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, " Payment is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, " Payment is not Completed Successfully ");

						}

					}

				}

			}

		}

		public void Renewal_Status1(String SSN,String FileName) throws Exception{

			//String FileName= "AA_TwoLoans_OneVIN_OneDefault_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);    
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";             
			for(int row=2;row<=lastrow;row++)
			{       
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);   
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					test.log(LogStatus.INFO, "RPP(Starts)");

					System.out.println(ProductID);  
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreID, driver, AppURL, test);
					//this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);

					Thread.sleep(5000);
					Thread.sleep(1000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();                      
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					test.log(LogStatus.INFO,"Navigated To Loan Transaction Screen");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();                  
					test.log(LogStatus.PASS, "Clicked on Transactions");            
					driver.switchTo().frame("main");        
					test.log(LogStatus.INFO,"Navigate to Transactions Screen");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");     

					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Customer Record Screen");

					//driver.findElement(By.name("button")).click();
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}                                   
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Line Of Credit History Screen");





					//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}                       
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Transaction List Screen");

					driver.findElement(By.name("transactionList")).sendKeys("History");
					test.log(LogStatus.INFO,"Navigate to History Credit Table Screen");

					driver.findElement(By.name("button")).click();
					test.log(LogStatus.INFO,"Transaqction Selection Go Button Click");

					//button
					String CheckStatus=null;                       
					CheckStatus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[18]/td/span[2]")).getText();
					if(CheckStatus.equals("N")){
						test.log(LogStatus.PASS,"Is Loan Renewal status : "+CheckStatus);
						test.log(LogStatus.INFO,"Renewal Transaction Done Successfully");
						System.out.print(CheckStatus);  

					}
					else
					{
						test.log(LogStatus.PASS,"Is Loan in Renewal : "+CheckStatus);
						test.log(LogStatus.INFO,"Renewal Transaction is faild");
						System.out.print(CheckStatus);
					}


				}       

			}


		}

		public void Loan_1stinstallment_status(String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					test.log(LogStatus.INFO, "Renewal Status(Starts)");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreID, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);

					Thread.sleep(5000);
					Thread.sleep(1000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					test.log(LogStatus.INFO,"Navigated To Loan Transaction Screen");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");	
					test.log(LogStatus.INFO,"Navigate to Transactions Screen");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");	

					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Customer Record Screen");

					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Line Of Credit History Screen");





					//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Transaction List Screen");

					driver.findElement(By.name("transactionList")).sendKeys("History");
					test.log(LogStatus.INFO,"Navigate to History Credit Table Screen");

					driver.findElement(By.name("button")).click();
					test.log(LogStatus.INFO,"Transaction Selection Go Button Click");


					String payment=null;
					String Interest=null;
					payment = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[5]/font")).getText();
					test.log(LogStatus.PASS, " for 1st Instment Payment::"+payment);

					Interest = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[5]/td[5]/font")).getText();
					test.log(LogStatus.PASS, "1st Instment  Payment::"+Interest);
					test.log(LogStatus.PASS, "1st Instment  Payment is Completed Sucessfully");


				}
			}
		}

		public void AgeStore_1stInst_ONDueDate(String SSN,String FileName,int Days) throws Exception

		{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan"; 

			for(int row=2;row<=lastrow;row++)

			{ 

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row); 

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);




					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{




						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;



					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]")).getText();


					test.log(LogStatus.PASS, "Capture DueDate"+DueDate);


					System.out.print(DueDate); 

					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);



					DateFormat df=new SimpleDateFormat("MM/dd/yyyy"); 

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin"); 

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password); 


					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);



					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS); 

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);




					String DDueDate[] =DueDate.split("/");


					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];




					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					driver.findElement(By.name("storeCode")).click();


					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{ 

						test.log(LogStatus.PASS, "Process Date updated successfully");

						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date not updated successfully.");

					}
				}

			}

		}

		public void LESS_Salvage (String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					//String SecondLoanStatus=null;

					DefaultDate = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[3]")).getText();

					test.log(LogStatus.PASS,"DefaultDate::  "+DefaultDate);

					//SecondLoanStatus = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[6]")).getText();

					//test.log(LogStatus.PASS,"Second Loan Status::  "+SecondLoanStatus);


					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					//storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(4000);

					Date DDueDate = df.parse(DefaultDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					
					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Title Loan")).click();

					test.log(LogStatus.PASS, "Clicked on Title Loan");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Post Default Transactions")).click();

					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					//driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");

					driver.findElement(By.name("requestBean.statusType")).sendKeys("Salvage");

					test.log(LogStatus.PASS, "Salvage is entered: ");

					driver.findElement(By.name("submit")).click();

					test.log(LogStatus.PASS, "Clicked on submitt Button: ");

					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();


					test.log(LogStatus.PASS, "Clicked on Go Button: ");	

					WebElement SalvageCmp = driver.findElement(By.xpath("//*[@id='solvageCompany']"));

					SalvageCmp.sendKeys("Salvage Company220");

					test.log(LogStatus.PASS, "Salvage Company220 is selected from dropdown");	

					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");

					driver.findElement(By.name("requestBean.salvageValue")).clear();
					driver.findElement(By.name("requestBean.salvageValue")).sendKeys("400");
					test.log(LogStatus.PASS, "Salvage value is Entered");

					driver.findElement(By.xpath("/html/body/table/tbody/tr/td/table[3]/tbody/tr[5]/td[3]/textarea")).sendKeys("Comments");


					test.log(LogStatus.PASS, "Comments are Entered");


					Thread.sleep(5000);

					//driver.findElement(By.name("requestBean.password")).sendKeys(Password);

					//test.log(LogStatus.PASS, "Password Entered");

					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())

					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Salvage is completed successfully.");
					}

					else

					{

						test.log(LogStatus.FAIL, "Salvage is not completed successfully.");

					}



				}

			}

		}

		public void AgeStore_Default_WriteOff60Days(String SSN,String FileName,int Days) throws Exception

		{



			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);





					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");



					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					if(ProductID.equals("TLP"))

					{




						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}


					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click();

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;





					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[7]/td/span[2]")).getText();



					test.log(LogStatus.PASS, "Capture DefaultDate"+DueDate);


					System.out.print(DueDate);

					driver.close();



					driver = new InternetExplorerDriver();

					driver.get(AdminURL);



					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);


					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);




					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);



					String DDueDate[] =DueDate.split("/");


					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];


					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");



					driver.findElement(By.name("storeCode")).click();


					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date not updated successfully.");

					}


					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();	
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					Thread.sleep(5000);
					driver.findElement(By.linkText("EOD Batch Process")).click();
					test.log(LogStatus.PASS, "Clicked on EOD Batch Process");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.storeCode")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					driver.findElement(By.name("beginMonth")).clear();
					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 
					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);
					driver.findElement(By.name("beginDay")).clear();
					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);
					driver.findElement(By.name("beginYear")).clear();
					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);
					driver.findElement(By.name("submit")).click();
					test.log(LogStatus.PASS, "Clicked on submit button");
					test.log(LogStatus.INFO, "EOD Batch Process Completed");




				}

			}

		}

		public void WO_Recovery (String SSN,String FileName) throws Exception{		


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";
			for(int row=2;row<=lastrow;row++)
			{
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					//  String Password = TestData.getCellData(sheetName,"Password",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName, Password, StoreId);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("WO Recovery");
					test.log(LogStatus.PASS, "Transaction Type is selected as WO Recovery ");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();
						test.log(LogStatus.PASS, "Click on GO Button");
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}


					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						String woamt=null;
						woamt=driver.findElement(By.name("transactionDataBean.amtOwed")).getAttribute("value");
						driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
						test.log(LogStatus.PASS, "tenderType  as Cash ");
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(woamt);
						test.log(LogStatus.PASS, "tender Amount as::"+woamt);

					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish Payament Loan button ");
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish Wo Recovery button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}


						if(driver.findElement(By.name("Ok")).isDisplayed())

						{
							test.log(LogStatus.PASS, " Wo Recovery is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, " Wo Recovery is not Completed Successfully ");
						}

					}
				}
			}
		}

		public void WAVE_Stastus1(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String WaveStatus=null;

					WaveStatus = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[7]/td[5]/font")).getText();

					test.log(LogStatus.PASS,"Waived of Amount:: "+WaveStatus);
					System.out.print(WaveStatus);	

					driver.close();
					driver = new InternetExplorerDriver();

				}
			}
		}
		public void WAVE_Stastus2(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						//*[@id="showMore-2"]
						driver.findElement(By.xpath("//*[@id='showMore-2']")).click();


						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String WaveStatus=null;

					WaveStatus = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[7]/td[5]/font")).getText();

					test.log(LogStatus.PASS,"Waived of Amount:: "+WaveStatus);
					System.out.print(WaveStatus);	

					driver.close();
					driver = new InternetExplorerDriver();

				}
			}
		}

		public void WO_Void(String SSN,String FileName) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();	
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();	
					driver.switchTo().defaultContent();				
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@name='button' and @value='Go']")).click();
					}

					Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Void");
					test.log(LogStatus.PASS, "Transaction Type is selected as Void");	
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("button")).click(); 
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
						try { 
							Alert alert = driver.switchTo().alert();
							alert.accept();

						}
						catch (NoAlertPresentException e) {
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}			
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}


					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.disbursementType")).sendKeys("Cash");
						test.log(LogStatus.PASS, "disbursementType :: Cash");

					}
					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys("Cash");
					}
					if(ProductID.equals("PDL"))
					{

						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
					}
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);																					
						test.log(LogStatus.PASS, "Clicked on Finish Void Loan button ");
					}		


					try { 
						Alert alert = driver.switchTo().alert();
						alert.accept();

					}
					catch (NoAlertPresentException e) {
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{

						if(driver.findElement(By.name("Ok")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
					if(ProductID.equals("PDL"))
					{

						if(driver.findElement(By.name("checkyes")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Void Loan is Completed Successfully ");
							driver.findElement(By.name("checkyes")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Void Loan is not Completed Successfully ");
						}
					}
				}

			}
		}

		public void Biweek_due_RegistrationPage(String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("Borrower_Registration");

			String sheetName="Borrower_Registration";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{



					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String LastName = TestData.getCellData(sheetName,"LastName",row);

					String FirstName = TestData.getCellData(sheetName,"FirstName",row);

					String AddressLine = TestData.getCellData(sheetName,"AddressLine",row);

					String City = TestData.getCellData(sheetName,"City",row);

					String State = TestData.getCellData(sheetName,"State",row);

					String ZipCode = TestData.getCellData(sheetName,"ZipCode",row);

					String MonthsAtAddress = TestData.getCellData(sheetName,"MonthsAtAddress",row);

					String Bank_ABARoutingNbr = TestData.getCellData(sheetName,"Bank_ABARoutingNbr",row);

					String Bank_ChkgAcctNbr = TestData.getCellData(sheetName,"Bank_ChkgAcctNbr",row);

					String Ctc_PrimaryPhone = TestData.getCellData(sheetName,"Ctc_PrimaryPhone",row);

					String Ctc_PhoneType = TestData.getCellData(sheetName,"Ctc_PhoneType",row);

					String Misc_PhotoIDNbr = TestData.getCellData(sheetName,"Misc_PhotoIDNbr",row);

					String Misc_IDExpDate = TestData.getCellData(sheetName,"Misc_IDExpDate",row);

					String Misc_PhotoIDType = TestData.getCellData(sheetName,"Misc_PhotoIDType",row);

					String BorrDOB = TestData.getCellData(sheetName,"Misc_DOB",row);

					String Income_IncomeType = TestData.getCellData(sheetName,"Income_IncomeType",row);

					String Income_Employer = TestData.getCellData(sheetName,"Income_Employer",row);

					String Income_WorkPhone = TestData.getCellData(sheetName,"Income_WorkPhone",row);

					String Income_NetIncomeAmt = TestData.getCellData(sheetName,"Income_NetIncomeAmt",row);

					String Income_GrossIncome = TestData.getCellData(sheetName,"Income_GrossIncome",row);

					String Income_PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);

					String Income_HireDt = TestData.getCellData(sheetName,"Income_HireDt",row);

					String Income_DirectDeposit=TestData.getCellData(sheetName,"Income_DirectDeposit",row);

					String ProductType=TestData.getCellData(sheetName,"ProductType",row);

					/* String PrimaryRef_LastName = TestData.getCellData(sheetName,"PrimaryRef_LastName",row);

	   String PrimaryRef_FirstName = TestData.getCellData(sheetName,"PrimaryRef_FirstName",row);

	   String PrimaryRef_Relationship = TestData.getCellData(sheetName,"PrimaryRef_Relationship",row);

	   String PrimaryRef_PhoneNbr=TestData.getCellData(sheetName,"PrimaryRef_PhoneNbr",row);

	   String Ref_LastName = TestData.getCellData(sheetName,"Ref_LastName",row);

	   String Ref_FirstName = TestData.getCellData(sheetName,"Ref_FirstName",row);

	   String Ref_Relationship = TestData.getCellData(sheetName,"Ref_Relationship",row);

	   String Ref_PhoneNbr=TestData.getCellData(sheetName,"Ref_PhoneNbr",row);*/

					String Bankruptcy=TestData.getCellData(sheetName,"Bankruptcy",row);

					test.log(LogStatus.INFO, "Borrower Registration-SSN: " +SSN);

					DateFormat  df=new SimpleDateFormat("MM/dd/yyyy");

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					String PP1 = Ctc_PrimaryPhone.substring(0, 3);

					String PP2 = Ctc_PrimaryPhone.substring(3, 6);

					String PP3 = Ctc_PrimaryPhone.substring(6, 10);

					String IncomeP1 = Income_WorkPhone.substring(0, 3);

					String IncomeP2 = Income_WorkPhone.substring(3, 6);

					String IncomeP3 = Income_WorkPhone.substring(6, 10);

					/*  String PrimaryRef_PhoneNbr1 = PrimaryRef_PhoneNbr.substring(0, 3);

	                    String PrimaryRef_PhoneNbr2 = PrimaryRef_PhoneNbr.substring(3, 6);

	                    String PrimaryRef_PhoneNbr3 = PrimaryRef_PhoneNbr.substring(6, 10);

	                    String Ref_PhoneNbr1 = Ref_PhoneNbr.substring(0, 3);

	                    String Ref_PhoneNbr2 = Ref_PhoneNbr.substring(3, 6);

	                    String Ref_PhoneNbr3 = Ref_PhoneNbr.substring(6, 10);*/

					System.out.println(Misc_IDExpDate);

					Date Misc_IDExpDt = df.parse(Misc_IDExpDate);

					String IDExpDate0 =df.format(Misc_IDExpDt);

					System.out.println(IDExpDate0);

					String IDExpDate[] =IDExpDate0.split("/");

					String IDExpD1 = IDExpDate[0];

					String IDExpD2 = IDExpDate[1];

					String IDExpD3 = IDExpDate[2];

					String DOB[] =BorrDOB.split("/");

					String DOB1 = DOB[0];

					String DOB2 = DOB[1];

					String DOB3 = DOB[2];

					appUrl = AppURL;

					//  this.Login(UserName, Password, StoreId);

					//driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					Thread.sleep(5000);

					// driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					WebDriverWait wait = new WebDriverWait(driver, 30);

					//wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					//wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					//WebElement  ele = driver.findElement(By.name("topFrame"));

					//new Actions(driver).moveToElement(ele).perform();



					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='900000']")));

					driver.findElement(By.cssSelector("li[id='900000']")).click();

					//driver.findElement(By.xpath("//*[contains(text(),'Borrower')]")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					//driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.cssSelector("li[id='901000']")));

					driver.findElement(By.cssSelector("li[id='901000']")).click();

					test.log(LogStatus.PASS, "Clicked on Registration");

					driver.switchTo().frame("main");

					driver.findElement(By.name("customerBean.custProdType")).sendKeys(ProductType);

					test.log(LogStatus.PASS, "ProductType is entered: "+ProductType);

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("ssn4")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "Confirm SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn5")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "Confirm SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn6")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "Confirm SSN3 is entered: "+SSN3);

					driver.findElement(By.name("customerBean.lastNm")).sendKeys(LastName);

					test.log(LogStatus.PASS, "LastName is entered: "+LastName);

					driver.findElement(By.name("customerBean.firstNm")).sendKeys(FirstName);

					test.log(LogStatus.PASS, "FirstName is entered: "+FirstName);

					driver.findElement(By.name("customerBean.mailingAddressLn1")).sendKeys(AddressLine);
					test.log(LogStatus.PASS, "AddressLine is entered: "+AddressLine);
					driver.findElement(By.name("customerBean.mailingCity")).sendKeys(City);
					test.log(LogStatus.PASS, "City is entered: "+City);
					driver.findElement(By.name("customerBean.mailingStateCd")).sendKeys(State);
					test.log(LogStatus.PASS, "State is entered: "+State);
					driver.findElement(By.name("customerBean.mailingPostalCd")).sendKeys(ZipCode);
					test.log(LogStatus.PASS, "ZipCode is entered: "+ZipCode);
					driver.findElement(By.name("customerBean.sameMailAddress")).click();
					test.log(LogStatus.PASS, "Mailing address is selected as same as above");
					driver.findElement(By.name("customerBean.monthsAtAddress")).sendKeys(MonthsAtAddress);
					test.log(LogStatus.PASS, "MonthsAtAddress is entered: "+MonthsAtAddress);			
					driver.findElement(By.name("customerBean.rentOwnFlg")).sendKeys("Yes");
					test.log(LogStatus.PASS, "Own Residence?* is entered: Yes");
					driver.findElement(By.name("phoneNbr1")).sendKeys(PP1);

					test.log(LogStatus.PASS, "PP1 is entered: "+PP1);

					driver.findElement(By.name("phoneNbr2")).sendKeys(PP2);

					test.log(LogStatus.PASS, "PP2 is entered: "+PP2);

					driver.findElement(By.name("phoneNbr3")).sendKeys(PP3);

					test.log(LogStatus.PASS, "PP3 is entered: "+PP3);

					//driver.findElement(By.name("phoneNbr3"))(PP3);

					//test.log(LogStatus.PASS, "PP3 is entered: "+PP3);

					Select PhoneType  = new Select(driver.findElement(By.name("customerBean.phoneCd")));

					PhoneType.selectByVisibleText(Ctc_PhoneType);

					test.log(LogStatus.PASS, "Phone Type is selected as: "+Ctc_PhoneType);

					driver.findElement(By.name("sphoneNbr1")).sendKeys(PP1);

					test.log(LogStatus.PASS, "SPP1 is entered: "+PP1);

					driver.findElement(By.name("sphoneNbr2")).sendKeys(PP1);

					test.log(LogStatus.PASS, "SPP2 is entered: "+PP1);

					driver.findElement(By.name("sphoneNbr3")).sendKeys(PP3);

					test.log(LogStatus.PASS, "SPP3 is entered: "+PP3);

					//driver.findElement(By.name("phoneNbr3"))(PP3);

					//test.log(LogStatus.PASS, "PP3 is entered: "+PP3);

					Select SubPhoneType  = new Select(driver.findElement(By.name("customerBean.cphoneCd")));

					SubPhoneType.selectByVisibleText(Ctc_PhoneType);

					test.log(LogStatus.PASS, "Secondary Phone Type is selected as: "+Ctc_PhoneType);

					driver.findElement(By.name("customerBean.isCustomerEmailQuest")).click();

					test.log(LogStatus.PASS, "Does not have e-mail selected");

					driver.findElement(By.name("customerBean.driversLicNbr")).sendKeys(Misc_PhotoIDNbr);

					test.log(LogStatus.PASS, "PhotoIDNbr is entered: "+Misc_PhotoIDNbr);

					driver.findElement(By.name("customerBean.driversLicSt")).sendKeys(State);

					test.log(LogStatus.PASS, "ID State is entered: "+State);

					driver.findElement(By.name("dlexpiry1")).sendKeys(IDExpD1);

					test.log(LogStatus.PASS, "ID Expiration Date1 is entered: "+IDExpD1);

					driver.findElement(By.name("dlexpiry2")).sendKeys(IDExpD2);

					test.log(LogStatus.PASS, "ID Expiration Date1 is entered: "+IDExpD2);

					driver.findElement(By.name("dlexpiry3")).sendKeys(IDExpD3);

					test.log(LogStatus.PASS, "ID Expiration Date1 is entered: "+IDExpD3);

					driver.findElement(By.name("customerBean.photoIdType")).sendKeys(Misc_PhotoIDType);

					test.log(LogStatus.PASS, "PhotoIDType is entered: "+Misc_PhotoIDType);

					driver.findElement(By.name("customerBean.drivingZipcode")).sendKeys(ZipCode);

					test.log(LogStatus.PASS, "ZipCode is entered: "+ZipCode);

					driver.findElement(By.name("dob1")).sendKeys(DOB1);

					test.log(LogStatus.PASS, "DOB1 Date1 is entered: "+DOB1);

					driver.findElement(By.name("dob2")).sendKeys(DOB2);

					test.log(LogStatus.PASS, "DOB3 is entered: "+DOB2);

					driver.findElement(By.name("dob3")).sendKeys(DOB3);

					test.log(LogStatus.PASS, "DOB3 is entered: "+DOB3);               
					driver.findElement(By.name("customerBean.eyeColor")).sendKeys("Black");
					test.log(LogStatus.PASS, "Eye Color is entered: Black");
					driver.findElement(By.name("customerBean.feet")).sendKeys("5");
					test.log(LogStatus.PASS, "Height is entered: 5");
					driver.findElement(By.name("customerBean.inches")).sendKeys("5");
					test.log(LogStatus.PASS, "Inches is entered: 5");



					driver.findElement(By.name("customerBean.incomeCdDisp")).sendKeys(Income_IncomeType);

					test.log(LogStatus.PASS, "IncomeType is entered: "+Income_IncomeType);

					driver.findElement(By.name("customerBean.empNmDisp")).sendKeys(Income_Employer);

					test.log(LogStatus.PASS, "Employer is entered: "+Income_Employer);

					driver.findElement(By.name("workPhoneNbrDisp1")).sendKeys(IncomeP1);

					test.log(LogStatus.PASS, "PP1 is entered: "+IncomeP1);

					driver.findElement(By.name("workPhoneNbrDisp2")).sendKeys(IncomeP2);

					test.log(LogStatus.PASS, "PP2 is entered: "+IncomeP2);

					driver.findElement(By.name("workPhoneNbrDisp3")).sendKeys(IncomeP3);

					test.log(LogStatus.PASS, "PP3 is entered: "+IncomeP3);

					driver.findElement(By.name("customerBean.incomeAmtDisp")).sendKeys(Income_NetIncomeAmt);

					test.log(LogStatus.PASS, "Income_NetIncomeAmt is entered: "+Income_NetIncomeAmt);

					driver.findElement(By.name("customerBean.grossAmtDisp")).sendKeys(Income_GrossIncome);

					test.log(LogStatus.PASS, "Income_GrossIncome is entered: "+Income_GrossIncome);

					driver.findElement(By.name("customerBean.payFreqCdDisp")).sendKeys(Income_PayFrequency);

					test.log(LogStatus.PASS, "Income_PayFrequency is entered: "+Income_PayFrequency);

					String Parent_Window = driver.getWindowHandle();

					if(Income_PayFrequency.equals("Monthly"))

					{

						driver.findElement(By.name("customerBean.monthlyDate")).sendKeys("1st");

						test.log(LogStatus.PASS, "Monthly PayFrequency Selected");
					}


					if (Income_PayFrequency.equals("Weekly"))
					{
						driver.findElement(By.id("rad_wk2")).click();

						test.log(LogStatus.PASS, "Weekly PayFrequency Selected");

					}                               	


					if(Income_PayFrequency.equals("Semi-Monthly"))

					{

						driver.findElement(By.id("rad_semi1")).click();

						test.log(LogStatus.PASS, "SemiMonthly PayFrequency Selected");

					}


					if(Income_PayFrequency.equals("Bi-Weekly"))

					{

						driver.findElement(By.id("rad_wk4")).click();

						test.log(LogStatus.PASS, "Wednesday is selected");

						driver.findElement(By.id("biwksndid")).click();

						test.log(LogStatus.PASS, "BiWeekly PayFrequency Selected");

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("bottom");

					String  BusinessDt= driver.findElement(By.xpath("/html/body/blink/table/tbody/tr/td[4]")).getText();

					String Busdate[]=BusinessDt.split(":");

					String date = Busdate[1];



					Date d1 = df.parse(date);

					Calendar cal = Calendar.getInstance();

					cal.setTime(d1);

					cal.add(Calendar.DATE, -20);

					Date PayStubReviewedDate1= cal.getTime();



					String PayStubReviewedDate =df.format(PayStubReviewedDate1);

					//Date D=Add(date1,7);

					//System.out.println(date);



					//System.out.println(PayStubReviewedDate);



					String PayStubReviewedDate0[] =PayStubReviewedDate.split("/");

					String PayStubReviewedDate2 = PayStubReviewedDate0[0];

					String PayStubReviewedDate3 = PayStubReviewedDate0[1];

					String PayStubReviewedDate4 = PayStubReviewedDate0[2];

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("payStubReviewed1")).sendKeys(PayStubReviewedDate2);

					test.log(LogStatus.PASS, "PayStubReviewed1 is entered: "+PayStubReviewedDate2);

					driver.findElement(By.name("payStubReviewed2")).sendKeys(PayStubReviewedDate3);

					test.log(LogStatus.PASS, "PayStubReviewed2 is entered: "+PayStubReviewedDate3);

					driver.findElement(By.name("payStubReviewed3")).sendKeys(PayStubReviewedDate4);

					test.log(LogStatus.PASS, "PayStubReviewed3 is entered: "+PayStubReviewedDate4);



					cal.add(Calendar.DATE, -30);

					Date PayStubDate1= cal.getTime();



					String PayStubDate =df.format(PayStubDate1);

					//Date D=Add(date1,7);

					//System.out.println(date);



					//System.out.println(PayStubReviewedDate);



					String PayStubDate0[] =PayStubDate.split("/");

					String PayStubDate2 = PayStubDate0[0];

					String PayStubDate3 = PayStubDate0[1];

					String PayStubDate4 = PayStubDate0[2];

					driver.findElement(By.name("payStubDate1")).sendKeys(PayStubDate2);

					test.log(LogStatus.PASS, "payStubDate1 is entered: "+PayStubDate2);

					driver.findElement(By.name("payStubDate2")).sendKeys(PayStubDate3);

					test.log(LogStatus.PASS, "payStubDate2 is entered: "+PayStubDate3);

					driver.findElement(By.name("payStubDate3")).sendKeys(PayStubDate4);

					test.log(LogStatus.PASS, "payStubDate3 is entered: "+PayStubDate4);



					String Income_HireDt0[] =Income_HireDt.split("/");

					String Income_HireDt1 = Income_HireDt0[0];

					String Income_HireDt2 = Income_HireDt0[1];

					String Income_HireDt3 = Income_HireDt0[2];



					driver.findElement(By.name("hireDate1")).sendKeys(Income_HireDt1);

					test.log(LogStatus.PASS, "hireDate1 is entered: "+Income_HireDt1);

					driver.findElement(By.name("hireDate2")).sendKeys(Income_HireDt2);

					test.log(LogStatus.PASS, "hireDate2 is entered: "+Income_HireDt2);

					driver.findElement(By.name("hireDate3")).sendKeys(Income_HireDt3);

					test.log(LogStatus.PASS, "hireDate3 is entered: "+Income_HireDt3);



					driver.findElement(By.name("customerBean.directDeposit")).sendKeys(Income_DirectDeposit);

					test.log(LogStatus.PASS, "DirectDeposit is entered: "+Income_DirectDeposit);

					cal.add(Calendar.DATE, -60);

					Date Bank_AcctVerificationDt0= cal.getTime();



					String Bank_AcctVerificationDt =df.format(Bank_AcctVerificationDt0);

					String Bank_AcctVerificationDt1[] =Bank_AcctVerificationDt.split("/");

					String Bank_AcctVerificationDt2 = Bank_AcctVerificationDt1[0];

					String Bank_AcctVerificationDt3 = Bank_AcctVerificationDt1[1];

					String Bank_AcctVerificationDt4 = Bank_AcctVerificationDt1[2];

					driver.findElement(By.name("statementEndDtDisp1")).sendKeys(Bank_AcctVerificationDt2);

					test.log(LogStatus.PASS, "Bank_AcctVerificationDt1 is entered: "+Bank_AcctVerificationDt2);

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.name("statementEndDtDisp2")).sendKeys(Bank_AcctVerificationDt3);

					test.log(LogStatus.PASS, "Bank_AcctVerificationDt2 is entered: "+Bank_AcctVerificationDt3);

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.name("statementEndDtDisp3")).sendKeys(Bank_AcctVerificationDt4);

					test.log(LogStatus.PASS, "Bank_AcctVerificationDt3 is entered: "+Bank_AcctVerificationDt4);



					//driver.findElement(By.name("customerBean.abaNbrDisp")).sendKeys(Bank_ABARoutingNbr);

					//driver.findElement(By.name("phoneNbr3"))(PP3);

					//test.log(LogStatus.PASS, "PP3 is entered: "+PP3);

					driver.findElement(By.name("customerBean.abaNbrDisp")).sendKeys(Bank_ABARoutingNbr);

					test.log(LogStatus.PASS, "Bank_ABARoutingNbr is entered: "+Bank_ABARoutingNbr);

					driver.findElement(By.name("checkAbaNbrDisp")).sendKeys(Bank_ABARoutingNbr);

					test.log(LogStatus.PASS, "Confirm ABA/Routing Nbr is entered: "+Bank_ABARoutingNbr);

					driver.findElement(By.name("customerBean.accountNbrDisp")).sendKeys(Bank_ChkgAcctNbr);

					test.log(LogStatus.PASS, "Chkg Acct Nbr is entered: "+Bank_ChkgAcctNbr);

					driver.findElement(By.name("checkAccountNbrDisp")).sendKeys(Bank_ChkgAcctNbr);

					test.log(LogStatus.PASS, "Confirm Chkg Acct Nbr is entered: "+Bank_ChkgAcctNbr);

					//driver.findElement(By.name("customerBean.drivingZipcode")).sendKeys(Bank_ChkgAcctNbr);

					//test.log(LogStatus.PASS, "drivingZipcode is entered: "+MiscZipCode);



					/*//Primary Reference Details





	                    //driver.findElement(By.name("customerBean.contName")).sendKeys(PrimaryRef_LastName);

	                    //test.log(LogStatus.PASS, "PRLast Name is entered: "+PrimaryRef_LastName);

	            //      driver.findElement(By.name("customerBean.contactFirstName")).sendKeys(PrimaryRef_FirstName);

	            //      test.log(LogStatus.PASS, "PRFirst Name is entered: "+PrimaryRef_FirstName);



	            //driver.findElement(By.name("customerBean.contName")).sendKeys(PrimaryRef_LastName);

	                    driver.findElement(By.name("customerBean.contactrelationDisp")).sendKeys(PrimaryRef_Relationship);

	                    test.log(LogStatus.PASS, "Contactrelation is entered: "+PrimaryRef_Relationship);

	                    driver.findElement(By.name("cphoneNbrDisp1")).sendKeys(PrimaryRef_PhoneNbr1);

	                    test.log(LogStatus.PASS, "PrimaryReference Phone Nbr1 is entered: "+PrimaryRef_PhoneNbr1);

	                    driver.findElement(By.name("cphoneNbrDisp2")).sendKeys(PrimaryRef_PhoneNbr2);

	                    test.log(LogStatus.PASS, "PrimaryReference Phone Nbr1 is entered: "+PrimaryRef_PhoneNbr2);

	                    driver.findElement(By.name("cphoneNbrDisp3")).sendKeys(PrimaryRef_PhoneNbr3);

	                    test.log(LogStatus.PASS, "PrimaryReference Phone Nbr1 is entered: "+PrimaryRef_PhoneNbr3);



	            // Reference Details





	                    driver.findElement(By.name("customerBean.nameDispSummary")).sendKeys(Ref_LastName);

	                    test.log(LogStatus.PASS, "RLast Name is entered: "+Ref_LastName);

	                    driver.findElement(By.name("customerBean.referenceFirstNameSummary")).sendKeys(Ref_FirstName);

	                    test.log(LogStatus.PASS, "RFirst Name is entered: "+Ref_FirstName);



	                    //driver.findElement(By.name("customerBean.contName")).sendKeys(Ref_LastName);

	                    //test.log(LogStatus.PASS, "PRLast Name is entered: "+Ref_LastName);

	                     driver.findElement(By.name("customerBean.relationDispSummary")).sendKeys(Ref_Relationship);

	                     test.log(LogStatus.PASS, "reference relation is entered: "+Ref_Relationship);

	                     driver.findElement(By.name("refPhoneNbr1")).sendKeys(Ref_PhoneNbr1);

	                     test.log(LogStatus.PASS, "Reference Phone Nbr1 is entered: "+Ref_PhoneNbr1);

	                     driver.findElement(By.name("refPhoneNbr2")).sendKeys(Ref_PhoneNbr2);

	                     test.log(LogStatus.PASS, "Reference Phone Nbr1 is entered: "+Ref_PhoneNbr2);

	                     driver.findElement(By.name("refPhoneNbr3")).sendKeys(Ref_PhoneNbr3);

	                     test.log(LogStatus.PASS, "Reference Phone Nbr1 is entered: "+Ref_PhoneNbr3);

	                     driver.findElement(By.name("bt_Reference")).click();

	                     test.log(LogStatus.PASS, "Clicked on ADD Reference");

					 */

					driver.findElement(By.name("customerBean.bankrupty")).sendKeys(Bankruptcy);

					test.log(LogStatus.PASS, "Bankrupty is selected as: "+Bankruptcy);

					driver.findElement(By.name("SLoan")).click();

					test.log(LogStatus.PASS, "Clicked on Save&Loan");

					Thread.sleep(5000);



					try {

						Alert alert = driver.switchTo().alert();

						alert.accept();

						//if alert present, accept and move on.



					}

					catch (NoAlertPresentException e) {

						//do what you normally would if you didn't have the alert.

					}



					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);



						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");





						if(driver.findElement(By.id("ShareScreenBtn")).isEnabled())

						{

							test.log(LogStatus.PASS, "Borrower is Registered Successfully with SSN as " +SSN);

						}

						else

						{

							test.log(LogStatus.FAIL, "Borrower is not Registered Successfully with SSN as " +SSN);

						}





					}

					//driver.switchTo().defaultContent();

					//driver.switchTo().frame("topFrame");

					//driver.findElement(By.xpath("//*[@id='icons']/li[7]/a")).click();

					//*[@id="icons"]/li[7]/a

					try {

						Alert alert = driver.switchTo().alert();

						alert.accept();

						//if alert present, accept and move on.



					}

					catch (NoAlertPresentException e) {

						//do what you normally would if you didn't have the alert.

					}

				}



			}



			//driver.switchTo().alert().accept();



			/*      WebDriver driver = new FirefoxDriver();

	                            JavascriptExecutor jse = (JavascriptExecutor) driver;

	                            jse.executeScript("document.getElementById('elementid').focus();");*/

		}

		public void AgeStore_2ndInst(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

		}

		//String winHandleBefore = driver.getWindowHandle();

		for(String winHandle : driver.getWindowHandles()){

		driver.switchTo().window(winHandle);

		}

		Thread.sleep(8000);

		// driver.findElement(By.xpath("//*[@id='home']")).click();*/
					//*[@id="myTable1"]/tbody[2]/tr[2]/td[2]  
					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();
					test.log(LogStatus.PASS, "2nd instalment duedate :"+DueDate);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(4000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void AgeStore_1stInst_DueDate(String SSN,String FileName,int Days) throws Exception

		{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan"; 

			for(int row=2;row<=lastrow;row++)

			{ 

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row); 

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					//String age_store = TestData.getCellData(sheetName, "AgeStore",row);

					//int Age_store = Integer.parseInt(age_store);

					//System.out.println(Age_store);

					//System.out.println("age_store:::"+age_store);

					//int Days= Integer.parseInt(age_store);


					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");


					System.out.println(ProductID); 

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions"); 

					driver.switchTo().frame("main"); 

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button"); 

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))

					{

						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1] 



						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("History");

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.id("go_Button")).click(); 

					}


					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					} 

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;


					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]

					DueDate = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[4]/td/span[2]")).getText();


					test.log(LogStatus.PASS, "Capture DueDate"+DueDate);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText(); 

					System.out.print(DueDate); 

					driver.close();


					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);


					DateFormat df=new SimpleDateFormat("MM/dd/yyyy"); 

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin"); 

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password); 

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(3000);



					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click(); 

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS); 

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);




					String DDueDate[] =DueDate.split("/");

					//String date = DDueDate[1];

					Date DDueDateminus1 = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDateminus1);

					cal.add(Calendar.DATE, Days);

					Date DDueDate1= cal.getTime();

					DueDate =df.format(DDueDate1);

					String DueDate0[] =DueDate.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];




					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");


					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1); 

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{ 

						test.log(LogStatus.PASS, "Process Date updated successfully");

						driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).click();

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date not updated successfully.");

					}
				}

			}

		}

		public void Payment_PartialAmount_NO (String SSN,String FileName) throws Exception{		


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";
			for(int row=2;row<=lastrow;row++)
			{
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					//  String Password = TestData.getCellData(sheetName,"Password",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					this.Login(UserName, Password, StoreId);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(4000);
					driver.switchTo().defaultContent();
					WebDriverWait wait = new WebDriverWait(driver, 30);
					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));
					driver.switchTo().frame("topFrame");
					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));
					driver.findElement(By.cssSelector("li[id='910000']")).click();
					/*driver.switchTo().defaultContent();
	                       driver.switchTo().frame("topFrame");
	                       driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();      */
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					Thread.sleep(1000);
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}

					Thread.sleep(5000);
					if(ProductID.equals("LOC"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("Payment");
					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();
						test.log(LogStatus.PASS, "Click on GO Button");
					}
					else
					{
						driver.findElement(By.id("go_Button")).click();
					}


					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("LOC"))
					{
						driver.findElement(By.name("password")).sendKeys(Password);
						driver.findElement(By.name("Submit22")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish  Loan button ");
						try {
							Alert alert = driver.switchTo().alert();
							alert.accept();
							//if alert present, accept and move on.

						}
						catch (NoAlertPresentException e) {
							//do what you normally would if you didn't have the alert.
						}
						for( String winHandle1 : driver.getWindowHandles())
						{
							driver.switchTo().window(winHandle1);
						}
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						if(driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).isDisplayed())
						{
							test.log(LogStatus.PASS, "Payment is Completed Successfully ");
							driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td[1]/input")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Payment Loan is not Completed Successfully ");
						}


					}

					if(ProductID.equals("PDL"))
					{
						if(ESign_DisbType.equals("Check")){
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						}
						//driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys(TenderType);
						if(ESign_DisbType.equals("Cash")){
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
						}
						if((ESign_DisbType.equals("Cash")||(ESign_DisbType.equals("Check")))&&((ESign_DisbType2.equals("Check"))||(ESign_DisbType.equals("Cash")) ))
						{
							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("TenderType");
						}
						String Pmt= driver.findElement(By.xpath(" /html/body/form/table/tbody/tr/td/table/tbody/tr[3]/td[2]/table/tbody/tr[3]/td/table/tbody/tr[3]/td[1]")).getText();
						System.out.println(Pmt);
						driver.findElement(By.name("transactionDataBean.tenderAmtFirst")).sendKeys(Pmt);
						test.log(LogStatus.PASS, "Tender Amt is entered as "+Pmt);
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						// name="tenderType"
						// tenderType
						// driver.findElement(By.name("tenderType")).sendKeys(TenderType);

						driver.findElement(By.xpath("//*[@id='PD5']")).click();
						test.log(LogStatus.PASS, " Click pay any other amt Type ");

						driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys("50");
						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");
						test.log(LogStatus.PASS, "tenderType  as Cash ");
						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys("50");

					}
					if(ProductID.equals("PDL"))
					{
						driver.findElement(By.name("transactionDataBean.password")).sendKeys(Password);
						driver.findElement(By.name("Submit23")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
						test.log(LogStatus.PASS, "Clicked on Finish Payament Loan button ");
					}
					if(ProductID.equals("TLP"))
					{
						// name="requestBean.password"
						// name="finish"
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Password is selected as "+Password);
					} 
					Thread.sleep(2000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[2]")).click();

					test.log(LogStatus.PASS, "Clicked On No Button in Renew PopUp ");



					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{
							test.log(LogStatus.PASS, "Partial Payment is Completed Successfully ");
							driver.findElement(By.name("Ok")).click();
						}
						else
						{
							test.log(LogStatus.FAIL, "Partial Payment is not Completed Successfully ");
						}

					}
				}
			}
		}

		public void Payment_No (String SSN,String FileName) throws Exception{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);

					String ESign_DisbType2 = TestData.getCellData(sheetName,"ESign_DisbType1",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					//String Password = TestData.getCellData(sheetName,"Password",row);

					//String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(4000);

					driver.switchTo().defaultContent();

					WebDriverWait wait = new WebDriverWait(driver, 30);

					wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("topFrame")));

					driver.switchTo().frame("topFrame");

					wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector("li[id='910000']")));

					driver.findElement(By.cssSelector("li[id='910000']")).click();

					/*driver.switchTo().defaultContent();

				driver.switchTo().frame("topFrame");

				driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click(); */

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					Thread.sleep(1000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("PDL"))

					{

						driver.findElement(By.xpath(" /html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();

					}

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();

					}

					Thread.sleep(5000);

					if(ProductID.equals("LOC"))

					{

						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();

					}

					// driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("transactionList")).sendKeys("Payment");

					test.log(LogStatus.PASS, "Transaction Type is selected as Payment");

					/* if(ProductID.equals("LOC"))

				{

				driver.findElement(By.name("button")).click();

				}

				else

				{

				driver.findElement(By.id("go_Button")).click();

				}*/

					if(ProductID.equals("TLP"))

					{

						driver.findElement(By.xpath("//*[@id='go_Button']")).click();

					}

					else

					{

						driver.findElement(By.id("go_Button")).click();

					}

					//*[@id="go_Button"]

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");




					if(ProductID.equals("TLP"))

					{


						driver.findElement(By.xpath("//*[@id='PD4']")).click();
						test.log(LogStatus.PASS, " Click payment amt Type ");

						//driver.findElement(By.name("requestBean.siilBean.payAmt")).sendKeys("300");

						driver.findElement(By.name("requestBean.siilBean.tenderTypeFirst")).sendKeys("Cash");

						test.log(LogStatus.PASS, "tenderType as Cash ");
						//name="instAmt"
						String pmtamt = driver.findElement(By.name("instAmt")).getAttribute("value");

						driver.findElement(By.name("requestBean.siilBean.tenderAmtFirst")).sendKeys(pmtamt);

					}


					if(ProductID.equals("TLP"))

					{



						driver.findElement(By.name("requestBean.password")).sendKeys(Password);

						driver.findElement(By.name("finish")).click();

						test.log(LogStatus.PASS, "Password is selected as "+Password);

						driver.findElement(By.xpath("//*[@id='renew-confirm']/table/tbody/tr[4]/td/input[2]")).click();
						test.log(LogStatus.PASS, "Payment is  No Renewed ");
					}

					Thread.sleep(2000);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");
					//*[@id="renew-confirm"]/table/tbody/tr[4]/td/input[1]

					{

						if(driver.findElement(By.name("Ok")).isDisplayed())

						{

							test.log(LogStatus.PASS, " Payment is Completed Successfully ");

							driver.findElement(By.name("Ok")).click();

						}

						else

						{

							test.log(LogStatus.FAIL, "Partial Payment is not Completed Successfully ");

						}

					}

				}

			}

		}		

		public void AgeStore_3rdInst(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String DueDate=null;

					/* driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[2]/a")).click();

		}

		//String winHandleBefore = driver.getWindowHandle();

		for(String winHandle : driver.getWindowHandles()){

		driver.switchTo().window(winHandle);

		}

		Thread.sleep(8000);

		// driver.findElement(By.xpath("//*[@id='home']")).click();*/
					//*[@id="myTable1"]/tbody[2]/tr[2]/td[2]  
					DueDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[4]/td[2]")).getText();
					test.log(LogStatus.PASS, "2nd instalment duedate :"+DueDate);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					System.out.print(DueDate);

					driver.close();

					driver = new InternetExplorerDriver();

					driver.get(AdminURL);

					// storeupdate(UserName,Password,StoreID,DueDate,AdminURL);

					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");

					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");

					test.log(LogStatus.PASS, "Username is entered: admin");

					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);

					test.log(LogStatus.PASS, "Password is entered: "+Password);

					//Click Login Button

					driver.findElement(By.name("login")).click();

					test.log(LogStatus.PASS, "Clicked on Submit button");

					Thread.sleep(8000);

					//for(String winHandle : driver.getWindowHandles()){

					// driver.switchTo().window(winHandle);

					//}

					// driver.switchTo().defaultContent();

					// driver.switchTo().frame("mainFrame");

					//driver.switchTo().frame("main");

					Date DDueDate = df.parse(DueDate);

					Calendar cal = Calendar.getInstance();

					cal.setTime(DDueDate);

					cal.add(Calendar.DATE, days);

					Date DDueDateminus1= cal.getTime();

					String DueDateminus1 =df.format(DDueDateminus1);

					String DueDate0[] =DueDateminus1.split("/");

					String DueDate1 = DueDate0[0];

					String DueDate2 = DueDate0[1];

					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					/*driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.linkText("Borrower")).click();

					test.log(LogStatus.PASS, "Clicked on Borrower");

					Thread.sleep(5000);

					driver.findElement(By.linkText("Process Date Change")).click();

					test.log(LogStatus.PASS, "Clicked on Process Date Change");*/
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("QA Jobs")).click();
					test.log(LogStatus.PASS, "Clicked on QA Jobs");
					driver.findElement(By.linkText("Process Date Change")).click();
					test.log(LogStatus.PASS, "Clicked on Process Date Change");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("storeCode")).click();

					//driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td")).click();

					driver.findElement(By.name("storeCode")).sendKeys(StoreID);

					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);

					Thread.sleep(5000);

					driver.findElement(By.name("beginMonth")).clear();

					driver.findElement(By.name("beginMonth")).sendKeys(DueDate1);

					test.log(LogStatus.PASS, "beginMonth is entered: "+DueDate1);

					driver.findElement(By.name("beginDay")).clear();

					driver.findElement(By.name("beginDay")).sendKeys(DueDate2);

					test.log(LogStatus.PASS, "beginDay is entered: "+DueDate2);

					driver.findElement(By.name("beginYear")).clear();

					driver.findElement(By.name("beginYear")).sendKeys(DueDate3);

					test.log(LogStatus.PASS, "beginYear is entered: "+DueDate3);

					Thread.sleep(2000);

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					Thread.sleep(1000);

					Thread.sleep(5000);

					driver.findElement(By.name("btnPreview")).click();

					test.log(LogStatus.PASS, "Clicked on submit button");

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if( driver.findElement(By.xpath("/html/body/form/table[1]/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td[2]/table/tbody/tr[2]/td/input")).isDisplayed())

					{

						test.log(LogStatus.PASS, "Process Date updated successfully");

					}

					else

					{

						test.log(LogStatus.FAIL, "Process Date updated successfully.");

					}

				}

			}

		}

		public void Loan_Status_Inst(String SSN,String FileName) throws Exception{

			//String FileName= "AA_TwoLoans_OneVIN_OneDefault_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					test.log(LogStatus.INFO, "Renewal Status(Starts)");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreID, driver, AppURL, test);
					//this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);

					Thread.sleep(5000);
					Thread.sleep(1000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					test.log(LogStatus.INFO,"Navigated To Loan Transaction Screen");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");	
					test.log(LogStatus.INFO,"Navigate to Transactions Screen");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");	

					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Customer Record Screen");

					//driver.findElement(By.name("button")).click();
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Line Of Credit History Screen");





					//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
					driver.findElement(By.xpath("//input[(@name='button') and (@value='Go')]")).click();
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					test.log(LogStatus.INFO,"Navigate to Transaction List Screen");

					driver.findElement(By.name("transactionList")).sendKeys("History");
					test.log(LogStatus.INFO,"Navigate to History Credit Table Screen");

					driver.findElement(By.name("button")).click();
					test.log(LogStatus.INFO,"Transaction Selection Go Button Click");


					String Fee=null;
					String Interest=null;
					String Principle=null;


					Fee = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[11]/font")).getText();
					test.log(LogStatus.PASS, "Fee Paid for 1st Inst::"+Fee);

					Interest = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[4]/td[10]/font")).getText();
					test.log(LogStatus.PASS, "1st Instment Interst Payment::"+Interest);

					Principle =	driver.findElement(By.xpath(" //*[@id='transactionDetailsTable']/tbody/tr[3]/td[9]/font")).getText();
					test.log(LogStatus.PASS, " Principle Ammount Addded::"+Principle);		

				}
			}
		}

		public void PrincipalReduction_4thInst(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);

			int lastrow=TestData.getLastRow("NewLoan");

			System.out.println("NewLoan "+lastrow);

			String sheetName="NewLoan";

			for(int row=2;row<=lastrow;row++)

			{

				String RegSSN = TestData.getCellData(sheetName,"SSN",row);

				if(SSN.equals(RegSSN))

				{

					String TxnType=TestData.getCellData(sheetName,"TxnType",row);

					String TenderType = TestData.getCellData(sheetName,"TenderType",row);

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);

					String UserName = TestData.getCellData(sheetName,"UserName",row);

					String Password = TestData.getCellData(sheetName,"Password",row);

					String StoreID = TestData.getCellData(sheetName,"StoreID",row);

					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);

					System.out.println(AdminURL);

					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);

					appUrl = AppURL;

					this.Login(UserName,Password,StoreID);

					String SSN1 = SSN.substring(0, 3);

					String SSN2 = SSN.substring(3,5);

					String SSN3 = SSN.substring(5,9);

					Thread.sleep(5000);

					Thread.sleep(1000);

					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();

					test.log(LogStatus.PASS, "Clicked on Loan Transactions");

					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

					driver.findElement(By.cssSelector("li[id='911101']")).click();

					test.log(LogStatus.PASS, "Clicked on Transactions");

					driver.switchTo().frame("main");

					driver.findElement(By.name("ssn1")).sendKeys(SSN1);

					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);

					driver.findElement(By.name("ssn2")).sendKeys(SSN2);

					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);

					driver.findElement(By.name("ssn3")).sendKeys(SSN3);

					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);

					driver.findElement(By.name("submit1")).click();

					test.log(LogStatus.PASS, "Click on submit Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					driver.findElement(By.name("button")).click();

					test.log(LogStatus.PASS, "Click on GO Button");

					for(String winHandle : driver.getWindowHandles()){

						driver.switchTo().window(winHandle);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	

						//html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[13]/input")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())

					{

						driver.switchTo().window(winHandle1);

					}

					driver.switchTo().defaultContent();

					driver.switchTo().frame("mainFrame");

					driver.switchTo().frame("main");

					String LoanAMT=null;
					String PrincipalAMT=null;



					LoanAMT = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[5]/td/span[2]")).getText();
					test.log(LogStatus.PASS, "Loan Amount ::"+LoanAMT);

					PrincipalAMT = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[5]/td[14]")).getText();
					test.log(LogStatus.PASS, "5% of Loan Amount's,Principal Amount ::"+PrincipalAMT);

					//DueDate=driver.findElement(By.xpath("//*[@id='revolvingCreditHistTable']/tbody/tr[4]/td[3]/span[2]")).getText();

					//System.out.print(DueDate);


				}

			}

		}

		public void NewLoanWithVIN1(String SSN,String FileName,String NewVIN) throws Exception{


			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);     	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{		
					String State = TestData.getCellData(sheetName,"StateID",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					System.out.println(ProductID);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String ProductType = TestData.getCellData(sheetName,"ProductType",row);
					String ProductName = TestData.getCellData(sheetName,"ProductName",row);
					String VehicleType= TestData.getCellData(sheetName,"VehicleType",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String stateProductType=State+" "+ProductType;
					String ESign_CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					System.out.println(ESign_CollateralType);
					String ESign_LoanAmt = TestData.getCellData(sheetName,"ESign_LoanAmt",row);
					String ChkgAcctNbr = TestData.getCellData(sheetName,"ChkgAcctNbr",row);
					String ESign_DisbType = TestData.getCellData(sheetName,"ESign_DisbType",row);
					String ESign_DisbType2 = TestData.getCellData(sheetName,"Esign_DisbType2",row);
					String ESign_CourtesyCallConsent = TestData.getCellData(sheetName,"ESign_CourtesyCallConsent",row);
					String AllowPromotion = TestData.getCellData(sheetName,"Allow Promotion",row);
					String CouponNbr = TestData.getCellData(sheetName,"CouponNbr",row);
					String ESign_Preference = TestData.getCellData(sheetName,"ESign_Preference",row);
					String ESign_Checks = TestData.getCellData(sheetName,"ESign_Checks",row);
					String ESign_Password=TestData.getCellData(sheetName,"ESign_Password",row);
					String ESign_CheckNbr = TestData.getCellData(sheetName,"ESign_CheckNbr",row);			
					String last4cheknum= ChkgAcctNbr.substring(ChkgAcctNbr.length() - 4);
					System.out.println(last4cheknum);
					System.out.println(stateProductType);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);


					String Parent_Window = driver.getWindowHandle();
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911100']")).click();			
					test.log(LogStatus.PASS, "Clicked on New Loan");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);	
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(driver.findElement(By.name("ShareScreenBtn")).isEnabled())
					{
						if(ProductID.equals("TLP"))							
						{					

							Thread.sleep(2000);
							driver.findElement(By.xpath("//*[@id='vehicleType_dd']")).sendKeys(VehicleType);
							driver.findElement(By.xpath("//*[@id='vinDD']")).sendKeys("New");
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[1]/td[2]/input")).sendKeys(NewVIN);	
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[1]/tbody/tr[2]/td[2]/input")).sendKeys(NewVIN);
							driver.findElement(By.xpath("//*[@id='vinPop']/div/table[3]/tbody/tr/td/input[2]")).click();
							driver.findElement(By.xpath("//*[@id='td.miles_tf']/input")).sendKeys("200");
							driver.findElement(By.xpath("//*[@id='bbHit_Button']")).click();

							Thread.sleep(3000);
						}												

						if(ProductName.equals("Tennessee"))
						{

							//driver.findElement(By.xpath("//*[@id='termSel1']")).click();
							driver.findElement(By.xpath("//*[@id='riskViewBdy']/table[3]/tbody/tr[1]/td/table/tbody/tr[3]/td/table/tbody/tr[2]/td[2]/input")).click();
							test.log(LogStatus.PASS, "ProductName is selected as "+ProductName);
						}


						driver.findElement(By.name("ShareScreenBtn")).click();
						test.log(LogStatus.PASS, "ShareScreen Button clicked");
						for( String winHandle1 : driver.getWindowHandles())

						{
							if(!(winHandle1.equals(Parent_Window)))
							{
								driver.switchTo().window(winHandle1);
								Thread.sleep(1000);
								driver.findElement(By.name("confirmSummary")).click();
								test.log(LogStatus.PASS, "ConfirmShareScreen Button clicked");
							}

						}
						Thread.sleep(3000);
						driver.switchTo().window(Parent_Window);

						for( String winHandle1 : driver.getWindowHandles())

						{

							driver.switchTo().window(winHandle1);

						}                    

						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");
						driver.findElement(By.id("LoanButtonId")).click();

						test.log(LogStatus.PASS, "Clicked on New Loan button");


						if(ProductID.equals("TLP"))
						{	
							String TitleNumber= TestData.getCellData(sheetName,"TitleNumber",row);
							String AppraisalValue= TestData.getCellData(sheetName,"Appraisal Value",row);
							String ExteriorColor=TestData.getCellData(sheetName,"ExteriorColor",row);
							String LicensePlateNumber=TestData.getCellData(sheetName,"License Plate Number",row);
							String LicensePlateExp=TestData.getCellData(sheetName,"License Plate Expiry",row);
							String InsuranceCoverage=TestData.getCellData(sheetName,"Insurance Coverage",row);
							String PhoneNbr=TestData.getCellData(sheetName,"Phone Nbr",row);
							String PhoneNbr1 = PhoneNbr.substring(0, 3);
							String PhoneNbr2 = PhoneNbr.substring(3, 6);
							String PhoneNbr3 = PhoneNbr.substring(6, 10);
							String InsuranceCompany =TestData.getCellData(sheetName,"Insurance Company",row);
							String InsuranceExpiryDate=TestData.getCellData(sheetName,"Insurance Expiry Date",row);
							String PolicyNumber=TestData.getCellData(sheetName,"Policy Number",row);
							String InsuranceExpiryDate0[] =InsuranceExpiryDate.split("/");
							String InsuranceExpiryDate1 = InsuranceExpiryDate0[0];
							String InsuranceExpiryDate2 = InsuranceExpiryDate0[1];
							String InsuranceExpiryDate3 = InsuranceExpiryDate0[2];
							driver.findElement(By.name("requestBean.titleNumber")).clear();
							driver.findElement(By.name("requestBean.titleNumber")).sendKeys(TitleNumber);
							driver.findElement(By.name("requestBean.appraisalVal")).clear();
							driver.findElement(By.name("requestBean.appraisalVal")).sendKeys(AppraisalValue);
							driver.findElement(By.name("button1")).click();
							test.log(LogStatus.PASS, "click on Update 1 button ");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							WebDriverWait wait = new WebDriverWait(driver, 10);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.extClr")));

							driver.findElement(By.name("requestBean.extClr")).sendKeys(ExteriorColor);
							driver.findElement(By.name("requestBean.licensePltNbr")).clear();
							driver.findElement(By.name("requestBean.licensePltNbr")).sendKeys(LicensePlateNumber);
							driver.findElement(By.name("requestBean.licensePltExpire")).clear();
							driver.findElement(By.name("requestBean.licensePltExpire")).sendKeys(LicensePlateExp);
							driver.findElement(By.name("requestBean.paintCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.bodyCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.glassCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.tiresCondition")).sendKeys("Clean");
							driver.findElement(By.name("requestBean.coverageType")).sendKeys(InsuranceCoverage);
							driver.findElement(By.name("iPhoneNbr1")).clear();
							driver.findElement(By.name("iPhoneNbr1")).sendKeys(PhoneNbr1);
							driver.findElement(By.name("iPhoneNbr2")).clear();
							driver.findElement(By.name("iPhoneNbr2")).sendKeys(PhoneNbr2);

							driver.findElement(By.name("iPhoneNbr3")).clear();
							driver.findElement(By.name("iPhoneNbr3")).sendKeys(PhoneNbr3);
							driver.findElement(By.name("requestBean.companyName")).clear();
							driver.findElement(By.name("requestBean.companyName")).sendKeys(InsuranceCompany);
							driver.findElement(By.name("iexpiry1")).clear();
							driver.findElement(By.name("iexpiry1")).sendKeys(InsuranceExpiryDate1);
							driver.findElement(By.name("iexpiry2")).clear();
							driver.findElement(By.name("iexpiry2")).sendKeys(InsuranceExpiryDate2);
							driver.findElement(By.name("iexpiry3")).clear();
							driver.findElement(By.name("iexpiry3")).sendKeys(InsuranceExpiryDate3);
							driver.findElement(By.name("requestBean.polocyNbr")).clear();
							driver.findElement(By.name("requestBean.polocyNbr")).sendKeys(PolicyNumber);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("button2")));
							driver.findElement(By.name("button2")).click();			
							driver.findElement(By.name("button2")).click();	
							test.log(LogStatus.PASS, "click on Update 2 button ");
							Thread.sleep(8000);

							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("process")));
							driver.findElement(By.name("process")).click();
							test.log(LogStatus.PASS, "click on process Loan button ");
							try { 
								Alert alert = driver.switchTo().alert();
								alert.accept();

							}
							catch (NoAlertPresentException e) {
							}
							Thread.sleep(5000);
							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("collateralType")));
							test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
							driver.findElement(By.name("negLoanAmt")).click();
							for( String winHandle1 : driver.getWindowHandles())

							{

								driver.switchTo().window(winHandle1);

							}

							Thread.sleep(1000);



							wait.until(ExpectedConditions.visibilityOfElementLocated(By.name("requestBean.siilBean.advAmt")));

							driver.findElement(By.name("requestBean.siilBean.advAmt")).clear();
							Thread.sleep(3000);

							try { 
								Alert alert = driver.switchTo().alert();
								alert.accept();

							}
							catch (NoAlertPresentException e) {
							}
							Thread.sleep(3000);

							WebElement element = driver.findElement(By.name("requestBean.siilBean.advAmt"));                                       
							Actions builder = new Actions(driver); 
							builder.doubleClick()

							.sendKeys(element, Keys.DELETE)

							.sendKeys(element,Keys.BACK_SPACE)
							.sendKeys(element,Keys.BACK_SPACE)
							.sendKeys(element,Keys.BACK_SPACE)
							.sendKeys(element,Keys.BACK_SPACE)
							.sendKeys(element,Keys.BACK_SPACE)
							.sendKeys(element,Keys.BACK_SPACE)
							.sendKeys(element,Keys.BACK_SPACE)
							.build()
							.perform();



							try { 
								Alert alert = driver.switchTo().alert();
								alert.accept();


							}
							catch (NoAlertPresentException e) {

							}

							Thread.sleep(6000);
							driver.findElement(By.name("requestBean.siilBean.advAmt")).sendKeys("1250");
							driver.findElement(By.name("negSel")).click();
							driver.findElement(By.name("reCalculate")).click();
							driver.findElement(By.name("negSel")).click();
							Thread.sleep(3000);
							driver.switchTo().window(Parent_Window);

							for( String winHandle1 : driver.getWindowHandles())

							{

								driver.switchTo().window(winHandle1);

							}                    

							driver.switchTo().defaultContent();

							driver.switchTo().frame("mainFrame");

							driver.switchTo().frame("main");

							driver.findElement(By.name("collateralType")).sendKeys(ESign_CollateralType);
							test.log(LogStatus.PASS, "Collateral Type is enterted as "+ESign_CollateralType);
							driver.findElement(By.name("requestBean.siilBean.disbType")).sendKeys(ESign_DisbType);
							test.log(LogStatus.PASS, "Disb Type is enterted as "+ESign_DisbType);
							String Instamt=driver.findElement(By.name("requestBean.siilBean.advAmt")).getAttribute("value");
							driver.findElement(By.name("requestBean.siilBean.disbAmtFirst")).sendKeys("1250");
							test.log(LogStatus.PASS, "Disb Amt is enterted as "+"1250");


							Thread.sleep(5000);

							driver.findElement(By.name("requestBean.siilBean.emailConsentFlag")).sendKeys(ESign_CourtesyCallConsent);
							test.log(LogStatus.PASS, "Payment Reminder Consent is selected as "+ESign_CourtesyCallConsent);
							if(ESign_CourtesyCallConsent.equals("Yes"))
							{
								if(ESign_Preference.equals("Call"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceCall']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
								}
								if(ESign_Preference.equals("Mail"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceMail']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);
								}
								if(ESign_Preference.equals("SMS"))	
								{
									driver.findElement(By.xpath("//*[@id='preferenceSms']")).click();
									test.log(LogStatus.PASS, "Courtesy Call Consent is selected as "+ESign_Preference);

									try { 
										Alert alert = driver.switchTo().alert();
										alert.dismiss();

									}
									catch (NoAlertPresentException e) {
									}
								}

							}
							if(AllowPromotion.equals("Yes"))
							{
								driver.findElement(By.name("allowPromotion")).click();
								test.log(LogStatus.PASS, "AllowPromotion is selected ");
								driver.findElement(By.name("requestBean.siilBean.couponNbr")).sendKeys(CouponNbr);
								test.log(LogStatus.PASS, "CouponNbr is selected as "+CouponNbr);
							}
							driver.findElement(By.name("requestBean.password")).sendKeys(ESign_Password);
							driver.findElement(By.name("finishLoan")).click();
							test.log(LogStatus.PASS, "Click on Finish Loan Button");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							driver.findElement(By.xpath("//*[@id='OKBut']")).click();	
							test.log(LogStatus.PASS, "click on Yes button ");
							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}			
							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");
							if(driver.findElement(By.name("ok")).isDisplayed())
							{
								test.log(LogStatus.PASS, "New Loan is Completed Successfully ");
								driver.findElement(By.name("ok")).click();
							}
							else
							{
								test.log(LogStatus.FAIL, "New Loan is not Completed Successfully ");
							}
						}

					}

				}
			}
		}


		public void Loan_Status_Loan1(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					String CheckStaus=null;
					CheckStaus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]

					test.log(LogStatus.PASS,"Loan No 1 Status is :: "+CheckStaus);
					System.out.print(CheckStaus);	

					driver.close();
					driver = new InternetExplorerDriver();

				}
			}
		}

		public void Loan_Status_Loan2(String SSN,String FileName) throws Exception
		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{

					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{

						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();

						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					String CheckStaus=null;
					CheckStaus = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]")).getText();

					//*[@id="transactionHistoryTable"]/tbody/tr/td[3]/table/tbody/tr[2]/td/span[2]

					test.log(LogStatus.PASS,"Loan No 2 Status is :: "+CheckStaus);
					System.out.print(CheckStaus);	

					driver.close();
					driver = new InternetExplorerDriver();

				}
			}
		}

		
		public void Verify_Waived_History_1(String SSN,String FileName) throws Exception
		{

		Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
		int lastrow=TestData.getLastRow("NewLoan");
		System.out.println("NewLoan "+lastrow);
		String sheetName="NewLoan";		
		for(int row=2;row<=lastrow;row++)
		{	
			String RegSSN = TestData.getCellData(sheetName,"SSN",row);
			if(SSN.equals(RegSSN))
			{
				String TxnType=TestData.getCellData(sheetName,"TxnType",row);
				String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
				String ProductID=TestData.getCellData(sheetName,"ProductID",row);
				String UserName = TestData.getCellData(sheetName,"UserName",row);
				String Password = TestData.getCellData(sheetName,"Password",row);
				String StoreID = TestData.getCellData(sheetName,"StoreID",row);
				String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
				System.out.println(AdminURL);
				test.log(LogStatus.INFO, "Scheduler-Store Aging");

				System.out.println(ProductID);	
				String AppURL = TestData.getCellData(sheetName,"AppURL",row);
				appUrl = AppURL;
				this.Login(UserName,Password,StoreID);
				String SSN1 = SSN.substring(0, 3);
				String SSN2 = SSN.substring(3,5);
				String SSN3 = SSN.substring(5,9);
				Thread.sleep(5000);
				driver.switchTo().frame("topFrame");
				driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
				test.log(LogStatus.PASS, "Clicked on Loan Transactions");
				driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
				driver.findElement(By.cssSelector("li[id='911101']")).click();			
				test.log(LogStatus.PASS, "Clicked on Transactions");		
				driver.switchTo().frame("main");		
				driver.findElement(By.name("ssn1")).sendKeys(SSN1);
				test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
				driver.findElement(By.name("ssn2")).sendKeys(SSN2);
				test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
				driver.findElement(By.name("ssn3")).sendKeys(SSN3);
				test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
				driver.findElement(By.name("submit1")).click();
				test.log(LogStatus.PASS, "Click on submit Button");		
				for(String winHandle : driver.getWindowHandles()){
					driver.switchTo().window(winHandle);
				}
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.switchTo().frame("main");
				driver.findElement(By.name("button")).click();
				test.log(LogStatus.PASS, "Click on GO Button");
				for(String winHandle : driver.getWindowHandles()){
					driver.switchTo().window(winHandle);
				}				    
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.switchTo().frame("main");


				if(ProductID.equals("TLP"))
				{
					
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
				}

				test.log(LogStatus.PASS, "Click on GO Button");
				for( String winHandle1 : driver.getWindowHandles())
				{
					driver.switchTo().window(winHandle1);
				}			
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.switchTo().frame("main");
				driver.findElement(By.name("transactionList")).sendKeys("History");
			    driver.findElement(By.xpath("//*[@id='go_Button']")).click();
				test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
			
				if(driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[4]/font")).isDisplayed())
					//*[@id="transactionDetailsTable"]/tbody/tr[8]/td[4]/font
				{

					String WriteoffWaived  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[4]/font")).getText();
					String WaivedAmount  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[5]/font")).getText();

					if((WriteoffWaived).contains("Write Off Waived"))
					{

						test.log(LogStatus.PASS,"Write Off Waived Amount1:" +WriteoffWaived );
						test.log(LogStatus.PASS,"Write Off Waived Amount1:" +WaivedAmount);	

						this.Verify_Waived_History_2(SSN, FileName);
					}

				}

			/*	else
				{
					String WriteoffWaived1  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[4]/font")).getText();
					String WaivedAmount1  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[8]/td[5]/font")).getText();

					test.log(LogStatus.PASS,"Write Off Waived Amount2:" +WriteoffWaived1 );
					test.log(LogStatus.PASS,"Write Off Waived Amount2:" +WaivedAmount1);
					this.Verify_Waived_History(SSN, FileName);

				}*/

			}
		}

		}
		
		public void Verify_Waived_History_2(String SSN,String FileName) throws Exception
		{

		Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
		int lastrow=TestData.getLastRow("NewLoan");
		System.out.println("NewLoan "+lastrow);
		String sheetName="NewLoan";		
		for(int row=2;row<=lastrow;row++)
		{	
			String RegSSN = TestData.getCellData(sheetName,"SSN",row);
			if(SSN.equals(RegSSN))
			{
				String TxnType=TestData.getCellData(sheetName,"TxnType",row);
				String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
				String ProductID=TestData.getCellData(sheetName,"ProductID",row);
				String UserName = TestData.getCellData(sheetName,"UserName",row);
				String Password = TestData.getCellData(sheetName,"Password",row);
				String StoreID = TestData.getCellData(sheetName,"StoreID",row);
				String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
				System.out.println(AdminURL);
				test.log(LogStatus.INFO, "Scheduler-Store Aging");

				System.out.println(ProductID);	
				String AppURL = TestData.getCellData(sheetName,"AppURL",row);
				appUrl = AppURL;
				this.Login(UserName,Password,StoreID);
				String SSN1 = SSN.substring(0, 3);
				String SSN2 = SSN.substring(3,5);
				String SSN3 = SSN.substring(5,9);
				Thread.sleep(5000);
				driver.switchTo().frame("topFrame");
				driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
				test.log(LogStatus.PASS, "Clicked on Loan Transactions");
				driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
				driver.findElement(By.cssSelector("li[id='911101']")).click();			
				test.log(LogStatus.PASS, "Clicked on Transactions");		
				driver.switchTo().frame("main");		
				driver.findElement(By.name("ssn1")).sendKeys(SSN1);
				test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
				driver.findElement(By.name("ssn2")).sendKeys(SSN2);
				test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
				driver.findElement(By.name("ssn3")).sendKeys(SSN3);
				test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
				driver.findElement(By.name("submit1")).click();
				test.log(LogStatus.PASS, "Click on submit Button");		
				for(String winHandle : driver.getWindowHandles()){
					driver.switchTo().window(winHandle);
				}
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.switchTo().frame("main");
				driver.findElement(By.name("button")).click();
				test.log(LogStatus.PASS, "Click on GO Button");
				for(String winHandle : driver.getWindowHandles()){
					driver.switchTo().window(winHandle);
				}				    
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.switchTo().frame("main");


				if(ProductID.equals("TLP"))
				{
					driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
					driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();
				                      
				}
				
				test.log(LogStatus.PASS, "Click on GO Button");
				for( String winHandle1 : driver.getWindowHandles())
				{
					driver.switchTo().window(winHandle1);
				}			
				driver.switchTo().defaultContent();
				driver.switchTo().frame("mainFrame");
				driver.switchTo().frame("main");
				driver.findElement(By.name("transactionList")).sendKeys("History");
			
					driver.findElement(By.xpath("//*[@id='go_Button']")).click();
					test.log(LogStatus.PASS, "Click on Go for TRANSACTION Selection Button");
					String WriteoffWaived  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[7]/td[4]/font")).getText();
					String WaivedAmount  = driver.findElement(By.xpath("//*[@id='transactionDetailsTable']/tbody/tr[7]/td[5]/font")).getText();
					
					
				if((WriteoffWaived).contains("Write Off Waived"))
				{
					test.log(LogStatus.PASS,"Write Off Waived2 :" +WriteoffWaived );
					test.log(LogStatus.PASS,"Write Off Waived Amount2:" +WaivedAmount );
				}
				else
				{
					test.log(LogStatus.PASS,"Write Off Waived Record is not Displayed.");
				}
		     }
		}
		
		}
		public void Check_CustomerRefund(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					//String age_store = TestData.getCellData(sheetName, "AgeStore",row);
					//int Age_store = Integer.parseInt(age_store);
					//System.out.println(Age_store);
					//System.out.println("age_store:::"+age_store);
					//int Days= Integer.parseInt(age_store);

					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					
					int n=driver.findElements(By.xpath("//select[@name='transactionList']/option")).size();

					for(int i=1;i<=n;i++)
					{
						String transactino_value=driver.findElement(By.xpath("//select[@name='transactionList']/option["+i+"]")).getText();


						if(transactino_value.equalsIgnoreCase("CustomerRefund"))
						{
							
						
					driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
					test.log(LogStatus.PASS, "CustomerRefund option is available in the list");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}

					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					
					driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Enter the Disb Type Cash");
					driver.findElement(By.name("password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Enter the Password");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on Finish Refund Button");
					test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
						}
									
				
						else
						{
							driver.findElement(By.xpath("//*[@id='CustGrid']/tbody/tr[2]/td[13]/table/tbody/tr/td[2]/input[2]")).click();
						
							driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
							driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input")).click();
							driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
							test.log(LogStatus.PASS, "CustomerRefund option is available in the list");
							
							if(ProductID.equals("TLP"))
							{
								driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
							}

							for( String winHandle1 : driver.getWindowHandles())
							{
								driver.switchTo().window(winHandle1);
							}

							driver.switchTo().defaultContent();
							driver.switchTo().frame("mainFrame");
							driver.switchTo().frame("main");

							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
							test.log(LogStatus.PASS, "Enter the Disb Type Cash");
							driver.findElement(By.name("password")).sendKeys(Password);
							test.log(LogStatus.PASS, "Enter the Password");
							driver.findElement(By.name("finish")).click();
							test.log(LogStatus.PASS, "Click on Finish Refund Button");
							test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
							break;
					  }
					}
				}
				}
		}		
		


		/*public void Check_CustomerRefund(String SSN,String FileName) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);	
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					//String age_store = TestData.getCellData(sheetName, "AgeStore",row);
					//int Age_store = Integer.parseInt(age_store);
					//System.out.println(Age_store);
					//System.out.println("age_store:::"+age_store);
					//int Days= Integer.parseInt(age_store);

					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(5000);
					Thread.sleep(5000);
					driver.switchTo().frame("topFrame");

					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");


					if(ProductID.equals("TLP"))
					{
						///html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]	
						//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[4]/td[11]/input[1]")).click();
						driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					}
					//  driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					int n=driver.findElements(By.xpath("//select[@name='transactionList']/option")).size();

					for(int i=1;i<=n;i++)
					{
						String transactino_value=driver.findElement(By.xpath("//select[@name='transactionList']/option["+i+"]")).getAttribute("value");

						if(transactino_value.equals("CustomerRefund"))
						{
							
							 driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
							 if(ProductID.equals("TLP"))
							 {
								 driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
							 }

							for( String winHandle1 : driver.getWindowHandles())

							{

							driver.switchTo().window(winHandle1);

							}

							driver.switchTo().defaultContent();

							driver.switchTo().frame("mainFrame");

							driver.switchTo().frame("main");


							driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
							test.log(LogStatus.PASS, "Enter the Disb Type Cash");
							driver.findElement(By.name("password")).sendKeys(Password);
							test.log(LogStatus.PASS, "Enter the Password");

							driver.findElement(By.name("finish")).click();
							test.log(LogStatus.PASS, "Click on Finish Refund Button");
							test.log(LogStatus.PASS, "CustomerRefund updated successfully.");


								Thread.sleep(2000);


								if(driver.findElement(By.xpath("//(@type='button' and @value='Yes')")).isDisplayed())
								{
									//driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
										driver.findElement(By.xpath("//(@type='button' and @value='Yes')")).click();
										test.log(LogStatus.PASS, "OK Button is Clicked");
						
										test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
							
								}

							else

							{

							test.log(LogStatus.FAIL, "CustomerRefund Not updated successfully.");

							} 
							//test.log(LogStatus.PASS, "CustomerRefund Option is Available");	
							
							
						}
						else
						{
							test.log(LogStatus.PASS, "CustomerRefund Option is not Available");	
							this.CustomerRefund_secondloan(SSN, FileName);
						}
					}

				}
			}
		}
		
		*/
		
		
		
		public void Auction(String SSN,String FileName,int days) throws Exception

		{

			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");

					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					Thread.sleep(7000);
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					Thread.sleep(2000);
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");

					String CsrLoan=	 driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[2]")).getText();
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}				    
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");

					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					test.log(LogStatus.PASS, "Click on GO Button");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					DefaultDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();
					test.log(LogStatus.PASS, "Capture Default date:"+DefaultDate);
					driver.close();
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					String Parent_Window = driver.getWindowHandle();
					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: "+Password);
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Thread.sleep(2000);
					Date DDueDate = df.parse(DefaultDate);
					Calendar cal = Calendar.getInstance();
					cal.setTime(DDueDate);
					cal.add(Calendar.DATE, days);
					Date DDueDateminus1= cal.getTime();
					String DueDateminus1 =df.format(DDueDateminus1);
					String DueDate0[] =DueDateminus1.split("/");
					String DueDate1 = DueDate0[0];
					String DueDate2 = DueDate0[1];
					String DueDate3 = DueDate0[2];
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					Thread.sleep(3000);
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.linkText("Title Loan")).click();
					test.log(LogStatus.PASS, "Clicked on Title Loan");
					Thread.sleep(1000);
					driver.findElement(By.linkText("Post Default Transactions")).click();
					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");
					driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					Thread.sleep(1000);
					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");
					driver.findElement(By.name("requestBean.statusType")).sendKeys("Auction");
					test.log(LogStatus.PASS, "Auction is entered: ");
					driver.findElement(By.name("submit")).click();
					test.log(LogStatus.PASS, "Clicked on submitt Button: ");
					//--------------updated new code
					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					test.log(LogStatus.PASS, "Clicked on Go Button: ");
					driver.findElement(By.name("history")).click();
					Thread.sleep(4000);
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					Thread.sleep(4000);
					driver.manage().window().maximize();
					String Loan1 = driver.findElement(By.xpath("//*[@id='transactionHistoryTable']/tbody/tr/td[4]/table/tbody/tr[4]/td/span[2]")).getText();
					test.log(LogStatus.PASS, "Loan number --"+Loan1);
					Set<String> windows= driver.getWindowHandles();
					for(String winHandle1:windows)			
					{
						if(!Parent_Window.equalsIgnoreCase(winHandle1))
							driver.switchTo().window(winHandle1).close();
					}

					driver.switchTo().window(Parent_Window);
					if(CsrLoan.equals(Loan1))
					{			
						driver.switchTo().defaultContent();

						driver.switchTo().frame("mainFrame");

						driver.switchTo().frame("main");
						driver.findElement(By.name("solvageCompany")).sendKeys("CARS");
						test.log(LogStatus.PASS, "Solvage Company is selected CARS ");
						driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
						test.log(LogStatus.PASS, "Month is Entered");
						driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
						test.log(LogStatus.PASS, "Day is Entered");
						driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
						test.log(LogStatus.PASS, "Year is Entered");
						Thread.sleep(5000);
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						test.log(LogStatus.PASS, "Password Entered");
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Click on submitt Button");
					}
					else
					{
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.name("cancelLoan")).click();
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);
						test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
						Thread.sleep(1000);
						driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
						test.log(LogStatus.PASS, "SSN number is Entered: ");
						driver.findElement(By.name("requestBean.statusType")).sendKeys("Auction");
						test.log(LogStatus.PASS, "Auction is entered: ");
						driver.findElement(By.name("submit")).click();
						test.log(LogStatus.PASS, "Clicked on submit Button: ");
						driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[3]/td[6]/input")).click();
						test.log(LogStatus.PASS, "Clicked on Go Button: ");
						driver.switchTo().defaultContent();
						driver.switchTo().frame("mainFrame");
						driver.switchTo().frame("main");
						driver.findElement(By.name("solvageCompany")).sendKeys("CARS");
						test.log(LogStatus.PASS, "Solvage Company is selected CARS ");
						driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
						test.log(LogStatus.PASS, "Month is Entered");
						driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
						test.log(LogStatus.PASS, "Day is Entered");
						driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
						test.log(LogStatus.PASS, "Year is Entered");
						Thread.sleep(3000);
						driver.findElement(By.name("requestBean.password")).sendKeys(Password);
						test.log(LogStatus.PASS, "Password Entered");
						driver.findElement(By.name("finish")).click();
						test.log(LogStatus.PASS, "Click on submitt Button");
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())
					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Auction updated successfully.");
					}
					else
					{
						test.log(LogStatus.FAIL, "Auction Not updated successfully.");
					}
				}
			}
		}

		public void Sale (String SSN,String FileName,int days) throws Exception
		{
			//-------done
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";		
			for(int row=2;row<=lastrow;row++)
			{	
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);	
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					System.out.println(ProductID);	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					//Thread.sleep(5000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();			
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
					driver.findElement(By.cssSelector("li[id='911101']")).click();			
					test.log(LogStatus.PASS, "Clicked on Transactions");		
					driver.switchTo().frame("main");		
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");		
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles()){
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input")).click();
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("History");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					String DefaultDate=null;
					DefaultDate = driver.findElement(By.xpath("//*[@id='myTable1']/tbody[2]/tr[3]/td[2]")).getText();					
					test.log(LogStatus.PASS, "Capture Default date:"+DefaultDate);
					driver.close();
					driver = new InternetExplorerDriver();
					driver.get(AdminURL);
					driver.manage().window().maximize();
					DateFormat df=new SimpleDateFormat("MM/dd/yyyy");
					driver.findElement(By.name("loginRequestBean.userId")).sendKeys("admin");
					test.log(LogStatus.PASS, "Username is entered: admin");
					driver.findElement(By.name("loginRequestBean.password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Password is entered: "+Password);
					driver.findElement(By.name("login")).click();
					test.log(LogStatus.PASS, "Clicked on Submit button");
					Date DDueDate = df.parse(DefaultDate);
					Calendar cal = Calendar.getInstance();
					cal.setTime(DDueDate);
					cal.add(Calendar.DATE, days);
					Date DDueDateminus1= cal.getTime();
					String DueDateminus1 =df.format(DDueDateminus1);
					String DueDate0[] =DueDateminus1.split("/");
					String DueDate1 = DueDate0[0];
					String DueDate2 = DueDate0[1];
					String DueDate3 = DueDate0[2];
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					Thread.sleep(3000);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.linkText("Title Loan")).click();
					test.log(LogStatus.PASS, "Clicked on Title Loan");
					Thread.sleep(3000);
					driver.findElement(By.linkText("Post Default Transactions")).click();
					test.log(LogStatus.PASS, "Clicked on Post Default Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("requestBean.storeId")).sendKeys(StoreID);
					test.log(LogStatus.PASS, "Store number is entered: "+StoreID);
					driver.findElement(By.name("requestBean.ssn")).sendKeys(SSN);
					test.log(LogStatus.PASS, "SSN number is Entered: ");
					driver.findElement(By.name("requestBean.statusType")).sendKeys("Sale");
					test.log(LogStatus.PASS, "Auction is entered: ");
					driver.findElement(By.name("submit")).click();
					test.log(LogStatus.PASS, "Clicked on submitt Button: ");
					driver.findElement(By.xpath("/html/body/table/tbody/tr[1]/td[1]/table[2]/tbody/tr[2]/td/table/tbody/tr[2]/td[6]/input")).click();
					test.log(LogStatus.PASS, "Clicked on Go Button: ");	
					driver.findElement(By.name("rpossesdate1")).sendKeys(DueDate1);
					test.log(LogStatus.PASS, "Month is Entered");
					driver.findElement(By.name("rpossesdate2")).sendKeys(DueDate2);
					test.log(LogStatus.PASS, "Day is Entered");
					driver.findElement(By.name("rpossesdate3")).sendKeys(DueDate3);
					test.log(LogStatus.PASS, "Year is Entered");
					driver.findElement(By.name("requestBean.saleValue")).clear();
					driver.findElement(By.name("requestBean.saleValue")).sendKeys("5000");
					test.log(LogStatus.PASS, "SalValue Entered");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on submitt Button");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					if( driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).isDisplayed())
					{
						driver.findElement(By.xpath("/html/body/form/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr/td/input")).click();
						test.log(LogStatus.PASS, "OK Button is Clicked");
						test.log(LogStatus.PASS, "Sale completed successfully.");
					}
					else
					{
						test.log(LogStatus.FAIL, "Sale not completed.");
					}
				}
			}
		}

		public void CustomerRefund(String SSN,String FileName) throws Exception
		{
			//--------done
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			System.out.println("NewLoan "+lastrow);
			String sheetName="NewLoan";
			for(int row=2;row<=lastrow;row++)
			{
				String RegSSN = TestData.getCellData(sheetName,"SSN",row);
				if(SSN.equals(RegSSN))
				{
					String TxnType=TestData.getCellData(sheetName,"TxnType",row);
					String TenderType = TestData.getCellData(sheetName,"TenderType",row);
					String ProductID=TestData.getCellData(sheetName,"ProductID",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreID = TestData.getCellData(sheetName,"StoreID",row);
					String AdminURL=TestData.getCellData(sheetName,"AdminURL",row);
					System.out.println(AdminURL);
					test.log(LogStatus.INFO, "Scheduler-Store Aging");
					System.out.println(ProductID);
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					appUrl = AppURL;
					this.Login(UserName,Password,StoreID);
					String SSN1 = SSN.substring(0, 3);
					String SSN2 = SSN.substring(3,5);
					String SSN3 = SSN.substring(5,9);
					driver.switchTo().defaultContent();
					driver.switchTo().frame("topFrame");
					driver.findElement(By.xpath("//*[contains(text(),'Loan Transactions')]")).click();
					test.log(LogStatus.PASS, "Clicked on Loan Transactions");
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.findElement(By.cssSelector("li[id='911101']")).click();
					test.log(LogStatus.PASS, "Clicked on Transactions");
					driver.switchTo().frame("main");
					driver.findElement(By.name("ssn1")).sendKeys(SSN1);
					test.log(LogStatus.PASS, "SSN1 is entered: "+SSN1);
					driver.findElement(By.name("ssn2")).sendKeys(SSN2);
					test.log(LogStatus.PASS, "SSN2 is entered: "+SSN2);
					driver.findElement(By.name("ssn3")).sendKeys(SSN3);
					test.log(LogStatus.PASS, "SSN3 is entered: "+SSN3);
					driver.findElement(By.name("submit1")).click();
					test.log(LogStatus.PASS, "Click on submit Button");
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("button")).click();
					test.log(LogStatus.PASS, "Click on GO Button");
					for(String winHandle : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.xpath("//input[@value='Go' and @type='button']")).click();
					/*driver.findElement(By.xpath("//*[@id='showMore-2']")).click();
					String Loannbr1= driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[2]")).getText(); 
					int Loan1 = Integer.parseInt(Loannbr1);
					String Loannbr2=driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[2]")).getText();
					int Loan2 = Integer.parseInt(Loannbr2);
					WebElement Go1 = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[5]/td[13]/input"));
					WebElement Go2 = driver.findElement(By.xpath("/html/body/form[1]/table/tbody/tr/td/table/tbody/tr/td/table[2]/tbody/tr[7]/td[2]/table/tbody/tr/td/table/tbody/tr[8]/td[13]/input"));
					if(ProductID.equals("TLP"))
					{	
						if(Loan1<Loan2)
						{
							Go1.click();
						}
						else 
						{
							Go2.click();
						}
					}*/
					//  driver.findElement(By.name("button")).click();
					//test.log(LogStatus.PASS, "Click on GO Button");
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}			
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionList")).sendKeys("CustomerRefund");
					if(ProductID.equals("TLP"))
					{
						driver.findElement(By.xpath("//*[@id='go_Button']")).click(); 
					}
					for( String winHandle1 : driver.getWindowHandles())
					{
						driver.switchTo().window(winHandle1);
					}
					driver.switchTo().defaultContent();
					driver.switchTo().frame("mainFrame");
					driver.switchTo().frame("main");
					driver.findElement(By.name("transactionDataBean.tenderTypeFirst")).sendKeys("Cash");
					test.log(LogStatus.PASS, "Enter the Disb Type Cash");
					driver.findElement(By.name("password")).sendKeys(Password);
					test.log(LogStatus.PASS, "Enter the Password");
					driver.findElement(By.name("finish")).click();
					test.log(LogStatus.PASS, "Click on Finish Refund Button");
					Thread.sleep(2000);
					if(driver.findElement(By.name("checkno")).isDisplayed())
					{
						driver.findElement(By.name("checkno")).click();
						test.log(LogStatus.PASS, "NO Button is Clicked");
						test.log(LogStatus.PASS, "CustomerRefund updated successfully.");
					}
					else
					{
						test.log(LogStatus.FAIL, "CustomerRefund Not updated successfully.");
					} 
				}
			}
		}


		
		
		public boolean isAlertPresent(){
			try{
				driver.switchTo().alert();
				return true;
			}catch(NoAlertPresentException ex){
				return false;
			}
		}

		
		
		//@Test (priority=0)completed

		public void Loan_EncryptionKey_Void() throws Exception
		{
			String FileName= "AA_NewLoan_EncryptionKey_Void_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";  
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_Loan_EncryptionKey_Void"+"_"+PayFrequency+"_"+CollateralType,"Loan-->Void on next day with Encryption Key");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.LoanDate_AgeStore(SSN, FileName, 5);
					this.EncryptionKey_Void(SSN, FileName);
					this.IETaskKiller();
				}
			}


		}

// @Test (priority=1)completed

		public void Loan_AgestoreRescindDays_Rescind() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_NewLoan_AgestoreRescindDays_Rescind_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_Loan_AgestoreRescindDays_Rescind"+"_"+PayFrequency+"_"+CollateralType,"LoanAge the store to Rescind daysRescind");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName); 
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.LoanDate_AgeStore(SSN, FileName,1); 
					this.Rescind(SSN, FileName);
					this.IETaskKiller();

				}
			}


		}

	//	@Test (priority=2)completed

		public void NewLoan_multiplel_disbursement_void() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_NewLoan_multiple disbursement__Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_NewLoan_multiplel_disbursement_void"+"_"+PayFrequency+"_"+CollateralType,"loan with multiple disbursement (cash& check)->void with cash(Next day with encryption)");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan_MultipulDisbtypes(SSN, FileName);
					this.Void_MultipuldisbTypes(SSN, FileName);
					this.IETaskKiller();

				}
			}


		}




	//	@Test (priority=3)completed

		public void NewLoan_Paymenttoapportinateprinciple_Void_Cancelreschudle() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_NewLoan_Payment_Void_CancelReschdule__Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_NewLoan_Paymenttoapportinateprinciple_Void_Cancelreschudle"+"_"+PayFrequency+"_"+CollateralType,"Title Loan --> generate letter 10 days before due date --> make payment to apportinate principle then Title Loan got rescheduled --> Void the payment then cancel the reschedule");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore_1stInst_DueDate10DaysBefore(SSN, FileName, -10);
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.Payment(SSN, FileName);
					this.Void(SSN, FileName);
					this.IETaskKiller();

				}
			}


		}


	//@Test (priority=4)completed

		public void TwoLoansameVIN_OneLoanDefault_OutofReposhouldnotpostotherLoan() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_TwoLoans_OneVIN_OneDefault_OutofReposhouldnotpostotherLoan_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_TwoLoansameVIN_OneLoanDefault_OutofReposhouldnotpostotherLoan"+"_"+PayFrequency+"_"+CollateralType, "Originate two Loans on Same VIN  > make one loan to Default > Other loan should not become Default > Make Out of Repo for one loan > Out of Repo should not effect for other Loan");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore(SSN, FileName,5);
					this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);//updated
					this.AgeStore1_1(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);  
					this.AgeStore2_1(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess(SSN, FileName, 0);
					this.DefaultPaymentStatus1(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1); 
					this.Loanstatus_1st(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}


		//@Test (priority=5)//completed

		public void TwoLoansameVIN_OneDefault_Repossession_RepossessionshouldposttwoLoans() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_TwoLoans_OneVIN_OneDefault_RepossessionShouldPostTwoLoans_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_TwoLoansameVIN_OneDefault_Repossession_RepossessionshouldposttwoLoans"+"_"+PayFrequency+"_"+CollateralType, "Originate two Loans on Same VIN  > make one loan to Default > Other loan should not become Default > Make Repossession for one loan > Repossession should post for Other Loan also.");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore(SSN, FileName,5);
					//this.NewLoanWithVIN2(SSN, FileName,NewVIN);
					this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);
					this.AgeStore1_1(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName); 
					this.AgeStore1_1BatchProcess(SSN, FileName, 0);
					this.DefaultPaymentStatus1(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1);
					this.Repossession(SSN, FileName, 1);
					this.DefaultPaymentStatus1(SSN, FileName);
					this.IETaskKiller();
			
				
				}
			}

		}


	//@Test (priority=6) completed

		public void TwoLoansameVIN_Default_Repossion_repoPaymentmoreAmount_ShouldnoteffectotherLoan() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_TwoLoans_OneVIN_OneDefault_Repossession_RepoPayment_ShouldnoteffectotherLoan_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);

					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_TwoLoansameVIN_Default_Repossion_repoPaymentmoreAmount_ShouldnoteffectotherLoan"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN  > make one loan to Default > Other loan should not become Default > Make Repossession for one loan > Repossession should post for Other Loan also > Make repo Payment for the Loan with more amount > Amount should not effect to other loan..");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore(SSN, FileName,5);
					this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);//updated
					this.AgeStore1_1(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName); 
					this.Drawerassign(SSN, FileName); 
					this.AgeStore1_1BatchProcess(SSN, FileName, 0);
					this.DefaultPaymentStatus1(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1);
					this.Repossession(SSN, FileName, 1);
					this.DefaultPaymentStatus1(SSN, FileName);
					this.RepoPayment(SSN, FileName); 
					this.IETaskKiller();
			
				}
			}
			//this.Login("CSR353","1234","353");

		}




		//@Test (priority=7) Auction should consider system date to perform(done for past dates )complete

		
		public void TwoLoansonsameVin_Default_Repossession_OneLoanAcution_ShouldnoteffectotherLoan() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_TwoLoansonsameVin_Default_Repossession_OneLoanAcution_ShouldnoteffectotherLoan_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_TwoLoansonsameVin_Default_Repossession_OneLoanAcution_ShouldnoteffectotherLoan"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN  > make one loan to Default > Other loan should not become Default > Make Repossession for one loan > Repossession should post for Other Loan also > Make Auction for the Loan  Auction should not effect for other loan..");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore(SSN, FileName,5);
					this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);//updated
					this.AgeStore1_1(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName); 
					this.Drawerassign(SSN, FileName); 
					this.AgeStore1_1BatchProcess(SSN, FileName, 0);
					this.DefaultPaymentStatus1(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1);
					this.Repossession(SSN, FileName, 1);
					this.DefaultPaymentStatus1(SSN, FileName);
					this.Verification1stLoanAMT_BeforeAcution2ndLoan(SSN, FileName);
					
					this.Auction(SSN, FileName, -120);
					this.Verification1stLoanAMT_AfterAcution2ndLoan(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		//@Test (priority=8)complete

		public void TwoLoansonsameVin_Default_saleLessAmount_RemainingAmountShouldbwaived() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_TwoLoansonsameVin_Default_saleLessAmount_RemainingAmountShouldbwaived_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_TwoLoansonsameVin_Default_saleLessAmount_RemainingAmountShouldbwaived"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN>make one loan to Default>Other loan should not become Default > Make Repossession for one loan>Repossession should post for Other Loan also>Make Auction for the Loan-->Make sale for the Loan with less amount>Remaining amount should be waived>Other Loan should also waived.");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore(SSN, FileName,5);
					this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);//updated
					this.AgeStore1_1(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName); 
					this.Drawerassign(SSN, FileName); 
					this.AgeStore1_1BatchProcess(SSN, FileName, 0);
					this.DefaultPaymentStatus1(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1);
					this.Repossession(SSN, FileName, 1);
					this.DefaultPaymentStatus1(SSN, FileName);
					this.AgeStore1_1B(SSN, FileName, 22);
					this.Auction(SSN, FileName, 22); 
					this.Sale_LessAmount(SSN, FileName, 21);
					this.TwoLoansVerification_Waived(SSN, FileName);
					this.IETaskKiller();

				}
			}

		}

	
		
		
		//@Test (priority=9)complete

		public void TwoLoansonsameVin_Default_saleMoreAmount_RemainingAmountShouldbwaived() throws Exception 
	{

			// Start test. Mention test script name
			String FileName= "AA_TwoLoansonsameVin_Default_saleMoreAmount_RemainingAmountShouldbwaived_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_TwoLoansonsameVin_Default_saleMoreAmount_RemainingAmountShouldbwaived"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN>make one loan to Default>Other loan should not become Default>Make Repossession for one loan>Repossession should post for Other Loan also>Make Auction for the Loan-->Make sale for the Loan with amout just more than one loan Total Due>Extra amount should post as sale transaction for other loan>Remaining amount should be waived..");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore(SSN, FileName,5);
					this.NewLoanWithVIN2(SSN, FileName,NewVIN);
					//this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);
					this.AgeStore1_1(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName); 
					this.Drawerassign(SSN, FileName); 
					this.AgeStore1_1BatchProcess(SSN, FileName, 0);
					this.DefaultPaymentStatus1(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1);
					this.Repossession(SSN, FileName, 1);
					this.DefaultPaymentStatus1(SSN, FileName);
					this.AgeStore1_1B(SSN, FileName, 22);
					this.Auction(SSN, FileName, 22); 
					this.Sale_MoreAmount(SSN, FileName, 21);
					this.TwoLoansVerification_Waived(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		/// kiran
		//@Test (priority=10)completed

		public void BorrowerNewLoan_Rule_TLP() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_BorrowerNewLoan_Rule_TLP_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);

					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);

					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest(Header+"_BorrowerNewLoan_Rule_TLP_"+PayFrequency+"_"+CollateralType, "Login__customerhavingalreadyhavingOpenLoan__performNewLoandependsonrule");
					appUrl = AppURL;
					//this.Login(UserName,Password,StoreId);
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					//this.NewLoanWithVIN2(SSN, FileName,NewVIN);
					this.NewLoanWithVIN2_2(SSN, FileName,NewVIN);
					this.NewLoanWithVIN2_1(SSN, FileName,NewVIN2);
					this.NewLoanWithVIN2(SSN, FileName,NewVIN2);
					this.NewLoanRule(SSN, FileName);
					this.IETaskKiller();
					
				}
			}
			//this.Login("CSR353","1234","353");

		}

///////////////////////////////////////////////////////////////////////////////////////////////KIRAN
	  @Test (priority=11)//complete
		public void Loan_InstallmentPayment_Void_TLP() throws Exception 
		{
			String FileName= "AA_Loan__InstallmentPayment__Void_TLP_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_Loan_InstallmentPayment_Void_TLP_"+PayFrequency+"_"+CollateralType, "Loan__Agethestoreuptosomedaysbeforeduedate__InstallmentPayment__Void");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
				//	Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore_1stInst(SSN, FileName, -1);
					this.Payment(SSN, FileName);
					this.Payment_Void(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

@Test (priority=12)// completed

		public void AA_Loan__Payment__RenewLoanDueDate__shouldnotdisplayVoid() throws Exception
		{
			String FileName= "AA_Loan__Payment__RenewLoanDueDate__shouldnotdisplayVoid_TLP_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);   
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_AA_Loan__Payment__RenewLoanDueDate__shouldnotdisplayVoid_"+PayFrequency+"_"+CollateralType, "Loan__Agethestoreuptosomedaysbeforeduedate__InstallmentPayment__RenewtheloanonDuedate__shouldnotdisplayVoidoptionforPayment");
					appUrl = AppURL;
					
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore_1stInst(SSN, FileName, -1);
					this.Payment(SSN, FileName);
					this.AgeStore_1stInst(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.Check_Void(SSN, FileName, 0); //Confirm whether void should be displayed or not? -srikanth
					this.IETaskKiller();

				}
			}


		}


	@Test (priority=13)//completed
		public void Loan_GenerateLetter_EOD1stInstDate_EOD2ndInstDate_Default_DefaultPmt_Void_CheckLoanStatus() throws Exception {

			String FileName= "AA_Loan_GenerateLetter_EOD1stInstDate_EOD2ndInstDate_Default_DefaultPmt_Void_CheckLoanStatus_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);

					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);

					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_Loan_GenerateLetter_EOD1stInstDate_EOD2ndInstDate_Default_DefaultPmt_Void_CheckLoanStatus_"+PayFrequency+"_"+CollateralType, "Title Loan _ Generate letter 10 days before due date _ Run EOD on Due date of 1st Installment _ Run EOD on 2nd Installment date and customer status changed to default _ age the store _ Perform the Default payment full _ Void the default Payment _ Loan should Open");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore1_1_C(SSN, FileName, -10); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_2_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.AgeStore1_2_C(SSN, FileName, 1);
					this.DefaultPayment(SSN, FileName);
					this.DefaultPayment_Void(SSN, FileName);
					this.Loan_Status(SSN, FileName);
					this.IETaskKiller();

				}
			}
		}


	@Test (priority=14)//completed

		public void Loan_Letter10days1stDuedate_Miss1stInstPmt_RenewLoan1stDuedate_Pay1stInstAmtAfterletterGeneration_AppApportionate() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_Loan_Letter10days1stDuedate_Miss1stInstPmt_RenewLoan1stDuedate_Pay1stInstAmtAfterletterGeneration_ApplicationApportionate_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName); 
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_Loan_Letter10days1stDuedate_Miss1stInstPmt_RenewLoan1stDuedate_Pay1stInstAmtAfterletterGeneration_AppApportionate_"+PayFrequency+"_"+CollateralType, "Title Loan___ generate letter 10 days before due date ___ Missed the 1st Installment paymen t____ Renew the loan on due date __ Pay the 1st Installment amount after Renewal letter date__application should apportinate 1st and 2nd Installment Interest and then 1st and 2nd Installment Fee and letter date should be payment date");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore1_1_C(SSN, FileName, -10); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_2_C(SSN, FileName, -10); 
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_2_C(SSN, FileName, -11); 
					this.Payment(SSN, FileName);
					this.HistoryValidations(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}
	
		
		//////////////////kiran
		
		
		
		@Test (priority=15)//completed

		public void Loan_PaymentForInterestAmount_paymentForFee_paymentforPrincipleAmount_ReviseSchedule() throws Exception {

			// Start test. Mention test script name
			String FileName= "AA_Loan_PaymentForInterestAmount_paymentForFee_paymentforPrincipleAmount_ReviseSchedule_TLP_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
			if(RunFlag.equals("Y"))			
			{		
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
			        String StoreId = TestData.getCellData(sheetName,"StoreID",row);
			        String ProductID = TestData.getCellData(sheetName,"ProductID",row);
			        String StateID = TestData.getCellData(sheetName,"StateID",row);
			        String SSN = TestData.getCellData(sheetName,"SSN",row);	
			        String Header = StateID+ "_" + ProductID;
			        test = reports.startTest("TN_TLP_SC.No:22"+Header, "Title Loan --> Payment with interest amount( should effct to Intrst only) --> payment with fee amount(should effect to Fee amount only) --> payment(should effect to principal amout)  schedule should revised");
			        Assert.assertTrue(true);
			        appUrl = AppURL;		        
			    	CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName); 
					this.AgeStore(SSN, FileName, 0);
					this.Payment_InterestAmt(SSN, FileName);
					this.Payment_FeeAmt(SSN, FileName);
					this.Payment_PrincipleAmt(SSN, FileName);
					this.HistoryValidations1(SSN, FileName);
					this.IETaskKiller();

				}
			}
		}
		
		@Test (priority=16)//completed

		public void AA_OneCustomer_OneVIN_TwoLoans_ThirdLoanNotOriginate_TLP() throws Exception {

			String FileName= "AA_OneCustomer_OneVIN_TwoLoans_ThirdLoanNotOriginate_TLP_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					test = reports.startTest(Header+"_S.No:39_"+PayFrequency+"_"+CollateralType, "Originate two loans on same VIN for one custmr _ try to originate loan for same custmr with third VIN _ Loan should not originated.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.NewLoanWithVIN4(SSN, FileName,NewVIN);
					this.NewLoanWithVIN_ThreeLoans(SSN, FileName, NewVIN);
					this.IETaskKiller();
				}
			}
		}

	@Test (priority=17)//completed

		public void TwoLoans_TwoCustomers_OneVIN_3rdLoanNotOriginate() throws Exception 
		{
			String FileName= "AA_TwoLoans_TwoCustomers_OneVIN_3rdLoanNotOriginate_TLP_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			test = reports.startTest("TN_TLP_S.No:40_Bi-Weekly_CASH", "Originate two loans on same VIN for two different custmrs __ try to originate third loan for another custmr with same VIN __ Loan should not originated");
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN_TwoCust(SSN, FileName, NewVIN);
					this.IETaskKiller();
				}
			}
		}

		
		//@Test (priority=18)//completed
		public void Loan_PartialPmtStopRenewal_LetterNotGenerate_EOD1stInsDueDate_LoanNotRenewed_Default_DFLTAmt() throws Exception 
		{

			String FileName= "AA_Loan_PartialPmtStopRenewal_LetterNotGenerate_EOD1stInsDueDate_LoanNotRenewed_Default_DFLTAmtEqualsPrincipleinterestandfee_Txn_Testdata.xls";
			//Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);

					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					test = reports.startTest(Header+"_S.No:33_"+PayFrequency+"_"+CollateralType,"Title Loan __ partial payment and stop the renewal(before letter generate) __ trying to generate letter 10 days before due date __ should not generate the letter__ Run EOD on 1st inst due date __ Title Loan should not be renew __ Default__ Default amount should balance principle +1st installment remaining interest and fees only");

					//test = reports.startTest("Scenario_No_33_AA_"+Header, "Title Loan __ partial payment and stop the renewal(before letter generate) __ trying to generate letter 10 days before due date __ should not generate the letter__ Run EOD on 1st inst due date __ Title Loan should not be renew __ Default__ Default amount should balance principle +1st installment remaining interest and fees only");
					appUrl = AppURL;

					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.Loandate_AgeStore(SSN, FileName, 5);
					this.PartialPayment(SSN, FileName);
					this.AgeStore1_1_C(SSN, FileName, -10); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_2_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPayment_Validation(SSN, FileName);
					this.IETaskKiller();

				}
			}
		}
		//Leela
		@Test (priority=19)//completed
		public void AA_TwoLoans_OneVIN_OneDefault_Repossession_Salvage_Refund() throws Exception {

			String FileName= "AA_TwoLoans_OneVIN_OneDefault_Repossession_Salvage_Refund_Testdata.xls";
			//Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";   
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
					
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest("Scenario_No_62_"+Header, "Originate two Loans on Same VIN_make one loan to Default_Other loan should not become Default_Make Repossession for one loan_Repossession should post for Other Loan also_Make Auction for the Loan_Make Sale for the Loan with amout just more than two loans Total Due_Two loans shld be closed_Remaining amount should be Refunded to Custmr through  first loan.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName,NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName,NewVIN);
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName); 
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);	
					this.OutToRepo(SSN, FileName, 1);
					this.Repossession(SSN, FileName, 1);
					this.DefaultPaymentStatus1_C(SSN, FileName);	
					this.AgeStore_After_Repo(SSN, FileName, 5);
					this.Salvage_Morethan_twoloans(SSN, FileName, 21);
					this.DefaultLoanStatus_1(SSN, FileName);
					this.DefaultLoanStatus_2(SSN, FileName);
					this.CustomerRefund_secondloan(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		@Test (priority=20)//completed	
		public void NewLoan_Agestore_beforeduedate_Partialpymt_Void() throws Exception
		{
			String FileName= "AA_NewLoan_Agestore_beforeduedate_Partialpymt_Void_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:9"+"_"+PayFrequency+"_"+CollateralType,"Loan -- Age the store up to some days before due date --Partial PaymentVoid");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore(SSN, FileName, -6);
					this.Partial_Payment(SSN, FileName);
					this.Void_Partial_Payment(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		@Test (priority=21)	//complete
		public void NewLoan_Agestore_beforeduedate_Payoff_Void() throws Exception 
		{
			String FileName= "AA_NewLoan_Agestore_beforeduedate_Payoff_Void_Txn_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:12"+"_"+PayFrequency+"_"+CollateralType,"Loan -- Age the store up to some days before due date  PayOff  Void ");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.AgeStore(SSN, FileName, -6);
					this.Payoff_Amount(SSN, FileName);
					this.Void_Payoff_Payment(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		@Test (priority=22)	//complete
		public void NewLoan_Bi_Weekly_Frequency_Check_Duedate_30days() throws Exception 
		{
			String FileName= "AA_Newloan_Bi_Weekly_Frequency_Check_DueDate_30days_Txns_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:3"+"_"+PayFrequency+"_"+CollateralType,"Borrower -> Pay Frequency (ALL) -> New Loan ->Check Due Date --> Should be thirty days for All Pay Frequencies  Bi-Weekly");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan(SSN, FileName);
					this.DueDate_History(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		@Test (priority=23)//completed	
		public void TwoLoans_1VIN_1DFLT_2NotDFLT_Voluntary_Surrender_Auction_SalewithlessAmt_Waived_OtherloanWaived() throws Exception 
		{
			String FileName= "TwoLoans_1VIN_1DFLT_2NotDFLT_Voluntary_Surrender_Auction_SalewithlessAmt_Waived_OtherloanWaived_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);				
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:52"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default >Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also --> Make Auction for the Loan --> Make sale for the Loan with less amount > Remaining amount should be waived >Other Loan should also waived.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.AgeStore_After_Repo(SSN, FileName, 22);
					this.Auction(SSN, FileName, 22);
					this.Sale_LessAmount(SSN, FileName, 0);
					this.Verify_Waived_History_1(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		@Test (priority=24)//completed	
		public void TwoLoans_1VIN_1DFLT_2NotDFLT_Voluntary_Surrender_Auction_Salewithmorethantwoloans_TotalDue_Waived_OtherloanWaived() throws Exception {

			// Start test. Mention test script name
			String FileName= "TwoLoans_1VIN_1DFLT_2NotDFLT_Voluntary_Surrender_Auction_Salewithmorethan_twoloans_TotalDue_RemainingRefund_thow1loan_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			//Excel TestData = new Excel("E:/QC_Workspace/AA_Automation/TestData/PDL/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:54"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default > Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also --> Make Auction for the Loan --> Make Sale for the Loan with amout just more than two loans Total Due --> Two loans shld be closed > Remaining amount should be Refunded to Custmr through first loan.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.AgeStore_After_Repo(SSN, FileName, 22);
					this.Auction(SSN, FileName, 0);
					this.Sale_MoreAmount(SSN, FileName, 0);
					this.DefaultLoanStatus_1(SSN, FileName);
					this.DefaultLoanStatus_2(SSN, FileName);
					this.Check_CustomerRefund(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

		@Test (priority=25)//completed
		public void TwoLoans_1VIN_1DFLT_2NotDFLT_Voluntary_Surrender_Auction_Salewithmorethanoneloan_TotalDue_Remainingsaletootherloan_remainingamtWaived() throws Exception {

			// Start test. Mention test script name
			String FileName= "TwoLoans_1VIN_1DFLT_2NotDFLT_Voluntary_Surrender_Auction_Salewithmorethanoneloan_TotalDue_Remainingsaletootherloan_remainingamtWaived_Testdata.xls";
			//Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			//Excel TestData = new Excel("E:/QC_Workspace/AA_Automation/TestData/PDL/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:53"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default > Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also -->Make Auction for the Loan --> Make sale for the Loan with amount just more than one loan Total Due >Extra amount should post as sale transaction for other loan > Remaining amount should be waived.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.AgeStore_After_Repo(SSN, FileName, 22);
					this.Auction(SSN, FileName, 0);
					this.Sale_morethan_oneloan(SSN, FileName, 0);
					this.Verify_Sold_Waived_History_Loan1(SSN, FileName);
					this.Verify_Sold_Waived_History_Loan2(SSN, FileName);
					this.IETaskKiller();
					
				}
			}
		}

	@Test (priority=26)//completed	
		public void TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT_VoluntarySurrender() throws Exception {

			// Start test. Mention test script name
			String FileName= "TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT_VoluntarySurrender_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			//Excel TestData = new Excel("E:/QC_Workspace/AA_Automation/TestData/PDL/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					//test = reports.startTest("Scenario_No_51_"+Header, "New Loan");
					test = reports.startTest(Header+"_S.No:51"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default > Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also.");				
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.IETaskKiller();

					//wait(100);
					// this.RegistrationPage(SSN);
				}
			}
			//this.Login("CSR353","1234","353");

		}


		@Test (priority=27)	//completed /// issues 
		public void TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT2_Voluntary_Surrender_Salvage_MorethanoneloanTotalDue_Waived() throws Exception {

			String FileName= "TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT2_Voluntary_Surrender_Salvage_morethanoneloanTotalDue_Waived_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			//Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					test = reports.startTest(Header+"_S.No:56"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default >Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also --> Make salvage for the Loan with amount just more than one loan Total Due > Extra amount should post as sale Transaction for other loan > Remaining amount should be waived.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.AgeStore_After_Repo(SSN, FileName, 21);
					
					this.Salvage_Morethan_Oneloan(SSN, FileName, 0);
					this.Verify_Salvage_History_Loan1(SSN, FileName);
					this.Verify_Salvage_History_Loan2(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

	@Test (priority=28)	
		public void TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT2_Voluntary_Surrender_Salvage_TwoloansTotalDue_2loansclosed_refund() throws Exception {

			// Start test. Mention test script name
			String FileName= "TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT2_Voluntary_Surrender_Salvage_TwoloansTotalDue_2loansclosed_refund_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			//Excel TestData = new Excel("E:/QC_Workspace/AA_Automation/TestData/PDL/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	
					//driver.get(appUrl);
					//test.log(LogStatus.INFO, "Application is launched");
					//driver.manage().window().maximize();
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					//test = reports.startTest("Scenario_No_57_"+Header, "New Loan");
					test = reports.startTest(Header+"_S.No:57"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default > Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also -->Make salvage for the Loan with amount just more than two loans Total Due --> Two loans shld be closed > Remaining amount should be Refunded to Custmr through first loan.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.AgeStore_After_Repo(SSN, FileName, 5);
					this.Salvage_Morethan_twoloans(SSN, FileName, 0);
					this.DefaultLoanStatus_1(SSN, FileName);
					this.DefaultLoanStatus_2(SSN, FileName);
					this.CustomerRefund(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}
		
		@Test (priority=29)	
		public void TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT2_Voluntary_Surrender_Salvage_Waived() throws Exception {

			// Start test. Mention test script name
			String FileName= "TwoLoans_singleVIN_OneDFLT_Other_ShouldNotDFLT2_Surrender_Salvage_Waived_Testdata.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				if(RunFlag.equals("Y"))
				{	
					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String NewVIN= TestData.getCellData(sheetName,"NewVIN",row);
					String NewVIN2= TestData.getCellData(sheetName,"NewVIN2",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String PayFrequency = TestData.getCellData(sheetName,"Income_PayFrequency",row);
					String CollateralType = TestData.getCellData(sheetName,"ESign_CollateralType",row);
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					//test = reports.startTest("Scenario_No_55_"+Header, "New Loan");
					test = reports.startTest(Header+"_S.No:55"+"_"+PayFrequency+"_"+CollateralType,"Originate two Loans on Same VIN > make one loan to Default > Other loan should not become Default > Make Voluntary surrender for one loan  Voluntary Surrender should post for Other Loan also --> Make salvage for the Loan with less amount > Remaining amount should be waived > Other Loan should also waived.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoanWithVIN(SSN, FileName, NewVIN);
					this.LoanDate_Agestore_C(SSN, FileName,5);
					this.NewLoanWithVIN3(SSN, FileName, NewVIN);	        
					this.AgeStore1_1_C(SSN, FileName, 0); 
					this.DrawerDeassign(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore2_1_C(SSN, FileName, 0);
					this.DrawerDeassign(SSN, FileName);
					//this.EODProcessing(SSN, FileName);
					this.StatementGeneration_EODProcessing(SSN, FileName);
					this.StoreInfo(SSN, FileName);
					this.Safeassign(SSN, FileName);
					this.Drawerassign(SSN, FileName);
					this.AgeStore1_1BatchProcess_C(SSN, FileName, 0);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.Voluntary_Surrender_After_Default(SSN, FileName);
					this.DefaultPaymentStatus1_C(SSN, FileName);
					this.AgeStore_After_Repo(SSN, FileName, 5);
					this.Salvage_lessamt(SSN, FileName, 0);
					this.Verify_Waived_History(SSN, FileName);
					this.IETaskKiller();
				}
			}
		}

	// Venkey

		@Test (priority=30)//complete
		
		public void BarrowRegistration_VerfyLoanAmountBased_BlockBookValueOrnot() throws Exception {

			//Start test. Mention test script name
			String FileName= "BarrowRegistration_VerfyLoanAmountBased_BlockBookValueOrnot_TextData.xls";
			Excel TestData = new Excel(System.getProperty("user.dir")+"/TestData/TLP_Generic/"+FileName);
			int lastrow=TestData.getLastRow("NewLoan");
			String sheetName="NewLoan";
			//int lastrow=TestData.getLastRow("Borrower");
			System.out.println(lastrow);
			for(int row=2;row<=lastrow;row++)
			{
				String RunFlag = TestData.getCellData(sheetName,"Run",row);
				//System.out.println(RunFlag);
				if(RunFlag.equals("Y"))
				{	

					String AppURL = TestData.getCellData(sheetName,"AppURL",row);
					String UserName = TestData.getCellData(sheetName,"UserName",row);
					String Password = TestData.getCellData(sheetName,"Password",row);
					// System.out.println(Password);
					String StoreId = TestData.getCellData(sheetName,"StoreID",row);
					String ProductID = TestData.getCellData(sheetName,"ProductID",row);
					String StateID = TestData.getCellData(sheetName,"StateID",row);
					String SSN = TestData.getCellData(sheetName,"SSN",row);	
					String Header = StateID+ "_" + ProductID;
					//System.out.println(SSN);
					test = reports.startTest("AA_Scenario_No_04_"+Header, "Borrower_Registration_verify whether loan amount is based on BlackBook Value or not.");
					appUrl = AppURL;
					CSRLoginpage login = new CSRLoginpage();
					login.Login(UserName, Password, StoreId, driver, AppURL, test);
					BorrowerRegistrationpage Reg = new BorrowerRegistrationpage();
					//Reg.RegistrationPage_NewLoan_TLP(driver, test, AppURL, SSN, FileName);
					Reg.RegistrationPage_NewLoan_TLPGeneric(driver, test, AppURL, SSN, FileName);
					this.NewLoan_BlackBookValue(SSN, FileName);
					this.IETaskKiller();
				}
			}
			//this.Login("CSR353","1234","353");

		}
		
		
		

		@AfterMethod
		public void getResult(ITestResult result) throws Exception{
			if(result.getStatus() == ITestResult.FAILURE){
				test.log(LogStatus.FAIL, "Test Case Failed is "+result.getName());
				test.log(LogStatus.FAIL, "Test Case Failed is "+result.getThrowable());
				//To capture screenshot path and store the path of the screenshot in the string "screenshotPath"
				//We do pass the path captured by this mehtod in to the extent reports using "logger.addScreenCapture" method. 
				String screenshotPath = ExecuteScripts.getScreenhot(driver, result.getName());
				//To add it in the extent report 
				test.log(LogStatus.FAIL, test.addScreenCapture(screenshotPath));
			}else if(result.getStatus() == ITestResult.SKIP){
				test.log(LogStatus.SKIP, "Test Case Skipped is "+result.getName());
			}else if(result.getStatus() == ITestResult.SUCCESS){
				test.log(LogStatus.PASS, result.getName()+" Test Case is Passed");}
			// reports.endTest(test);
			reports.flush();
			//Call close() at the very end of your session to clear all resources. 
			//If any of your test ended abruptly causing any side-affects (not all logs sent to ExtentReports, information missing), this method will ensure that the test is still appended to the report with a warning message.
			//You should call close() only once, at the very end (in @AfterSuite for example) as it closes the underlying stream. 
			//Once this method is called, calling any Extent method will throw an error.
			//close() - To close all the operation
			//driver.quit();
			// ending test
			//endTest(logger) : It ends the current test and prepares to create HTML report
			// reports.endTest(test);
		}	
		@AfterTest
		public void tearDown() {
			// Ending Test
			reports.endTest(test);

			// writing everything into HTML report
			reports.flush();
		}

		@AfterClass
		public void quit() {
			// Closing browser
			driver.quit();

		}

		public void takeScreenShot(WebDriver driver, String filePath) {
			File scrFile = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
			try {
				FileUtils.copyFile(scrFile, new File(filePath));
			} catch (IOException e) {
				e.printStackTrace();
			}
		}
		
	}
